import numpy as np
import matplotlib.pyplot as plt
import math
import make_inputdate_function as mif

# difine filename
filename = "connectivity_arc_loc3_18x18"

# patch info (ξ方向のコントロールポイント個数, η方向のコントロールポイント個数)
patch_info = np.array([18, 18])

# patch info 1行2列の時の例外処理
if np.array(patch_info.shape).shape[0] == 1:
    patch_info = np.array([[patch_info[0], patch_info[1]]])

xi_max = 0
eta_max = 0
for i in range(patch_info.shape[0]):
    if xi_max < patch_info[i][0]:
        xi_max = patch_info[i][0]
    if eta_max < patch_info[i][1]:
        eta_max = patch_info[i][1]

# パッチのコントロールポイント 座標，重み
patch = np.zeros((patch_info.shape[0], xi_max * eta_max, 3))
patch_bool = np.zeros((patch_info.shape[0], xi_max * eta_max, 3), dtype=bool)
for i in range(patch_info.shape[0]):
    patch_bool[i,:patch_info[i][0]*patch_info[i][1],:] = True

# 各パッチ入力
num = 0
patch[num,:patch_info[num][0]*patch_info[num][1],:] = np.array(
   [[1.0000000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.0222222222222221e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.0666666666666669e+00,	0.0000000000000000e+00,	9.9999999999999989e-01],
    [1.1333333333333331e+00,	0.0000000000000000e+00,	1.0000000000000002e+00],
    [1.2000000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.2666666666666666e+00,	0.0000000000000000e+00,	1.0000000000000002e+00],
    [1.3333333333333335e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.4000000000000001e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.4666666666666668e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.5333333333333332e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.6000000000000001e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.6666666666666665e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.7333333333333334e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.8000000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.8666666666666667e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.9333333333333331e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.9777777777777779e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [2.0000000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.0000000000000000e+00,	3.6237852235939373e-02,	9.8698252360829097e-01],
    [1.0222222222222221e+00,	3.7043137841182461e-02,	9.8698252360829097e-01],
    [1.0666666666666669e+00,	3.8653709051668664e-02,	9.8698252360829086e-01],
    [1.1333333333333331e+00,	4.1069565867397941e-02,	9.8698252360829120e-01],
    [1.2000000000000000e+00,	4.3485422683127231e-02,	9.8698252360829097e-01],
    [1.2666666666666664e+00,	4.5901279498856522e-02,	9.8698252360829131e-01],
    [1.3333333333333337e+00,	4.8317136314585833e-02,	9.8698252360829097e-01],
    [1.4000000000000001e+00,	5.0732993130315117e-02,	9.8698252360829097e-01],
    [1.4666666666666668e+00,	5.3148849946044394e-02,	9.8698252360829097e-01],
    [1.5333333333333332e+00,	5.5564706761773698e-02,	9.8698252360829097e-01],
    [1.6000000000000001e+00,	5.7980563577502975e-02,	9.8698252360829097e-01],
    [1.6666666666666665e+00,	6.0396420393232272e-02,	9.8698252360829097e-01],
    [1.7333333333333334e+00,	6.2812277208961556e-02,	9.8698252360829097e-01],
    [1.8000000000000003e+00,	6.5228134024690854e-02,	9.8698252360829097e-01],
    [1.8666666666666669e+00,	6.7643990840420137e-02,	9.8698252360829097e-01],
    [1.9333333333333331e+00,	7.0059847656149435e-02,	9.8698252360829097e-01],
    [1.9777777777777779e+00,	7.1670418866635638e-02,	9.8698252360829097e-01],
    [2.0000000000000000e+00,	7.2475704471878746e-02,	9.8698252360829097e-01],
    [9.9752316403610142e-01,	1.0898078241153468e-01,	9.6268323434376757e-01],
    [1.0196903454591260e+00,	1.1140257757623542e-01,	9.6268323434376757e-01],
    [1.0640247083051748e+00,	1.1624616790563701e-01,	9.6268323434376746e-01],
    [1.1305262525742479e+00,	1.2351155339973924e-01,	9.6268323434376790e-01],
    [1.1970277968433216e+00,	1.3077693889384159e-01,	9.6268323434376768e-01],
    [1.2635293411123949e+00,	1.3804232438794389e-01,	9.6268323434376790e-01],
    [1.3300308853814686e+00,	1.4530770988204622e-01,	9.6268323434376768e-01],
    [1.3965324296505421e+00,	1.5257309537614852e-01,	9.6268323434376768e-01],
    [1.4630339739196156e+00,	1.5983848087025082e-01,	9.6268323434376757e-01],
    [1.5295355181886889e+00,	1.6710386636435318e-01,	9.6268323434376757e-01],
    [1.5960370624577624e+00,	1.7436925185845542e-01,	9.6268323434376757e-01],
    [1.6625386067268355e+00,	1.8163463735255775e-01,	9.6268323434376768e-01],
    [1.7290401509959090e+00,	1.8890002284666008e-01,	9.6268323434376757e-01],
    [1.7955416952649828e+00,	1.9616540834076240e-01,	9.6268323434376757e-01],
    [1.8620432395340563e+00,	2.0343079383486470e-01,	9.6268323434376757e-01],
    [1.9285447838031291e+00,	2.1069617932896706e-01,	9.6268323434376757e-01],
    [1.9728791466491786e+00,	2.1553976965836857e-01,	9.6268323434376757e-01],
    [1.9950463280722028e+00,	2.1796156482306936e-01,	9.6268323434376757e-01],
    [9.8554779636091716e-01,	2.1668531258097182e-01,	9.3144129100366602e-01],
    [1.0074488585022707e+00,	2.2150054174943781e-01,	9.3144129100366602e-01],
    [1.0512509827849783e+00,	2.3113100008636997e-01,	9.3144129100366602e-01],
    [1.1169541692090394e+00,	2.4557668759176798e-01,	9.3144129100366624e-01],
    [1.1826573556331006e+00,	2.6002237509716608e-01,	9.3144129100366613e-01],
    [1.2483605420571617e+00,	2.7446806260256429e-01,	9.3144129100366624e-01],
    [1.3140637284812229e+00,	2.8891375010796239e-01,	9.3144129100366613e-01],
    [1.3797669149052840e+00,	3.0335943761336048e-01,	9.3144129100366613e-01],
    [1.4454701013293452e+00,	3.1780512511875864e-01,	9.3144129100366602e-01],
    [1.5111732877534061e+00,	3.3225081262415673e-01,	9.3144129100366602e-01],
    [1.5768764741774675e+00,	3.4669650012955483e-01,	9.3144129100366602e-01],
    [1.6425796606015286e+00,	3.6114218763495293e-01,	9.3144129100366613e-01],
    [1.7082828470255897e+00,	3.7558787514035108e-01,	9.3144129100366602e-01],
    [1.7739860334496511e+00,	3.9003356264574923e-01,	9.3144129100366602e-01],
    [1.8396892198737120e+00,	4.0447925015114738e-01,	9.3144129100366602e-01],
    [1.9053924062977732e+00,	4.1892493765654554e-01,	9.3144129100366602e-01],
    [1.9491945305804808e+00,	4.2855539599347758e-01,	9.3144129100366602e-01],
    [1.9710955927218343e+00,	4.3337062516194363e-01,	9.3144129100366602e-01],
    [9.6423060079806988e-01,	3.2282341109160467e-01,	9.0540633822024796e-01],
    [9.8565794748247137e-01,	3.2999726467141799e-01,	9.0540633822024796e-01],
    [1.0285126408512746e+00,	3.4434497183104490e-01,	9.0540633822024796e-01],
    [1.0927946809044791e+00,	3.6586653257048513e-01,	9.0540633822024819e-01],
    [1.1570767209576840e+00,	3.8738809330992552e-01,	9.0540633822024796e-01],
    [1.2213587610108887e+00,	4.0890965404936580e-01,	9.0540633822024819e-01],
    [1.2856408010640934e+00,	4.3043121478880614e-01,	9.0540633822024796e-01],
    [1.3499228411172981e+00,	4.5195277552824648e-01,	9.0540633822024796e-01],
    [1.4142048811705026e+00,	4.7347433626768659e-01,	9.0540633822024796e-01],
    [1.4784869212237073e+00,	4.9499589700712704e-01,	9.0540633822024796e-01],
    [1.5427689612769120e+00,	5.1651745774656721e-01,	9.0540633822024796e-01],
    [1.6070510013301165e+00,	5.3803901848600766e-01,	9.0540633822024796e-01],
    [1.6713330413833212e+00,	5.5956057922544788e-01,	9.0540633822024796e-01],
    [1.7356150814365261e+00,	5.8108213996488822e-01,	9.0540633822024796e-01],
    [1.7998971214897304e+00,	6.0260370070432867e-01,	9.0540633822024796e-01],
    [1.8641791615429351e+00,	6.2412526144376890e-01,	9.0540633822024796e-01],
    [1.9070338549117385e+00,	6.3847296860339575e-01,	9.0540633822024796e-01],
    [1.9284612015961398e+00,	6.4564682218320935e-01,	9.0540633822024796e-01],
    [9.3273074790848387e-01,	4.2577487843608519e-01,	8.8457837599351385e-01],
    [9.5345809786200564e-01,	4.3523654240133147e-01,	8.8457837599351385e-01],
    [9.9491279776904973e-01,	4.5415987033182437e-01,	8.8457837599351363e-01],
    [1.0570948476296147e+00,	4.8254486222756310e-01,	8.8457837599351408e-01],
    [1.1192768974901806e+00,	5.1092985412330227e-01,	8.8457837599351385e-01],
    [1.1814589473507462e+00,	5.3931484601904123e-01,	8.8457837599351408e-01],
    [1.2436409972113120e+00,	5.6769983791478029e-01,	8.8457837599351385e-01],
    [1.3058230470718777e+00,	5.9608482981051925e-01,	8.8457837599351385e-01],
    [1.3680050969324431e+00,	6.2446982170625820e-01,	8.8457837599351385e-01],
    [1.4301871467930085e+00,	6.5285481360199737e-01,	8.8457837599351385e-01],
    [1.4923691966535744e+00,	6.8123980549773633e-01,	8.8457837599351385e-01],
    [1.5545512465141396e+00,	7.0962479739347550e-01,	8.8457837599351385e-01],
    [1.6167332963747054e+00,	7.3800978928921435e-01,	8.8457837599351385e-01],
    [1.6789153462352711e+00,	7.6639478118495341e-01,	8.8457837599351385e-01],
    [1.7410973960958365e+00,	7.9477977308069248e-01,	8.8457837599351385e-01],
    [1.8032794459564028e+00,	8.2316476497643165e-01,	8.8457837599351363e-01],
    [1.8447341458634461e+00,	8.4208809290692410e-01,	8.8457837599351385e-01],
    [1.8654614958169677e+00,	8.5154975687217038e-01,	8.8457837599351385e-01],
    [8.9048281711084842e-01,	5.2385933034654109e-01,	8.6895740432346291e-01],
    [9.1027132415775591e-01,	5.3550064879868642e-01,	8.6895740432346291e-01],
    [9.4984833825157167e-01,	5.5878328570297731e-01,	8.6895740432346280e-01],
    [1.0092138593922946e+00,	5.9370724105941319e-01,	8.6895740432346313e-01],
    [1.0685793805330179e+00,	6.2863119641584930e-01,	8.6895740432346291e-01],
    [1.1279449016737411e+00,	6.6355515177228541e-01,	8.6895740432346324e-01],
    [1.1873104228144646e+00,	6.9847910712872163e-01,	8.6895740432346291e-01],
    [1.2466759439551878e+00,	7.3340306248515774e-01,	8.6895740432346291e-01],
    [1.3060414650959109e+00,	7.6832701784159363e-01,	8.6895740432346291e-01],
    [1.3654069862366340e+00,	8.0325097319802985e-01,	8.6895740432346291e-01],
    [1.4247725073773572e+00,	8.3817492855446563e-01,	8.6895740432346291e-01],
    [1.4841380285180805e+00,	8.7309888391090174e-01,	8.6895740432346291e-01],
    [1.5435035496588037e+00,	9.0802283926733784e-01,	8.6895740432346291e-01],
    [1.6028690707995270e+00,	9.4294679462377384e-01,	8.6895740432346291e-01],
    [1.6622345919402501e+00,	9.7787074998021006e-01,	8.6895740432346291e-01],
    [1.7216001130809733e+00,	1.0127947053366462e+00,	8.6895740432346280e-01],
    [1.7611771271747887e+00,	1.0360773422409368e+00,	8.6895740432346291e-01],
    [1.7809656342216968e+00,	1.0477186606930822e+00,	8.6895740432346291e-01],
    [8.3726449555523796e-01,	6.1543081132063904e-01,	8.5854342321009547e-01],
    [8.5587037323424331e-01,	6.2910705157220870e-01,	8.5854342321009547e-01],
    [8.9308212859225389e-01,	6.5645953207534835e-01,	8.5854342321009547e-01],
    [9.4889976162926948e-01,	6.9748825283005722e-01,	8.5854342321009591e-01],
    [1.0047173946662855e+00,	7.3851697358476665e-01,	8.5854342321009569e-01],
    [1.0605350277033014e+00,	7.7954569433947596e-01,	8.5854342321009591e-01],
    [1.1163526607403174e+00,	8.2057441509418538e-01,	8.5854342321009569e-01],
    [1.1721702937773333e+00,	8.6160313584889447e-01,	8.5854342321009569e-01],
    [1.2279879268143492e+00,	9.0263185660360390e-01,	8.5854342321009547e-01],
    [1.2838055598513651e+00,	9.4366057735831321e-01,	8.5854342321009547e-01],
    [1.3396231928883811e+00,	9.8468929811302253e-01,	8.5854342321009547e-01],
    [1.3954408259253965e+00,	1.0257180188677315e+00,	8.5854342321009569e-01],
    [1.4512584589624127e+00,	1.0667467396224410e+00,	8.5854342321009547e-01],
    [1.5070760919994282e+00,	1.1077754603771501e+00,	8.5854342321009547e-01],
    [1.5628937250364445e+00,	1.1488041811318594e+00,	8.5854342321009547e-01],
    [1.6187113580734602e+00,	1.1898329018865688e+00,	8.5854342321009547e-01],
    [1.6559231134314709e+00,	1.2171853823897085e+00,	8.5854342321009547e-01],
    [1.6745289911104759e+00,	1.2308616226412781e+00,	8.5854342321009547e-01],
    [7.7324154771352671e-01,	6.9898138073140914e-01,	8.5333643265341186e-01],
    [7.9042469321827169e-01,	7.1451430030321816e-01,	8.5333643265341186e-01],
    [8.2479098422776187e-01,	7.4558013944683632e-01,	8.5333643265341186e-01],
    [8.7634042074199658e-01,	7.9217889816226328e-01,	8.5333643265341219e-01],
    [9.2788985725623185e-01,	8.3877765687769035e-01,	8.5333643265341208e-01],
    [9.7943929377046701e-01,	8.8537641559311786e-01,	8.5333643265341230e-01],
    [1.0309887302847023e+00,	9.3197517430854526e-01,	8.5333643265341208e-01],
    [1.0825381667989373e+00,	9.7857393302397255e-01,	8.5333643265341208e-01],
    [1.1340876033131724e+00,	1.0251726917393997e+00,	8.5333643265341186e-01],
    [1.1856370398274076e+00,	1.0717714504548270e+00,	8.5333643265341186e-01],
    [1.2371864763416427e+00,	1.1183702091702543e+00,	8.5333643265341186e-01],
    [1.2887359128558775e+00,	1.1649689678856812e+00,	8.5333643265341208e-01],
    [1.3402853493701130e+00,	1.2115677266011087e+00,	8.5333643265341186e-01],
    [1.3918347858843481e+00,	1.2581664853165362e+00,	8.5333643265341186e-01],
    [1.4433842223985833e+00,	1.3047652440319637e+00,	8.5333643265341186e-01],
    [1.4949336589128179e+00,	1.3513640027473908e+00,	8.5333643265341186e-01],
    [1.5292999499223083e+00,	1.3824298418910090e+00,	8.5333643265341186e-01],
    [1.5464830954270534e+00,	1.3979627614628183e+00,	8.5333643265341186e-01],
    [6.9898138073140892e-01,	7.7324154771352671e-01,	8.5333643265341197e-01],
    [7.1451430030321805e-01,	7.9042469321827158e-01,	8.5333643265341197e-01],
    [7.4558013944683621e-01,	8.2479098422776187e-01,	8.5333643265341197e-01],
    [7.9217889816226339e-01,	8.7634042074199670e-01,	8.5333643265341219e-01],
    [8.3877765687769068e-01,	9.2788985725623185e-01,	8.5333643265341208e-01],
    [8.8537641559311786e-01,	9.7943929377046679e-01,	8.5333643265341230e-01],
    [9.3197517430854537e-01,	1.0309887302847021e+00,	8.5333643265341208e-01],
    [9.7857393302397255e-01,	1.0825381667989373e+00,	8.5333643265341208e-01],
    [1.0251726917393997e+00,	1.1340876033131724e+00,	8.5333643265341197e-01],
    [1.0717714504548268e+00,	1.1856370398274076e+00,	8.5333643265341197e-01],
    [1.1183702091702543e+00,	1.2371864763416425e+00,	8.5333643265341197e-01],
    [1.1649689678856812e+00,	1.2887359128558775e+00,	8.5333643265341208e-01],
    [1.2115677266011089e+00,	1.3402853493701130e+00,	8.5333643265341197e-01],
    [1.2581664853165360e+00,	1.3918347858843478e+00,	8.5333643265341197e-01],
    [1.3047652440319633e+00,	1.4433842223985833e+00,	8.5333643265341197e-01],
    [1.3513640027473908e+00,	1.4949336589128186e+00,	8.5333643265341186e-01],
    [1.3824298418910088e+00,	1.5292999499223086e+00,	8.5333643265341197e-01],
    [1.3979627614628178e+00,	1.5464830954270534e+00,	8.5333643265341197e-01],
    [6.1543081132063882e-01,	8.3726449555523774e-01,	8.5854342321009569e-01],
    [6.2910705157220859e-01,	8.5587037323424309e-01,	8.5854342321009569e-01],
    [6.5645953207534824e-01,	8.9308212859225389e-01,	8.5854342321009547e-01],
    [6.9748825283005733e-01,	9.4889976162926937e-01,	8.5854342321009569e-01],
    [7.3851697358476653e-01,	1.0047173946662855e+00,	8.5854342321009569e-01],
    [7.7954569433947596e-01,	1.0605350277033012e+00,	8.5854342321009580e-01],
    [8.2057441509418527e-01,	1.1163526607403171e+00,	8.5854342321009569e-01],
    [8.6160313584889447e-01,	1.1721702937773331e+00,	8.5854342321009569e-01],
    [9.0263185660360346e-01,	1.2279879268143485e+00,	8.5854342321009569e-01],
    [9.4366057735831277e-01,	1.2838055598513647e+00,	8.5854342321009569e-01],
    [9.8468929811302197e-01,	1.3396231928883804e+00,	8.5854342321009569e-01],
    [1.0257180188677313e+00,	1.3954408259253961e+00,	8.5854342321009569e-01],
    [1.0667467396224408e+00,	1.4512584589624120e+00,	8.5854342321009569e-01],
    [1.1077754603771497e+00,	1.5070760919994279e+00,	8.5854342321009569e-01],
    [1.1488041811318590e+00,	1.5628937250364441e+00,	8.5854342321009569e-01],
    [1.1898329018865685e+00,	1.6187113580734600e+00,	8.5854342321009547e-01],
    [1.2171853823897079e+00,	1.6559231134314703e+00,	8.5854342321009569e-01],
    [1.2308616226412776e+00,	1.6745289911104755e+00,	8.5854342321009569e-01],
    [5.2385933034654120e-01,	8.9048281711084853e-01,	8.6895740432346269e-01],
    [5.3550064879868653e-01,	9.1027132415775602e-01,	8.6895740432346269e-01],
    [5.5878328570297731e-01,	9.4984833825157167e-01,	8.6895740432346269e-01],
    [5.9370724105941330e-01,	1.0092138593922944e+00,	8.6895740432346302e-01],
    [6.2863119641584941e-01,	1.0685793805330182e+00,	8.6895740432346269e-01],
    [6.6355515177228541e-01,	1.1279449016737411e+00,	8.6895740432346302e-01],
    [6.9847910712872185e-01,	1.1873104228144644e+00,	8.6895740432346269e-01],
    [7.3340306248515785e-01,	1.2466759439551878e+00,	8.6895740432346269e-01],
    [7.6832701784159363e-01,	1.3060414650959107e+00,	8.6895740432346269e-01],
    [8.0325097319802985e-01,	1.3654069862366338e+00,	8.6895740432346269e-01],
    [8.3817492855446607e-01,	1.4247725073773574e+00,	8.6895740432346269e-01],
    [8.7309888391090196e-01,	1.4841380285180805e+00,	8.6895740432346269e-01],
    [9.0802283926733818e-01,	1.5435035496588039e+00,	8.6895740432346269e-01],
    [9.4294679462377418e-01,	1.6028690707995270e+00,	8.6895740432346269e-01],
    [9.7787074998021029e-01,	1.6622345919402504e+00,	8.6895740432346269e-01],
    [1.0127947053366462e+00,	1.7216001130809733e+00,	8.6895740432346269e-01],
    [1.0360773422409371e+00,	1.7611771271747891e+00,	8.6895740432346269e-01],
    [1.0477186606930824e+00,	1.7809656342216971e+00,	8.6895740432346269e-01],
    [4.2577487843608536e-01,	9.3273074790848398e-01,	8.8457837599351352e-01],
    [4.3523654240133169e-01,	9.5345809786200575e-01,	8.8457837599351352e-01],
    [4.5415987033182431e-01,	9.9491279776904962e-01,	8.8457837599351352e-01],
    [4.8254486222756326e-01,	1.0570948476296149e+00,	8.8457837599351374e-01],
    [5.1092985412330227e-01,	1.1192768974901806e+00,	8.8457837599351363e-01],
    [5.3931484601904134e-01,	1.1814589473507460e+00,	8.8457837599351385e-01],
    [5.6769983791478051e-01,	1.2436409972113123e+00,	8.8457837599351363e-01],
    [5.9608482981051958e-01,	1.3058230470718775e+00,	8.8457837599351363e-01],
    [6.2446982170625853e-01,	1.3680050969324431e+00,	8.8457837599351352e-01],
    [6.5285481360199749e-01,	1.4301871467930087e+00,	8.8457837599351352e-01],
    [6.8123980549773655e-01,	1.4923691966535741e+00,	8.8457837599351352e-01],
    [7.0962479739347539e-01,	1.5545512465141396e+00,	8.8457837599351363e-01],
    [7.3800978928921457e-01,	1.6167332963747054e+00,	8.8457837599351352e-01],
    [7.6639478118495341e-01,	1.6789153462352713e+00,	8.8457837599351352e-01],
    [7.9477977308069248e-01,	1.7410973960958369e+00,	8.8457837599351352e-01],
    [8.2316476497643165e-01,	1.8032794459564025e+00,	8.8457837599351352e-01],
    [8.4208809290692421e-01,	1.8447341458634461e+00,	8.8457837599351352e-01],
    [8.5154975687217072e-01,	1.8654614958169680e+00,	8.8457837599351352e-01],
    [3.2282341109160445e-01,	9.6423060079806977e-01,	9.0540633822024796e-01],
    [3.2999726467141788e-01,	9.8565794748247126e-01,	9.0540633822024796e-01],
    [3.4434497183104490e-01,	1.0285126408512746e+00,	9.0540633822024785e-01],
    [3.6586653257048501e-01,	1.0927946809044788e+00,	9.0540633822024819e-01],
    [3.8738809330992541e-01,	1.1570767209576838e+00,	9.0540633822024796e-01],
    [4.0890965404936569e-01,	1.2213587610108882e+00,	9.0540633822024819e-01],
    [4.3043121478880608e-01,	1.2856408010640932e+00,	9.0540633822024796e-01],
    [4.5195277552824636e-01,	1.3499228411172981e+00,	9.0540633822024796e-01],
    [4.7347433626768654e-01,	1.4142048811705026e+00,	9.0540633822024796e-01],
    [4.9499589700712687e-01,	1.4784869212237071e+00,	9.0540633822024796e-01],
    [5.1651745774656721e-01,	1.5427689612769115e+00,	9.0540633822024796e-01],
    [5.3803901848600744e-01,	1.6070510013301162e+00,	9.0540633822024796e-01],
    [5.5956057922544777e-01,	1.6713330413833212e+00,	9.0540633822024796e-01],
    [5.8108213996488800e-01,	1.7356150814365261e+00,	9.0540633822024796e-01],
    [6.0260370070432845e-01,	1.7998971214897304e+00,	9.0540633822024796e-01],
    [6.2412526144376856e-01,	1.8641791615429348e+00,	9.0540633822024796e-01],
    [6.3847296860339564e-01,	1.9070338549117385e+00,	9.0540633822024796e-01],
    [6.4564682218320890e-01,	1.9284612015961395e+00,	9.0540633822024796e-01],
    [2.1668531258097176e-01,	9.8554779636091716e-01,	9.3144129100366602e-01],
    [2.2150054174943778e-01,	1.0074488585022707e+00,	9.3144129100366602e-01],
    [2.3113100008636989e-01,	1.0512509827849783e+00,	9.3144129100366591e-01],
    [2.4557668759176796e-01,	1.1169541692090392e+00,	9.3144129100366624e-01],
    [2.6002237509716608e-01,	1.1826573556331004e+00,	9.3144129100366602e-01],
    [2.7446806260256418e-01,	1.2483605420571615e+00,	9.3144129100366624e-01],
    [2.8891375010796244e-01,	1.3140637284812229e+00,	9.3144129100366602e-01],
    [3.0335943761336054e-01,	1.3797669149052840e+00,	9.3144129100366602e-01],
    [3.1780512511875852e-01,	1.4454701013293452e+00,	9.3144129100366602e-01],
    [3.3225081262415662e-01,	1.5111732877534061e+00,	9.3144129100366602e-01],
    [3.4669650012955477e-01,	1.5768764741774675e+00,	9.3144129100366602e-01],
    [3.6114218763495287e-01,	1.6425796606015284e+00,	9.3144129100366602e-01],
    [3.7558787514035102e-01,	1.7082828470255895e+00,	9.3144129100366602e-01],
    [3.9003356264574912e-01,	1.7739860334496509e+00,	9.3144129100366602e-01],
    [4.0447925015114722e-01,	1.8396892198737120e+00,	9.3144129100366602e-01],
    [4.1892493765654532e-01,	1.9053924062977730e+00,	9.3144129100366602e-01],
    [4.2855539599347742e-01,	1.9491945305804805e+00,	9.3144129100366602e-01],
    [4.3337062516194352e-01,	1.9710955927218343e+00,	9.3144129100366602e-01],
    [1.0898078241153464e-01,	9.9752316403610153e-01,	9.6268323434376746e-01],
    [1.1140257757623541e-01,	1.0196903454591260e+00,	9.6268323434376746e-01],
    [1.1624616790563698e-01,	1.0640247083051753e+00,	9.6268323434376735e-01],
    [1.2351155339973921e-01,	1.1305262525742481e+00,	9.6268323434376779e-01],
    [1.3077693889384157e-01,	1.1970277968433216e+00,	9.6268323434376746e-01],
    [1.3804232438794381e-01,	1.2635293411123951e+00,	9.6268323434376779e-01],
    [1.4530770988204625e-01,	1.3300308853814691e+00,	9.6268323434376746e-01],
    [1.5257309537614852e-01,	1.3965324296505424e+00,	9.6268323434376746e-01],
    [1.5983848087025077e-01,	1.4630339739196159e+00,	9.6268323434376746e-01],
    [1.6710386636435309e-01,	1.5295355181886887e+00,	9.6268323434376746e-01],
    [1.7436925185845539e-01,	1.5960370624577627e+00,	9.6268323434376746e-01],
    [1.8163463735255772e-01,	1.6625386067268357e+00,	9.6268323434376746e-01],
    [1.8890002284666002e-01,	1.7290401509959092e+00,	9.6268323434376746e-01],
    [1.9616540834076229e-01,	1.7955416952649828e+00,	9.6268323434376746e-01],
    [2.0343079383486462e-01,	1.8620432395340563e+00,	9.6268323434376746e-01],
    [2.1069617932896695e-01,	1.9285447838031293e+00,	9.6268323434376746e-01],
    [2.1553976965836852e-01,	1.9728791466491786e+00,	9.6268323434376746e-01],
    [2.1796156482306928e-01,	1.9950463280722031e+00,	9.6268323434376746e-01],
    [3.6237852235939352e-02,	1.0000000000000000e+00,	9.8698252360829097e-01],
    [3.7043137841182454e-02,	1.0222222222222221e+00,	9.8698252360829097e-01],
    [3.8653709051668650e-02,	1.0666666666666669e+00,	9.8698252360829086e-01],
    [4.1069565867397934e-02,	1.1333333333333331e+00,	9.8698252360829120e-01],
    [4.3485422683127224e-02,	1.2000000000000000e+00,	9.8698252360829097e-01],
    [4.5901279498856508e-02,	1.2666666666666666e+00,	9.8698252360829120e-01],
    [4.8317136314585819e-02,	1.3333333333333335e+00,	9.8698252360829097e-01],
    [5.0732993130315103e-02,	1.4000000000000001e+00,	9.8698252360829097e-01],
    [5.3148849946044380e-02,	1.4666666666666668e+00,	9.8698252360829097e-01],
    [5.5564706761773663e-02,	1.5333333333333332e+00,	9.8698252360829097e-01],
    [5.7980563577502961e-02,	1.6000000000000001e+00,	9.8698252360829097e-01],
    [6.0396420393232252e-02,	1.6666666666666665e+00,	9.8698252360829097e-01],
    [6.2812277208961542e-02,	1.7333333333333334e+00,	9.8698252360829097e-01],
    [6.5228134024690812e-02,	1.8000000000000003e+00,	9.8698252360829097e-01],
    [6.7643990840420110e-02,	1.8666666666666669e+00,	9.8698252360829097e-01],
    [7.0059847656149407e-02,	1.9333333333333331e+00,	9.8698252360829097e-01],
    [7.1670418866635610e-02,	1.9777777777777779e+00,	9.8698252360829097e-01],
    [7.2475704471878705e-02,	2.0000000000000000e+00,	9.8698252360829097e-01],
    [0.0000000000000000e+00,	1.0000000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.0222222222222221e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.0666666666666669e+00,	9.9999999999999989e-01],
    [0.0000000000000000e+00,	1.1333333333333331e+00,	1.0000000000000002e+00],
    [0.0000000000000000e+00,	1.2000000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.2666666666666666e+00,	1.0000000000000002e+00],
    [0.0000000000000000e+00,	1.3333333333333335e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.4000000000000001e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.4666666666666668e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.5333333333333332e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.6000000000000001e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.6666666666666665e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.7333333333333334e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.8000000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.8666666666666667e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.9333333333333331e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.9777777777777779e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	2.0000000000000000e+00,	1.0000000000000000e+00]])

# 重複ありの総コントロールポイント数
allpointnumber_overlapping = 0
for i in range(patch_info.shape[0]):
    allpointnumber_overlapping += patch_info[i][0] * patch_info[i][1]

globalpoint = np.zeros((allpointnumber_overlapping))
globalpoint_x = np.zeros((allpointnumber_overlapping))
globalpoint_y = np.zeros((allpointnumber_overlapping))
globalpoint_w = np.zeros((allpointnumber_overlapping))
globalpoint_bool = np.zeros((allpointnumber_overlapping), dtype = bool)

localpoint = np.zeros((patch_info.shape[0], xi_max * eta_max))
localpoint_bool = np.zeros((patch_info.shape[0], xi_max * eta_max), dtype=bool)
for i in range(patch_info.shape[0]):
    localpoint_bool[i,:patch_info[i][0]*patch_info[i][1]] = True

xi_and_eta_max = xi_max
if xi_max < eta_max:
    xi_and_eta_max = eta_max
A = np.zeros((patch_info.shape[0], 2, 2, xi_and_eta_max))
A_bool = np.zeros((patch_info.shape[0], 2, 2, xi_and_eta_max), dtype=bool)

# connect patch
xi = 0
eta = 1
positive = 0
negative = 1

patch_number = 0
globalpoint, globalpoint_bool, globalpoint_x, globalpoint_y, globalpoint_w, localpoint, localpoint_bool, A, A_bool = \
    mif.connect_patch_arg_0boundary(patch_number, patch_info, patch, patch_bool, globalpoint, globalpoint_bool, globalpoint_x, globalpoint_y, globalpoint_w, localpoint, localpoint_bool, A, A_bool)

# 座標，パッチコネクティビティー，境界の辺をtxt出力
# [patch_number, xi_or_eta, 0_or_1(int)] (auto marge)
boundary_array_0 = np.array([[0, eta, 0],
                             [0, xi, 1]])

boundary_array_1 = np.array([[0,  xi, 1],
                             [0, eta, 1]])

boundary_number = 0
mif.write_date_header(filename)
mif.write_date_localpoint(filename, patch_info, localpoint, localpoint_bool)
mif.write_date_globalpoint(filename, globalpoint, globalpoint_bool, globalpoint_x, globalpoint_y, globalpoint_w)
boundary_number = mif.write_boundary(filename, A, A_bool, boundary_array_0, boundary_number)
boundary_number = mif.write_boundary(filename, A, A_bool, boundary_array_1, boundary_number)


# 描写
color = np.array(["r", "g", "b", "c", "m", "y", "k"])
fig = plt.figure()
ax1 = fig.add_subplot(1, 1, 1)

A = np.zeros((globalpoint[globalpoint_bool].shape[0],3))
for i in range(globalpoint[globalpoint_bool].shape[0]):
    A[i][0] = globalpoint[globalpoint_bool][i]
    A[i][1] = globalpoint_x[globalpoint_bool][i]
    A[i][2] = globalpoint_y[globalpoint_bool][i]
ax1.plot(A[:,1], A[:,2], c=color[0], marker="", linewidth=0.7)
for i in range(globalpoint[globalpoint_bool].shape[0]):
    ax1.text(A[i,1], A[i,2], str(int(A[i,0])), c=color[3], fontsize=6)


ax1.set_aspect('equal', adjustable='box')
ax1.set_axisbelow(True)
fig.set_figheight(9)
fig.set_figwidth(12)
ax1.grid()
ax1.set_xlim(-1, 3)
ax1.set_ylim(-1, 3)
plt.show()