import numpy as np
import matplotlib.pyplot as plt
import math
import make_inputdate_function as mif

# difine filename
filename = "connectivity_arc_loc3_18x18"

# patch info (ξ方向のコントロールポイント個数, η方向のコントロールポイント個数)
patch_info = np.array([18, 18])

# patch info 1行2列の時の例外処理
if np.array(patch_info.shape).shape[0] == 1:
    patch_info = np.array([[patch_info[0], patch_info[1]]])

xi_max = 0
eta_max = 0
for i in range(patch_info.shape[0]):
    if xi_max < patch_info[i][0]:
        xi_max = patch_info[i][0]
    if eta_max < patch_info[i][1]:
        eta_max = patch_info[i][1]

# パッチのコントロールポイント 座標，重み
patch = np.zeros((patch_info.shape[0], xi_max * eta_max, 3))
patch_bool = np.zeros((patch_info.shape[0], xi_max * eta_max, 3), dtype=bool)
for i in range(patch_info.shape[0]):
    patch_bool[i,:patch_info[i][0]*patch_info[i][1],:] = True

# 各パッチ入力
num = 0
patch[num,:patch_info[num][0]*patch_info[num][1],:] = np.array(
   [[1.0000000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.0888888888888890e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.2666666666666668e+00,	0.0000000000000000e+00,	9.9999999999999989e-01],
    [1.5333333333333332e+00,	0.0000000000000000e+00,	1.0000000000000002e+00],
    [1.8000000000000003e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [2.0666666666666664e+00,	0.0000000000000000e+00,	1.0000000000000002e+00],
    [2.3333333333333335e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [2.6000000000000005e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [2.8666666666666667e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [3.1333333333333333e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [3.3999999999999995e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [3.6666666666666665e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [3.9333333333333336e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [4.2000000000000002e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [4.4666666666666668e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [4.7333333333333334e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [4.9111111111111114e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [5.0000000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.0000000000000000e+00,	3.1841463552811644e-02,	9.8698252360829097e-01],
    [1.0888888888888890e+00,	3.4671815868617124e-02,	9.8698252360829097e-01],
    [1.2666666666666671e+00,	4.0332520500228078e-02,	9.8698252360829086e-01],
    [1.5333333333333332e+00,	4.8823577447644505e-02,	9.8698252360829120e-01],
    [1.8000000000000005e+00,	5.7314634395060952e-02,	9.8698252360829097e-01],
    [2.0666666666666664e+00,	6.5805691342477393e-02,	9.8698252360829131e-01],
    [2.3333333333333339e+00,	7.4296748289893841e-02,	9.8698252360829097e-01],
    [2.6000000000000010e+00,	8.2787805237310275e-02,	9.8698252360829097e-01],
    [2.8666666666666663e+00,	9.1278862184726695e-02,	9.8698252360829097e-01],
    [3.1333333333333337e+00,	9.9769919132143142e-02,	9.8698252360829097e-01],
    [3.3999999999999995e+00,	1.0826097607955956e-01,	9.8698252360829097e-01],
    [3.6666666666666670e+00,	1.1675203302697600e-01,	9.8698252360829097e-01],
    [3.9333333333333336e+00,	1.2524308997439243e-01,	9.8698252360829097e-01],
    [4.2000000000000002e+00,	1.3373414692180888e-01,	9.8698252360829097e-01],
    [4.4666666666666668e+00,	1.4222520386922533e-01,	9.8698252360829097e-01],
    [4.7333333333333334e+00,	1.5071626081664175e-01,	9.8698252360829097e-01],
    [4.9111111111111114e+00,	1.5637696544825272e-01,	9.8698252360829097e-01],
    [5.0000000000000000e+00,	1.5920731776405822e-01,	9.8698252360829097e-01],
    [9.9692218285593925e-01,	9.6660668218211773e-02,	9.6268323434376757e-01],
    [1.0855374879986897e+00,	1.0525272761538616e-01,	9.6268323434376757e-01],
    [1.2627680982841898e+00,	1.2243684640973493e-01,	9.6268323434376746e-01],
    [1.5286140137124400e+00,	1.4821302460125801e-01,	9.6268323434376790e-01],
    [1.7944599291406909e+00,	1.7398920279278116e-01,	9.6268323434376768e-01],
    [2.0603058445689411e+00,	1.9976538098430435e-01,	9.6268323434376790e-01],
    [2.3261517599971917e+00,	2.2554155917582747e-01,	9.6268323434376768e-01],
    [2.5919976754254428e+00,	2.5131773736735058e-01,	9.6268323434376768e-01],
    [2.8578435908536930e+00,	2.7709391555887369e-01,	9.6268323434376757e-01],
    [3.1236895062819436e+00,	3.0287009375039692e-01,	9.6268323434376757e-01],
    [3.3895354217101934e+00,	3.2864627194191998e-01,	9.6268323434376757e-01],
    [3.6553813371384436e+00,	3.5442245013344309e-01,	9.6268323434376768e-01],
    [3.9212272525666951e+00,	3.8019862832496620e-01,	9.6268323434376757e-01],
    [4.1870731679949458e+00,	4.0597480651648937e-01,	9.6268323434376757e-01],
    [4.4529190834231951e+00,	4.3175098470801265e-01,	9.6268323434376757e-01],
    [4.7187649988514462e+00,	4.5752716289953571e-01,	9.6268323434376757e-01],
    [4.8959956091369472e+00,	4.7471128169388449e-01,	9.6268323434376757e-01],
    [4.9846109142796964e+00,	4.8330334109105882e-01,	9.6268323434376757e-01],
    [9.8250421529118992e-01,	1.9519390339473450e-01,	9.3144129100366602e-01],
    [1.0698379233170736e+00,	2.1254447258537759e-01,	9.3144129100366602e-01],
    [1.2445053393688406e+00,	2.4724561096666367e-01,	9.3144129100366602e-01],
    [1.5065064634464911e+00,	2.9929731853859282e-01,	9.3144129100366624e-01],
    [1.7685075875241418e+00,	3.5134902611052199e-01,	9.3144129100366613e-01],
    [2.0305087116017924e+00,	4.0340073368245127e-01,	9.3144129100366624e-01],
    [2.2925098356794433e+00,	4.5545244125438045e-01,	9.3144129100366613e-01],
    [2.5545109597570939e+00,	5.0750414882630968e-01,	9.3144129100366613e-01],
    [2.8165120838347448e+00,	5.5955585639823868e-01,	9.3144129100366602e-01],
    [3.0785132079123954e+00,	6.1160756397016802e-01,	9.3144129100366602e-01],
    [3.3405143319900454e+00,	6.6365927154209714e-01,	9.3144129100366602e-01],
    [3.6025154560676955e+00,	7.1571097911402626e-01,	9.3144129100366613e-01],
    [3.8645165801453474e+00,	7.6776268668595549e-01,	9.3144129100366602e-01],
    [4.1265177042229970e+00,	8.1981439425788472e-01,	9.3144129100366602e-01],
    [4.3885188283006480e+00,	8.7186610182981406e-01,	9.3144129100366602e-01],
    [4.6505199523782998e+00,	9.2391780940174306e-01,	9.3144129100366602e-01],
    [4.8251873684300657e+00,	9.5861894778302936e-01,	9.3144129100366602e-01],
    [4.9125210764559490e+00,	9.7596951697367240e-01,	9.3144129100366602e-01],
    [9.5745720248188881e-01,	2.9477131806515666e-01,	9.0540633822024796e-01],
    [1.0425645093691680e+00,	3.2097321300428167e-01,	9.0540633822024796e-01],
    [1.2127791231437257e+00,	3.7337700288253178e-01,	9.0540633822024796e-01],
    [1.4681010438055626e+00,	4.5198268769990679e-01,	9.0540633822024819e-01],
    [1.7234229644674004e+00,	5.3058837251728197e-01,	9.0540633822024796e-01],
    [1.9787448851292364e+00,	6.0919405733465704e-01,	9.0540633822024819e-01],
    [2.2340668057910742e+00,	6.8779974215203221e-01,	9.0540633822024796e-01],
    [2.4893887264529120e+00,	7.6640542696940739e-01,	9.0540633822024796e-01],
    [2.7447106471147480e+00,	8.4501111178678223e-01,	9.0540633822024796e-01],
    [3.0000325677765853e+00,	9.2361679660415730e-01,	9.0540633822024796e-01],
    [3.2553544884384213e+00,	1.0022224814215324e+00,	9.0540633822024796e-01],
    [3.5106764091002587e+00,	1.0808281662389077e+00,	9.0540633822024796e-01],
    [3.7659983297620965e+00,	1.1594338510562827e+00,	9.0540633822024796e-01],
    [4.0213202504239334e+00,	1.2380395358736578e+00,	9.0540633822024796e-01],
    [4.2766421710857703e+00,	1.3166452206910331e+00,	9.0540633822024796e-01],
    [4.5319640917476072e+00,	1.3952509055084081e+00,	9.0540633822024796e-01],
    [4.7021787055221651e+00,	1.4476546953866583e+00,	9.0540633822024796e-01],
    [4.7872860124094450e+00,	1.4738565903257830e+00,	9.0540633822024796e-01],
    [9.2128495165685553e-01,	3.9372664893152570e-01,	8.8457837599351385e-01],
    [1.0031769473596872e+00,	4.2872457328099473e-01,	8.8457837599351385e-01],
    [1.1669609387653508e+00,	4.9872042197993260e-01,	8.8457837599351363e-01],
    [1.4126369258738452e+00,	6.0371419502833934e-01,	8.8457837599351408e-01],
    [1.6583129129823402e+00,	7.0870796807674619e-01,	8.8457837599351385e-01],
    [1.9039889000908343e+00,	8.1370174112515314e-01,	8.8457837599351408e-01],
    [2.1496648871993300e+00,	9.1869551417355999e-01,	8.8457837599351385e-01],
    [2.3953408743078248e+00,	1.0236892872219669e+00,	8.8457837599351385e-01],
    [2.6410168614163183e+00,	1.1286830602703735e+00,	8.8457837599351385e-01],
    [2.8866928485248136e+00,	1.2336768333187806e+00,	8.8457837599351385e-01],
    [3.1323688356333088e+00,	1.3386706063671874e+00,	8.8457837599351385e-01],
    [3.3780448227418041e+00,	1.4436643794155943e+00,	8.8457837599351385e-01],
    [3.6237208098502984e+00,	1.5486581524640008e+00,	8.8457837599351385e-01],
    [3.8693967969587937e+00,	1.6536519255124076e+00,	8.8457837599351385e-01],
    [4.1150727840672880e+00,	1.7586456985608145e+00,	8.8457837599351385e-01],
    [4.3607487711757837e+00,	1.8636394716092217e+00,	8.8457837599351363e-01],
    [4.5245327625814458e+00,	1.9336353203081591e+00,	8.8457837599351385e-01],
    [4.6064247582842777e+00,	1.9686332446576282e+00,	8.8457837599351385e-01],
    [8.7383774039536144e-01,	4.9023627538125752e-01,	8.6895740432346291e-01],
    [9.5151220620828236e-01,	5.3381283319292483e-01,	8.6895740432346291e-01],
    [1.1068611378341244e+00,	6.2096594881625955e-01,	8.6895740432346280e-01],
    [1.3398845352728874e+00,	7.5169562225126141e-01,	8.6895740432346313e-01],
    [1.5729079327116509e+00,	8.8242529568626360e-01,	8.6895740432346291e-01],
    [1.8059313301504134e+00,	1.0131549691212653e+00,	8.6895740432346324e-01],
    [2.0389547275891773e+00,	1.1438846425562677e+00,	8.6895740432346291e-01],
    [2.2719781250279398e+00,	1.2746143159912697e+00,	8.6895740432346291e-01],
    [2.5050015224667024e+00,	1.4053439894262714e+00,	8.6895740432346291e-01],
    [2.7380249199054654e+00,	1.5360736628612734e+00,	8.6895740432346291e-01],
    [2.9710483173442288e+00,	1.6668033362962753e+00,	8.6895740432346291e-01],
    [3.2040717147829918e+00,	1.7975330097312774e+00,	8.6895740432346291e-01],
    [3.4370951122217548e+00,	1.9282626831662792e+00,	8.6895740432346291e-01],
    [3.6701185096605182e+00,	2.0589923566012813e+00,	8.6895740432346291e-01],
    [3.9031419070992808e+00,	2.1897220300362834e+00,	8.6895740432346291e-01],
    [4.1361653045380447e+00,	2.3204517034712855e+00,	8.6895740432346280e-01],
    [4.2915142361638861e+00,	2.4076048190946202e+00,	8.6895740432346291e-01],
    [4.3691887019768068e+00,	2.4511813769062871e+00,	8.6895740432346291e-01],
    [8.1536342340633472e-01,	5.8241073331152327e-01,	8.5854342321009547e-01],
    [8.8784017215356448e-01,	6.3418057627254754e-01,	8.5854342321009547e-01],
    [1.0327936696480240e+00,	7.3772026219459608e-01,	8.5854342321009547e-01],
    [1.2502239158897128e+00,	8.9302979107766856e-01,	8.5854342321009591e-01],
    [1.4676541621314023e+00,	1.0483393199607416e+00,	8.5854342321009569e-01],
    [1.6850844083730911e+00,	1.2036488488438142e+00,	8.5854342321009591e-01],
    [1.9025146546147809e+00,	1.3589583777268872e+00,	8.5854342321009569e-01],
    [2.1199449008564701e+00,	1.5142679066099602e+00,	8.5854342321009569e-01],
    [2.3373751470981596e+00,	1.6695774354930331e+00,	8.5854342321009547e-01],
    [2.5548053933398487e+00,	1.8248869643761059e+00,	8.5854342321009547e-01],
    [2.7722356395815386e+00,	1.9801964932591789e+00,	8.5854342321009547e-01],
    [2.9896658858232263e+00,	2.1355060221422510e+00,	8.5854342321009569e-01],
    [3.2070961320649167e+00,	2.2908155510253247e+00,	8.5854342321009547e-01],
    [3.4245263783066062e+00,	2.4461250799083971e+00,	8.5854342321009547e-01],
    [3.6419566245482953e+00,	2.6014346087914704e+00,	8.5854342321009547e-01],
    [3.8593868707899848e+00,	2.7567441376745432e+00,	8.5854342321009547e-01],
    [4.0043403682844438e+00,	2.8602838235965917e+00,	8.5854342321009547e-01],
    [4.0768171170316734e+00,	2.9120536665576160e+00,	8.5854342321009547e-01],
    [7.4652869838952918e-01,	6.6840398213972652e-01,	8.5333643265341186e-01],
    [8.1288680491304299e-01,	7.2781766944103554e-01,	8.5333643265341186e-01],
    [9.4560301796007018e-01,	8.4664504404365359e-01,	8.5333643265341186e-01],
    [1.1446773375306112e+00,	1.0248861059475805e+00,	8.5333643265341219e-01],
    [1.3437516571011525e+00,	1.2031271678515074e+00,	8.5333643265341208e-01],
    [1.5428259766716932e+00,	1.3813682297554344e+00,	8.5333643265341230e-01],
    [1.7419002962422345e+00,	1.5596092916593614e+00,	8.5333643265341208e-01],
    [1.9409746158127756e+00,	1.7378503535632890e+00,	8.5333643265341208e-01],
    [2.1400489353833168e+00,	1.9160914154672160e+00,	8.5333643265341186e-01],
    [2.3391232549538579e+00,	2.0943324773711427e+00,	8.5333643265341186e-01],
    [2.5381975745243990e+00,	2.2725735392750699e+00,	8.5333643265341186e-01],
    [2.7372718940949397e+00,	2.4508146011789962e+00,	8.5333643265341208e-01],
    [2.9363462136654812e+00,	2.6290556630829247e+00,	8.5333643265341186e-01],
    [3.1354205332360228e+00,	2.8072967249868515e+00,	8.5333643265341186e-01],
    [3.3344948528065634e+00,	2.9855377868907786e+00,	8.5333643265341186e-01],
    [3.5335691723771050e+00,	3.1637788487947049e+00,	8.5333643265341186e-01],
    [3.6662853854241320e+00,	3.2826062233973232e+00,	8.5333643265341186e-01],
    [3.7326434919476457e+00,	3.3420199106986326e+00,	8.5333643265341186e-01],
    [6.6840398213972640e-01,	7.4652869838952907e-01,	8.5333643265341197e-01],
    [7.2781766944103554e-01,	8.1288680491304288e-01,	8.5333643265341197e-01],
    [8.4664504404365337e-01,	9.4560301796007018e-01,	8.5333643265341197e-01],
    [1.0248861059475805e+00,	1.1446773375306112e+00,	8.5333643265341219e-01],
    [1.2031271678515074e+00,	1.3437516571011525e+00,	8.5333643265341208e-01],
    [1.3813682297554344e+00,	1.5428259766716932e+00,	8.5333643265341230e-01],
    [1.5596092916593618e+00,	1.7419002962422347e+00,	8.5333643265341208e-01],
    [1.7378503535632890e+00,	1.9409746158127759e+00,	8.5333643265341208e-01],
    [1.9160914154672157e+00,	2.1400489353833168e+00,	8.5333643265341197e-01],
    [2.0943324773711427e+00,	2.3391232549538579e+00,	8.5333643265341197e-01],
    [2.2725735392750694e+00,	2.5381975745243990e+00,	8.5333643265341197e-01],
    [2.4508146011789962e+00,	2.7372718940949397e+00,	8.5333643265341208e-01],
    [2.6290556630829243e+00,	2.9363462136654812e+00,	8.5333643265341197e-01],
    [2.8072967249868510e+00,	3.1354205332360223e+00,	8.5333643265341197e-01],
    [2.9855377868907782e+00,	3.3344948528065639e+00,	8.5333643265341197e-01],
    [3.1637788487947054e+00,	3.5335691723771050e+00,	8.5333643265341186e-01],
    [3.2826062233973228e+00,	3.6662853854241324e+00,	8.5333643265341197e-01],
    [3.3420199106986321e+00,	3.7326434919476457e+00,	8.5333643265341197e-01],
    [5.8241073331152293e-01,	8.1536342340633439e-01,	8.5854342321009569e-01],
    [6.3418057627254720e-01,	8.8784017215356426e-01,	8.5854342321009569e-01],
    [7.3772026219459597e-01,	1.0327936696480238e+00,	8.5854342321009547e-01],
    [8.9302979107766867e-01,	1.2502239158897130e+00,	8.5854342321009569e-01],
    [1.0483393199607416e+00,	1.4676541621314021e+00,	8.5854342321009569e-01],
    [1.2036488488438142e+00,	1.6850844083730914e+00,	8.5854342321009580e-01],
    [1.3589583777268872e+00,	1.9025146546147809e+00,	8.5854342321009569e-01],
    [1.5142679066099600e+00,	2.1199449008564697e+00,	8.5854342321009569e-01],
    [1.6695774354930324e+00,	2.3373751470981587e+00,	8.5854342321009569e-01],
    [1.8248869643761052e+00,	2.5548053933398482e+00,	8.5854342321009569e-01],
    [1.9801964932591780e+00,	2.7722356395815368e+00,	8.5854342321009569e-01],
    [2.1355060221422510e+00,	2.9896658858232263e+00,	8.5854342321009569e-01],
    [2.2908155510253239e+00,	3.2070961320649154e+00,	8.5854342321009569e-01],
    [2.4461250799083967e+00,	3.4245263783066049e+00,	8.5854342321009569e-01],
    [2.6014346087914690e+00,	3.6419566245482939e+00,	8.5854342321009569e-01],
    [2.7567441376745432e+00,	3.8593868707899839e+00,	8.5854342321009547e-01],
    [2.8602838235965904e+00,	4.0043403682844430e+00,	8.5854342321009569e-01],
    [2.9120536665576147e+00,	4.0768171170316725e+00,	8.5854342321009569e-01],
    [4.9023627538125758e-01,	8.7383774039536155e-01,	8.6895740432346269e-01],
    [5.3381283319292494e-01,	9.5151220620828247e-01,	8.6895740432346269e-01],
    [6.2096594881625955e-01,	1.1068611378341247e+00,	8.6895740432346269e-01],
    [7.5169562225126152e-01,	1.3398845352728874e+00,	8.6895740432346302e-01],
    [8.8242529568626382e-01,	1.5729079327116509e+00,	8.6895740432346269e-01],
    [1.0131549691212656e+00,	1.8059313301504134e+00,	8.6895740432346302e-01],
    [1.1438846425562681e+00,	2.0389547275891773e+00,	8.6895740432346269e-01],
    [1.2746143159912700e+00,	2.2719781250279403e+00,	8.6895740432346269e-01],
    [1.4053439894262718e+00,	2.5050015224667028e+00,	8.6895740432346269e-01],
    [1.5360736628612739e+00,	2.7380249199054658e+00,	8.6895740432346269e-01],
    [1.6668033362962760e+00,	2.9710483173442284e+00,	8.6895740432346269e-01],
    [1.7975330097312778e+00,	3.2040717147829918e+00,	8.6895740432346269e-01],
    [1.9282626831662797e+00,	3.4370951122217548e+00,	8.6895740432346269e-01],
    [2.0589923566012822e+00,	3.6701185096605182e+00,	8.6895740432346269e-01],
    [2.1897220300362839e+00,	3.9031419070992812e+00,	8.6895740432346269e-01],
    [2.3204517034712859e+00,	4.1361653045380438e+00,	8.6895740432346269e-01],
    [2.4076048190946211e+00,	4.2915142361638869e+00,	8.6895740432346269e-01],
    [2.4511813769062876e+00,	4.3691887019768076e+00,	8.6895740432346269e-01],
    [3.9372664893152570e-01,	9.2128495165685553e-01,	8.8457837599351352e-01],
    [4.2872457328099478e-01,	1.0031769473596872e+00,	8.8457837599351352e-01],
    [4.9872042197993260e-01,	1.1669609387653503e+00,	8.8457837599351352e-01],
    [6.0371419502833945e-01,	1.4126369258738452e+00,	8.8457837599351374e-01],
    [7.0870796807674641e-01,	1.6583129129823402e+00,	8.8457837599351363e-01],
    [8.1370174112515314e-01,	1.9039889000908345e+00,	8.8457837599351385e-01],
    [9.1869551417356021e-01,	2.1496648871993296e+00,	8.8457837599351363e-01],
    [1.0236892872219672e+00,	2.3953408743078248e+00,	8.8457837599351363e-01],
    [1.1286830602703739e+00,	2.6410168614163192e+00,	8.8457837599351352e-01],
    [1.2336768333187809e+00,	2.8866928485248144e+00,	8.8457837599351352e-01],
    [1.3386706063671876e+00,	3.1323688356333093e+00,	8.8457837599351352e-01],
    [1.4436643794155943e+00,	3.3780448227418032e+00,	8.8457837599351363e-01],
    [1.5486581524640013e+00,	3.6237208098502989e+00,	8.8457837599351352e-01],
    [1.6536519255124080e+00,	3.8693967969587941e+00,	8.8457837599351352e-01],
    [1.7586456985608150e+00,	4.1150727840672880e+00,	8.8457837599351352e-01],
    [1.8636394716092217e+00,	4.3607487711757837e+00,	8.8457837599351352e-01],
    [1.9336353203081600e+00,	4.5245327625814467e+00,	8.8457837599351352e-01],
    [1.9686332446576289e+00,	4.6064247582842777e+00,	8.8457837599351352e-01],
    [2.9477131806515655e-01,	9.5745720248188881e-01,	9.0540633822024796e-01],
    [3.2097321300428155e-01,	1.0425645093691678e+00,	9.0540633822024796e-01],
    [3.7337700288253162e-01,	1.2127791231437259e+00,	9.0540633822024785e-01],
    [4.5198268769990663e-01,	1.4681010438055626e+00,	9.0540633822024819e-01],
    [5.3058837251728186e-01,	1.7234229644674002e+00,	9.0540633822024796e-01],
    [6.0919405733465692e-01,	1.9787448851292366e+00,	9.0540633822024819e-01],
    [6.8779974215203199e-01,	2.2340668057910742e+00,	9.0540633822024796e-01],
    [7.6640542696940728e-01,	2.4893887264529115e+00,	9.0540633822024796e-01],
    [8.4501111178678223e-01,	2.7447106471147480e+00,	9.0540633822024796e-01],
    [9.2361679660415719e-01,	3.0000325677765849e+00,	9.0540633822024796e-01],
    [1.0022224814215321e+00,	3.2553544884384222e+00,	9.0540633822024796e-01],
    [1.0808281662389074e+00,	3.5106764091002587e+00,	9.0540633822024796e-01],
    [1.1594338510562825e+00,	3.7659983297620960e+00,	9.0540633822024796e-01],
    [1.2380395358736576e+00,	4.0213202504239334e+00,	9.0540633822024796e-01],
    [1.3166452206910326e+00,	4.2766421710857703e+00,	9.0540633822024796e-01],
    [1.3952509055084077e+00,	4.5319640917476072e+00,	9.0540633822024796e-01],
    [1.4476546953866578e+00,	4.7021787055221651e+00,	9.0540633822024796e-01],
    [1.4738565903257828e+00,	4.7872860124094450e+00,	9.0540633822024796e-01],
    [1.9519390339473441e-01,	9.8250421529118992e-01,	9.3144129100366602e-01],
    [2.1254447258537748e-01,	1.0698379233170736e+00,	9.3144129100366602e-01],
    [2.4724561096666361e-01,	1.2445053393688406e+00,	9.3144129100366591e-01],
    [2.9929731853859276e-01,	1.5065064634464911e+00,	9.3144129100366624e-01],
    [3.5134902611052199e-01,	1.7685075875241421e+00,	9.3144129100366602e-01],
    [4.0340073368245111e-01,	2.0305087116017924e+00,	9.3144129100366624e-01],
    [4.5545244125438045e-01,	2.2925098356794433e+00,	9.3144129100366602e-01],
    [5.0750414882630968e-01,	2.5545109597570939e+00,	9.3144129100366602e-01],
    [5.5955585639823868e-01,	2.8165120838347444e+00,	9.3144129100366602e-01],
    [6.1160756397016791e-01,	3.0785132079123949e+00,	9.3144129100366602e-01],
    [6.6365927154209692e-01,	3.3405143319900454e+00,	9.3144129100366602e-01],
    [7.1571097911402626e-01,	3.6025154560676960e+00,	9.3144129100366602e-01],
    [7.6776268668595538e-01,	3.8645165801453469e+00,	9.3144129100366602e-01],
    [8.1981439425788460e-01,	4.1265177042229970e+00,	9.3144129100366602e-01],
    [8.7186610182981383e-01,	4.3885188283006480e+00,	9.3144129100366602e-01],
    [9.2391780940174284e-01,	4.6505199523782990e+00,	9.3144129100366602e-01],
    [9.5861894778302903e-01,	4.8251873684300657e+00,	9.3144129100366602e-01],
    [9.7596951697367207e-01,	4.9125210764559490e+00,	9.3144129100366602e-01],
    [9.6660668218211732e-02,	9.9692218285593936e-01,	9.6268323434376746e-01],
    [1.0525272761538612e-01,	1.0855374879986897e+00,	9.6268323434376746e-01],
    [1.2243684640973489e-01,	1.2627680982841900e+00,	9.6268323434376735e-01],
    [1.4821302460125799e-01,	1.5286140137124402e+00,	9.6268323434376779e-01],
    [1.7398920279278116e-01,	1.7944599291406913e+00,	9.6268323434376746e-01],
    [1.9976538098430424e-01,	2.0603058445689411e+00,	9.6268323434376779e-01],
    [2.2554155917582747e-01,	2.3261517599971921e+00,	9.6268323434376746e-01],
    [2.5131773736735058e-01,	2.5919976754254432e+00,	9.6268323434376746e-01],
    [2.7709391555887369e-01,	2.8578435908536930e+00,	9.6268323434376746e-01],
    [3.0287009375039675e-01,	3.1236895062819436e+00,	9.6268323434376746e-01],
    [3.2864627194191992e-01,	3.3895354217101938e+00,	9.6268323434376746e-01],
    [3.5442245013344309e-01,	3.6553813371384445e+00,	9.6268323434376746e-01],
    [3.8019862832496615e-01,	3.9212272525666956e+00,	9.6268323434376746e-01],
    [4.0597480651648926e-01,	4.1870731679949458e+00,	9.6268323434376746e-01],
    [4.3175098470801249e-01,	4.4529190834231969e+00,	9.6268323434376746e-01],
    [4.5752716289953549e-01,	4.7187649988514471e+00,	9.6268323434376746e-01],
    [4.7471128169388432e-01,	4.8959956091369472e+00,	9.6268323434376746e-01],
    [4.8330334109105866e-01,	4.9846109142796973e+00,	9.6268323434376746e-01],
    [3.1841463552811630e-02,	1.0000000000000000e+00,	9.8698252360829097e-01],
    [3.4671815868617110e-02,	1.0888888888888890e+00,	9.8698252360829097e-01],
    [4.0332520500228064e-02,	1.2666666666666671e+00,	9.8698252360829086e-01],
    [4.8823577447644498e-02,	1.5333333333333332e+00,	9.8698252360829120e-01],
    [5.7314634395060939e-02,	1.8000000000000005e+00,	9.8698252360829097e-01],
    [6.5805691342477379e-02,	2.0666666666666664e+00,	9.8698252360829120e-01],
    [7.4296748289893827e-02,	2.3333333333333339e+00,	9.8698252360829097e-01],
    [8.2787805237310261e-02,	2.6000000000000010e+00,	9.8698252360829097e-01],
    [9.1278862184726681e-02,	2.8666666666666663e+00,	9.8698252360829097e-01],
    [9.9769919132143114e-02,	3.1333333333333337e+00,	9.8698252360829097e-01],
    [1.0826097607955953e-01,	3.3999999999999995e+00,	9.8698252360829097e-01],
    [1.1675203302697598e-01,	3.6666666666666670e+00,	9.8698252360829097e-01],
    [1.2524308997439240e-01,	3.9333333333333336e+00,	9.8698252360829097e-01],
    [1.3373414692180885e-01,	4.2000000000000002e+00,	9.8698252360829097e-01],
    [1.4222520386922527e-01,	4.4666666666666659e+00,	9.8698252360829097e-01],
    [1.5071626081664169e-01,	4.7333333333333334e+00,	9.8698252360829097e-01],
    [1.5637696544825266e-01,	4.9111111111111114e+00,	9.8698252360829097e-01],
    [1.5920731776405814e-01,	5.0000000000000000e+00,	9.8698252360829097e-01],
    [0.0000000000000000e+00,	1.0000000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.0888888888888890e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.2666666666666668e+00,	9.9999999999999989e-01],
    [0.0000000000000000e+00,	1.5333333333333332e+00,	1.0000000000000002e+00],
    [0.0000000000000000e+00,	1.8000000000000003e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	2.0666666666666664e+00,	1.0000000000000002e+00],
    [0.0000000000000000e+00,	2.3333333333333335e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	2.6000000000000005e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	2.8666666666666667e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	3.1333333333333333e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	3.3999999999999995e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	3.6666666666666665e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	3.9333333333333336e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	4.2000000000000002e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	4.4666666666666668e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	4.7333333333333334e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	4.9111111111111114e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	5.0000000000000000e+00,	1.0000000000000000e+00]])

# 重複ありの総コントロールポイント数
allpointnumber_overlapping = 0
for i in range(patch_info.shape[0]):
    allpointnumber_overlapping += patch_info[i][0] * patch_info[i][1]

globalpoint = np.zeros((allpointnumber_overlapping))
globalpoint_x = np.zeros((allpointnumber_overlapping))
globalpoint_y = np.zeros((allpointnumber_overlapping))
globalpoint_w = np.zeros((allpointnumber_overlapping))
globalpoint_bool = np.zeros((allpointnumber_overlapping), dtype = bool)

localpoint = np.zeros((patch_info.shape[0], xi_max * eta_max))
localpoint_bool = np.zeros((patch_info.shape[0], xi_max * eta_max), dtype=bool)
for i in range(patch_info.shape[0]):
    localpoint_bool[i,:patch_info[i][0]*patch_info[i][1]] = True

xi_and_eta_max = xi_max
if xi_max < eta_max:
    xi_and_eta_max = eta_max
A = np.zeros((patch_info.shape[0], 2, 2, xi_and_eta_max))
A_bool = np.zeros((patch_info.shape[0], 2, 2, xi_and_eta_max), dtype=bool)

# connect patch
xi = 0
eta = 1
positive = 0
negative = 1

patch_number = 0
globalpoint, globalpoint_bool, globalpoint_x, globalpoint_y, globalpoint_w, localpoint, localpoint_bool, A, A_bool = \
    mif.connect_patch_arg_0boundary(patch_number, patch_info, patch, patch_bool, globalpoint, globalpoint_bool, globalpoint_x, globalpoint_y, globalpoint_w, localpoint, localpoint_bool, A, A_bool)

# 座標，パッチコネクティビティー，境界の辺をtxt出力
# [patch_number, xi_or_eta, 0_or_1(int)] (auto marge)
boundary_array_0 = np.array([[0, eta, 0],
                             [0, xi, 1]])

boundary_array_1 = np.array([[0,  xi, 1],
                             [0, eta, 1]])

boundary_number = 0
mif.write_date_header(filename)
mif.write_date_localpoint(filename, patch_info, localpoint, localpoint_bool)
mif.write_date_globalpoint(filename, globalpoint, globalpoint_bool, globalpoint_x, globalpoint_y, globalpoint_w)
boundary_number = mif.write_boundary(filename, A, A_bool, boundary_array_0, boundary_number)
boundary_number = mif.write_boundary(filename, A, A_bool, boundary_array_1, boundary_number)


# 描写
color = np.array(["r", "g", "b", "c", "m", "y", "k"])
fig = plt.figure()
ax1 = fig.add_subplot(1, 1, 1)

A = np.zeros((globalpoint[globalpoint_bool].shape[0],3))
for i in range(globalpoint[globalpoint_bool].shape[0]):
    A[i][0] = globalpoint[globalpoint_bool][i]
    A[i][1] = globalpoint_x[globalpoint_bool][i]
    A[i][2] = globalpoint_y[globalpoint_bool][i]
ax1.plot(A[:,1], A[:,2], c=color[0], marker="", linewidth=0.7)
for i in range(globalpoint[globalpoint_bool].shape[0]):
    ax1.text(A[i,1], A[i,2], str(int(A[i,0])), c=color[3], fontsize=6)


ax1.set_aspect('equal', adjustable='box')
ax1.set_axisbelow(True)
fig.set_figheight(9)
fig.set_figwidth(12)
ax1.grid()
ax1.set_xlim(-1, 3)
ax1.set_ylim(-1, 3)
plt.show()