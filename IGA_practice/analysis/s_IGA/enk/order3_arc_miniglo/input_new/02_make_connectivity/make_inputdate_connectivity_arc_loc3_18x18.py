import numpy as np
import matplotlib.pyplot as plt
import math
import make_inputdate_function as mif

# difine filename
filename = "connectivity_arc_loc3_18x18"

# patch info (ξ方向のコントロールポイント個数, η方向のコントロールポイント個数)
patch_info = np.array([18, 18])

# patch info 1行2列の時の例外処理
if np.array(patch_info.shape).shape[0] == 1:
    patch_info = np.array([[patch_info[0], patch_info[1]]])

xi_max = 0
eta_max = 0
for i in range(patch_info.shape[0]):
    if xi_max < patch_info[i][0]:
        xi_max = patch_info[i][0]
    if eta_max < patch_info[i][1]:
        eta_max = patch_info[i][1]

# パッチのコントロールポイント 座標，重み
patch = np.zeros((patch_info.shape[0], xi_max * eta_max, 3))
patch_bool = np.zeros((patch_info.shape[0], xi_max * eta_max, 3), dtype=bool)
for i in range(patch_info.shape[0]):
    patch_bool[i,:patch_info[i][0]*patch_info[i][1],:] = True

# 各パッチ入力
num = 0
patch[num,:patch_info[num][0]*patch_info[num][1],:] = np.array(
   [[1.0000000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.0222222222222221e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.0666666666666669e+00,	0.0000000000000000e+00,	9.9999999999999989e-01],
    [1.1333333333333331e+00,	0.0000000000000000e+00,	1.0000000000000002e+00],
    [1.2000000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.2666666666666666e+00,	0.0000000000000000e+00,	1.0000000000000002e+00],
    [1.3333333333333335e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.4000000000000001e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.4666666666666668e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.5333333333333332e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.6000000000000001e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.6666666666666665e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.7333333333333334e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.8000000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.8666666666666667e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.9333333333333331e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.9777777777777779e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [2.0000000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.0000000000000000e+00,	3.1841463552811644e-02,	9.8698252360829097e-01],
    [1.0222222222222221e+00,	3.2549051631763005e-02,	9.8698252360829097e-01],
    [1.0666666666666669e+00,	3.3964227789665756e-02,	9.8698252360829086e-01],
    [1.1333333333333331e+00,	3.6086992026519854e-02,	9.8698252360829120e-01],
    [1.2000000000000000e+00,	3.8209756263373973e-02,	9.8698252360829097e-01],
    [1.2666666666666664e+00,	4.0332520500228071e-02,	9.8698252360829131e-01],
    [1.3333333333333337e+00,	4.2455284737082204e-02,	9.8698252360829097e-01],
    [1.4000000000000001e+00,	4.4578048973936302e-02,	9.8698252360829097e-01],
    [1.4666666666666668e+00,	4.6700813210790414e-02,	9.8698252360829097e-01],
    [1.5333333333333332e+00,	4.8823577447644512e-02,	9.8698252360829097e-01],
    [1.6000000000000001e+00,	5.0946341684498617e-02,	9.8698252360829097e-01],
    [1.6666666666666665e+00,	5.3069105921352722e-02,	9.8698252360829097e-01],
    [1.7333333333333334e+00,	5.5191870158206847e-02,	9.8698252360829097e-01],
    [1.8000000000000003e+00,	5.7314634395060959e-02,	9.8698252360829097e-01],
    [1.8666666666666669e+00,	5.9437398631915064e-02,	9.8698252360829097e-01],
    [1.9333333333333331e+00,	6.1560162868769169e-02,	9.8698252360829097e-01],
    [1.9777777777777779e+00,	6.2975339026671920e-02,	9.8698252360829097e-01],
    [2.0000000000000000e+00,	6.3682927105623288e-02,	9.8698252360829097e-01],
    [9.9692218285593925e-01,	9.6660668218211773e-02,	9.6268323434376757e-01],
    [1.0190760091416269e+00,	9.8808683067505371e-02,	9.6268323434376757e-01],
    [1.0633836617130021e+00,	1.0310471276609258e-01,	9.6268323434376746e-01],
    [1.1298451405700642e+00,	1.0954875731397333e-01,	9.6268323434376790e-01],
    [1.1963066194271270e+00,	1.1599280186185414e-01,	9.6268323434376768e-01],
    [1.2627680982841898e+00,	1.2243684640973490e-01,	9.6268323434376790e-01],
    [1.3292295771412526e+00,	1.2888089095761573e-01,	9.6268323434376768e-01],
    [1.3956910559983151e+00,	1.3532493550549649e-01,	9.6268323434376768e-01],
    [1.4621525348553779e+00,	1.4176898005337729e-01,	9.6268323434376757e-01],
    [1.5286140137124404e+00,	1.4821302460125804e-01,	9.6268323434376757e-01],
    [1.5950754925695032e+00,	1.5465706914913882e-01,	9.6268323434376757e-01],
    [1.6615369714265653e+00,	1.6110111369701957e-01,	9.6268323434376768e-01],
    [1.7279984502836281e+00,	1.6754515824490041e-01,	9.6268323434376757e-01],
    [1.7944599291406909e+00,	1.7398920279278118e-01,	9.6268323434376757e-01],
    [1.8609214079977536e+00,	1.8043324734066202e-01,	9.6268323434376757e-01],
    [1.9273828868548160e+00,	1.8687729188854277e-01,	9.6268323434376757e-01],
    [1.9716905394261914e+00,	1.9117332158712996e-01,	9.6268323434376757e-01],
    [1.9938443657118785e+00,	1.9332133643642355e-01,	9.6268323434376757e-01],
    [9.8250421529118992e-01,	1.9519390339473450e-01,	9.3144129100366602e-01],
    [1.0043376422976609e+00,	1.9953154569239523e-01,	9.3144129100366602e-01],
    [1.0480044963106026e+00,	2.0820683028771678e-01,	9.3144129100366602e-01],
    [1.1135047773300153e+00,	2.2121975718069903e-01,	9.3144129100366624e-01],
    [1.1790050583494278e+00,	2.3423268407368139e-01,	9.3144129100366613e-01],
    [1.2445053393688408e+00,	2.4724561096666367e-01,	9.3144129100366624e-01],
    [1.3100056203882533e+00,	2.6025853785964598e-01,	9.3144129100366613e-01],
    [1.3755059014076660e+00,	2.7327146475262826e-01,	9.3144129100366613e-01],
    [1.4410061824270786e+00,	2.8628439164561059e-01,	9.3144129100366602e-01],
    [1.5065064634464911e+00,	2.9929731853859282e-01,	9.3144129100366602e-01],
    [1.5720067444659038e+00,	3.1231024543157515e-01,	9.3144129100366602e-01],
    [1.6375070254853163e+00,	3.2532317232455732e-01,	9.3144129100366613e-01],
    [1.7030073065047293e+00,	3.3833609921753977e-01,	9.3144129100366602e-01],
    [1.7685075875241421e+00,	3.5134902611052210e-01,	9.3144129100366602e-01],
    [1.8340078685435548e+00,	3.6436195300350438e-01,	9.3144129100366602e-01],
    [1.8995081495629669e+00,	3.7737487989648666e-01,	9.3144129100366602e-01],
    [1.9431750035759090e+00,	3.8605016449180818e-01,	9.3144129100366602e-01],
    [1.9650084305823798e+00,	3.9038780678946899e-01,	9.3144129100366602e-01],
    [9.5745720248188881e-01,	2.9477131806515666e-01,	9.0540633822024796e-01],
    [9.7873402920370856e-01,	3.0132179179993790e-01,	9.0540633822024796e-01],
    [1.0212876826473480e+00,	3.1442273926950043e-01,	9.0540633822024796e-01],
    [1.0851181628128073e+00,	3.3407416047384414e-01,	9.0540633822024819e-01],
    [1.1489486429782667e+00,	3.5372558167818802e-01,	9.0540633822024796e-01],
    [1.2127791231437257e+00,	3.7337700288253167e-01,	9.0540633822024819e-01],
    [1.2766096033091854e+00,	3.9302842408687561e-01,	9.0540633822024796e-01],
    [1.3404400834746444e+00,	4.1267984529121932e-01,	9.0540633822024796e-01],
    [1.4042705636401038e+00,	4.3233126649556308e-01,	9.0540633822024796e-01],
    [1.4681010438055628e+00,	4.5198268769990674e-01,	9.0540633822024796e-01],
    [1.5319315239710221e+00,	4.7163410890425056e-01,	9.0540633822024796e-01],
    [1.5957620041364815e+00,	4.9128553010859427e-01,	9.0540633822024796e-01],
    [1.6595924843019407e+00,	5.1093695131293815e-01,	9.0540633822024796e-01],
    [1.7234229644674002e+00,	5.3058837251728186e-01,	9.0540633822024796e-01],
    [1.7872534446328592e+00,	5.5023979372162579e-01,	9.0540633822024796e-01],
    [1.8510839247983182e+00,	5.6989121492596939e-01,	9.0540633822024796e-01],
    [1.8936375782419583e+00,	5.8299216239553198e-01,	9.0540633822024796e-01],
    [1.9149144049637776e+00,	5.8954263613031332e-01,	9.0540633822024796e-01],
    [9.2128495165685553e-01,	3.9372664893152570e-01,	8.8457837599351385e-01],
    [9.4175795058256340e-01,	4.0247613001889287e-01,	8.8457837599351385e-01],
    [9.8270394843397935e-01,	4.1997509219362750e-01,	8.8457837599351363e-01],
    [1.0441229452111027e+00,	4.4622353545572896e-01,	8.8457837599351408e-01],
    [1.1055419419882266e+00,	4.7247197871783086e-01,	8.8457837599351385e-01],
    [1.1669609387653501e+00,	4.9872042197993255e-01,	8.8457837599351408e-01],
    [1.2283799355424740e+00,	5.2496886524203434e-01,	8.8457837599351385e-01],
    [1.2897989323195980e+00,	5.5121730850413597e-01,	8.8457837599351385e-01],
    [1.3512179290967214e+00,	5.7746575176623760e-01,	8.8457837599351385e-01],
    [1.4126369258738452e+00,	6.0371419502833923e-01,	8.8457837599351385e-01],
    [1.4740559226509689e+00,	6.2996263829044108e-01,	8.8457837599351385e-01],
    [1.5354749194280921e+00,	6.5621108155254271e-01,	8.8457837599351385e-01],
    [1.5968939162052163e+00,	6.8245952481464456e-01,	8.8457837599351385e-01],
    [1.6583129129823400e+00,	7.0870796807674619e-01,	8.8457837599351385e-01],
    [1.7197319097594634e+00,	7.3495641133884804e-01,	8.8457837599351385e-01],
    [1.7811509065365876e+00,	7.6120485460094978e-01,	8.8457837599351363e-01],
    [1.8220969043880033e+00,	7.7870381677568412e-01,	8.8457837599351385e-01],
    [1.8425699033137111e+00,	7.8745329786305140e-01,	8.8457837599351385e-01],
    [8.7383774039536144e-01,	4.9023627538125752e-01,	8.6895740432346291e-01],
    [8.9325635684859150e-01,	5.0113041483417431e-01,	8.6895740432346291e-01],
    [9.3209358975505219e-01,	5.2291869374000810e-01,	8.6895740432346280e-01],
    [9.9034943911474260e-01,	5.5560111209875840e-01,	8.6895740432346313e-01],
    [1.0486052884744337e+00,	5.8828353045750903e-01,	8.6895740432346291e-01],
    [1.1068611378341242e+00,	6.2096594881625944e-01,	8.6895740432346324e-01],
    [1.1651169871938154e+00,	6.5364836717501018e-01,	8.6895740432346291e-01],
    [1.2233728365535061e+00,	6.8633078553376070e-01,	8.6895740432346291e-01],
    [1.2816286859131969e+00,	7.1901320389251100e-01,	8.6895740432346291e-01],
    [1.3398845352728876e+00,	7.5169562225126163e-01,	8.6895740432346291e-01],
    [1.3981403846325779e+00,	7.8437804061001193e-01,	8.6895740432346291e-01],
    [1.4563962339922691e+00,	8.1706045896876234e-01,	8.6895740432346291e-01],
    [1.5146520833519599e+00,	8.4974287732751297e-01,	8.6895740432346291e-01],
    [1.5729079327116506e+00,	8.8242529568626360e-01,	8.6895740432346291e-01],
    [1.6311637820713414e+00,	9.1510771404501412e-01,	8.6895740432346291e-01],
    [1.6894196314310317e+00,	9.4779013240376464e-01,	8.6895740432346280e-01],
    [1.7282568643374925e+00,	9.6957841130959810e-01,	8.6895740432346291e-01],
    [1.7476754807907229e+00,	9.8047255076251505e-01,	8.6895740432346291e-01],
    [8.1536342340633472e-01,	5.8241073331152327e-01,	8.5854342321009547e-01],
    [8.3348261059314221e-01,	5.9535319405177933e-01,	8.5854342321009547e-01],
    [8.6972098496675698e-01,	6.2123811553229147e-01,	8.5854342321009547e-01],
    [9.2407854652717891e-01,	6.6006549775305934e-01,	8.5854342321009591e-01],
    [9.7843610808760151e-01,	6.9889287997382787e-01,	8.5854342321009569e-01],
    [1.0327936696480235e+00,	7.3772026219459574e-01,	8.5854342321009591e-01],
    [1.0871512312084461e+00,	7.7654764441536439e-01,	8.5854342321009569e-01],
    [1.1415087927688685e+00,	8.1537502663613248e-01,	8.5854342321009569e-01],
    [1.1958663543292911e+00,	8.5420240885690080e-01,	8.5854342321009547e-01],
    [1.2502239158897133e+00,	8.9302979107766889e-01,	8.5854342321009547e-01],
    [1.3045814774501356e+00,	9.3185717329843709e-01,	8.5854342321009547e-01],
    [1.3589390390105578e+00,	9.7068455551920507e-01,	8.5854342321009569e-01],
    [1.4132966005709802e+00,	1.0095119377399735e+00,	8.5854342321009547e-01],
    [1.4676541621314023e+00,	1.0483393199607418e+00,	8.5854342321009547e-01],
    [1.5220117236918249e+00,	1.0871667021815099e+00,	8.5854342321009547e-01],
    [1.5763692852522471e+00,	1.1259940844022780e+00,	8.5854342321009547e-01],
    [1.6126076596258623e+00,	1.1518790058827904e+00,	8.5854342321009547e-01],
    [1.6307268468126694e+00,	1.1648214666230465e+00,	8.5854342321009547e-01],
    [7.4652869838952918e-01,	6.6840398213972652e-01,	8.5333643265341186e-01],
    [7.6311822502040749e-01,	6.8325740396505374e-01,	8.5333643265341186e-01],
    [7.9629727828216434e-01,	7.1296424761570820e-01,	8.5333643265341186e-01],
    [8.4606585817479940e-01,	7.5752451309168967e-01,	8.5333643265341219e-01],
    [8.9583443806743479e-01,	8.0208477856767169e-01,	8.5333643265341208e-01],
    [9.4560301796006985e-01,	8.4664504404365326e-01,	8.5333643265341230e-01],
    [9.9537159785270557e-01,	8.9120530951963539e-01,	8.5333643265341208e-01],
    [1.0451401777453406e+00,	9.3576557499561697e-01,	8.5333643265341208e-01],
    [1.0949087576379759e+00,	9.8032584047159887e-01,	8.5333643265341186e-01],
    [1.1446773375306114e+00,	1.0248861059475805e+00,	8.5333643265341186e-01],
    [1.1944459174232465e+00,	1.0694463714235625e+00,	8.5333643265341186e-01],
    [1.2442144973158815e+00,	1.1140066368995438e+00,	8.5333643265341208e-01],
    [1.2939830772085177e+00,	1.1585669023755258e+00,	8.5333643265341186e-01],
    [1.3437516571011525e+00,	1.2031271678515079e+00,	8.5333643265341186e-01],
    [1.3935202369937880e+00,	1.2476874333274897e+00,	8.5333643265341186e-01],
    [1.4432888168864226e+00,	1.2922476988034710e+00,	8.5333643265341186e-01],
    [1.4764678701481799e+00,	1.3219545424541257e+00,	8.5333643265341186e-01],
    [1.4930573967790584e+00,	1.3368079642794530e+00,	8.5333643265341186e-01],
    [6.6840398213972640e-01,	7.4652869838952907e-01,	8.5333643265341197e-01],
    [6.8325740396505363e-01,	7.6311822502040738e-01,	8.5333643265341197e-01],
    [7.1296424761570809e-01,	7.9629727828216423e-01,	8.5333643265341197e-01],
    [7.5752451309168978e-01,	8.4606585817479951e-01,	8.5333643265341219e-01],
    [8.0208477856767169e-01,	8.9583443806743490e-01,	8.5333643265341208e-01],
    [8.4664504404365326e-01,	9.4560301796006996e-01,	8.5333643265341230e-01],
    [8.9120530951963528e-01,	9.9537159785270557e-01,	8.5333643265341208e-01],
    [9.3576557499561697e-01,	1.0451401777453406e+00,	8.5333643265341208e-01],
    [9.8032584047159876e-01,	1.0949087576379759e+00,	8.5333643265341197e-01],
    [1.0248861059475805e+00,	1.1446773375306112e+00,	8.5333643265341197e-01],
    [1.0694463714235622e+00,	1.1944459174232467e+00,	8.5333643265341197e-01],
    [1.1140066368995438e+00,	1.2442144973158815e+00,	8.5333643265341208e-01],
    [1.1585669023755258e+00,	1.2939830772085172e+00,	8.5333643265341197e-01],
    [1.2031271678515076e+00,	1.3437516571011523e+00,	8.5333643265341197e-01],
    [1.2476874333274894e+00,	1.3935202369937878e+00,	8.5333643265341197e-01],
    [1.2922476988034710e+00,	1.4432888168864231e+00,	8.5333643265341186e-01],
    [1.3219545424541255e+00,	1.4764678701481797e+00,	8.5333643265341197e-01],
    [1.3368079642794528e+00,	1.4930573967790581e+00,	8.5333643265341197e-01],
    [5.8241073331152293e-01,	8.1536342340633439e-01,	8.5854342321009569e-01],
    [5.9535319405177900e-01,	8.3348261059314188e-01,	8.5854342321009569e-01],
    [6.2123811553229136e-01,	8.6972098496675687e-01,	8.5854342321009547e-01],
    [6.6006549775305934e-01,	9.2407854652717902e-01,	8.5854342321009569e-01],
    [6.9889287997382754e-01,	9.7843610808760129e-01,	8.5854342321009569e-01],
    [7.3772026219459585e-01,	1.0327936696480238e+00,	8.5854342321009580e-01],
    [7.7654764441536417e-01,	1.0871512312084461e+00,	8.5854342321009569e-01],
    [8.1537502663613226e-01,	1.1415087927688683e+00,	8.5854342321009569e-01],
    [8.5420240885690046e-01,	1.1958663543292904e+00,	8.5854342321009569e-01],
    [8.9302979107766867e-01,	1.2502239158897128e+00,	8.5854342321009569e-01],
    [9.3185717329843676e-01,	1.3045814774501350e+00,	8.5854342321009569e-01],
    [9.7068455551920485e-01,	1.3589390390105571e+00,	8.5854342321009569e-01],
    [1.0095119377399733e+00,	1.4132966005709799e+00,	8.5854342321009569e-01],
    [1.0483393199607411e+00,	1.4676541621314021e+00,	8.5854342321009569e-01],
    [1.0871667021815097e+00,	1.5220117236918245e+00,	8.5854342321009569e-01],
    [1.1259940844022778e+00,	1.5763692852522466e+00,	8.5854342321009547e-01],
    [1.1518790058827899e+00,	1.6126076596258612e+00,	8.5854342321009569e-01],
    [1.1648214666230459e+00,	1.6307268468126688e+00,	8.5854342321009569e-01],
    [4.9023627538125758e-01,	8.7383774039536155e-01,	8.6895740432346269e-01],
    [5.0113041483417442e-01,	8.9325635684859162e-01,	8.6895740432346269e-01],
    [5.2291869374000810e-01,	9.3209358975505230e-01,	8.6895740432346269e-01],
    [5.5560111209875851e-01,	9.9034943911474260e-01,	8.6895740432346302e-01],
    [5.8828353045750914e-01,	1.0486052884744339e+00,	8.6895740432346269e-01],
    [6.2096594881625955e-01,	1.1068611378341242e+00,	8.6895740432346302e-01],
    [6.5364836717501029e-01,	1.1651169871938154e+00,	8.6895740432346269e-01],
    [6.8633078553376070e-01,	1.2233728365535061e+00,	8.6895740432346269e-01],
    [7.1901320389251111e-01,	1.2816286859131969e+00,	8.6895740432346269e-01],
    [7.5169562225126163e-01,	1.3398845352728874e+00,	8.6895740432346269e-01],
    [7.8437804061001226e-01,	1.3981403846325784e+00,	8.6895740432346269e-01],
    [8.1706045896876256e-01,	1.4563962339922689e+00,	8.6895740432346269e-01],
    [8.4974287732751319e-01,	1.5146520833519599e+00,	8.6895740432346269e-01],
    [8.8242529568626371e-01,	1.5729079327116506e+00,	8.6895740432346269e-01],
    [9.1510771404501423e-01,	1.6311637820713414e+00,	8.6895740432346269e-01],
    [9.4779013240376442e-01,	1.6894196314310319e+00,	8.6895740432346269e-01],
    [9.6957841130959832e-01,	1.7282568643374927e+00,	8.6895740432346269e-01],
    [9.8047255076251516e-01,	1.7476754807907231e+00,	8.6895740432346269e-01],
    [3.9372664893152570e-01,	9.2128495165685553e-01,	8.8457837599351352e-01],
    [4.0247613001889293e-01,	9.4175795058256351e-01,	8.8457837599351352e-01],
    [4.1997509219362744e-01,	9.8270394843397924e-01,	8.8457837599351352e-01],
    [4.4622353545572913e-01,	1.0441229452111027e+00,	8.8457837599351374e-01],
    [4.7247197871783086e-01,	1.1055419419882266e+00,	8.8457837599351363e-01],
    [4.9872042197993255e-01,	1.1669609387653501e+00,	8.8457837599351385e-01],
    [5.2496886524203434e-01,	1.2283799355424743e+00,	8.8457837599351363e-01],
    [5.5121730850413608e-01,	1.2897989323195980e+00,	8.8457837599351363e-01],
    [5.7746575176623782e-01,	1.3512179290967217e+00,	8.8457837599351352e-01],
    [6.0371419502833945e-01,	1.4126369258738452e+00,	8.8457837599351352e-01],
    [6.2996263829044130e-01,	1.4740559226509691e+00,	8.8457837599351352e-01],
    [6.5621108155254282e-01,	1.5354749194280923e+00,	8.8457837599351363e-01],
    [6.8245952481464467e-01,	1.5968939162052163e+00,	8.8457837599351352e-01],
    [7.0870796807674641e-01,	1.6583129129823402e+00,	8.8457837599351352e-01],
    [7.3495641133884804e-01,	1.7197319097594639e+00,	8.8457837599351352e-01],
    [7.6120485460094967e-01,	1.7811509065365874e+00,	8.8457837599351352e-01],
    [7.7870381677568434e-01,	1.8220969043880033e+00,	8.8457837599351352e-01],
    [7.8745329786305140e-01,	1.8425699033137111e+00,	8.8457837599351352e-01],
    [2.9477131806515655e-01,	9.5745720248188881e-01,	9.0540633822024796e-01],
    [3.0132179179993784e-01,	9.7873402920370844e-01,	9.0540633822024796e-01],
    [3.1442273926950032e-01,	1.0212876826473480e+00,	9.0540633822024785e-01],
    [3.3407416047384403e-01,	1.0851181628128070e+00,	9.0540633822024819e-01],
    [3.5372558167818791e-01,	1.1489486429782665e+00,	9.0540633822024796e-01],
    [3.7337700288253162e-01,	1.2127791231437257e+00,	9.0540633822024819e-01],
    [3.9302842408687544e-01,	1.2766096033091854e+00,	9.0540633822024796e-01],
    [4.1267984529121921e-01,	1.3404400834746446e+00,	9.0540633822024796e-01],
    [4.3233126649556292e-01,	1.4042705636401038e+00,	9.0540633822024796e-01],
    [4.5198268769990668e-01,	1.4681010438055628e+00,	9.0540633822024796e-01],
    [4.7163410890425045e-01,	1.5319315239710221e+00,	9.0540633822024796e-01],
    [4.9128553010859422e-01,	1.5957620041364813e+00,	9.0540633822024796e-01],
    [5.1093695131293804e-01,	1.6595924843019405e+00,	9.0540633822024796e-01],
    [5.3058837251728186e-01,	1.7234229644674000e+00,	9.0540633822024796e-01],
    [5.5023979372162557e-01,	1.7872534446328592e+00,	9.0540633822024796e-01],
    [5.6989121492596917e-01,	1.8510839247983182e+00,	9.0540633822024796e-01],
    [5.8299216239553187e-01,	1.8936375782419581e+00,	9.0540633822024796e-01],
    [5.8954263613031310e-01,	1.9149144049637776e+00,	9.0540633822024796e-01],
    [1.9519390339473441e-01,	9.8250421529118992e-01,	9.3144129100366602e-01],
    [1.9953154569239520e-01,	1.0043376422976606e+00,	9.3144129100366602e-01],
    [2.0820683028771672e-01,	1.0480044963106026e+00,	9.3144129100366591e-01],
    [2.2121975718069900e-01,	1.1135047773300151e+00,	9.3144129100366624e-01],
    [2.3423268407368134e-01,	1.1790050583494278e+00,	9.3144129100366602e-01],
    [2.4724561096666356e-01,	1.2445053393688406e+00,	9.3144129100366624e-01],
    [2.6025853785964592e-01,	1.3100056203882533e+00,	9.3144129100366602e-01],
    [2.7327146475262820e-01,	1.3755059014076658e+00,	9.3144129100366602e-01],
    [2.8628439164561048e-01,	1.4410061824270786e+00,	9.3144129100366602e-01],
    [2.9929731853859282e-01,	1.5065064634464911e+00,	9.3144129100366602e-01],
    [3.1231024543157504e-01,	1.5720067444659038e+00,	9.3144129100366602e-01],
    [3.2532317232455732e-01,	1.6375070254853163e+00,	9.3144129100366602e-01],
    [3.3833609921753971e-01,	1.7030073065047293e+00,	9.3144129100366602e-01],
    [3.5134902611052199e-01,	1.7685075875241421e+00,	9.3144129100366602e-01],
    [3.6436195300350427e-01,	1.8340078685435546e+00,	9.3144129100366602e-01],
    [3.7737487989648644e-01,	1.8995081495629669e+00,	9.3144129100366602e-01],
    [3.8605016449180807e-01,	1.9431750035759088e+00,	9.3144129100366602e-01],
    [3.9038780678946883e-01,	1.9650084305823798e+00,	9.3144129100366602e-01],
    [9.6660668218211732e-02,	9.9692218285593936e-01,	9.6268323434376746e-01],
    [9.8808683067505329e-02,	1.0190760091416269e+00,	9.6268323434376746e-01],
    [1.0310471276609254e-01,	1.0633836617130021e+00,	9.6268323434376735e-01],
    [1.0954875731397329e-01,	1.1298451405700645e+00,	9.6268323434376779e-01],
    [1.1599280186185409e-01,	1.1963066194271272e+00,	9.6268323434376746e-01],
    [1.2243684640973486e-01,	1.2627680982841896e+00,	9.6268323434376779e-01],
    [1.2888089095761568e-01,	1.3292295771412528e+00,	9.6268323434376746e-01],
    [1.3532493550549646e-01,	1.3956910559983153e+00,	9.6268323434376746e-01],
    [1.4176898005337721e-01,	1.4621525348553781e+00,	9.6268323434376746e-01],
    [1.4821302460125801e-01,	1.5286140137124402e+00,	9.6268323434376746e-01],
    [1.5465706914913879e-01,	1.5950754925695032e+00,	9.6268323434376746e-01],
    [1.6110111369701954e-01,	1.6615369714265658e+00,	9.6268323434376746e-01],
    [1.6754515824490038e-01,	1.7279984502836283e+00,	9.6268323434376746e-01],
    [1.7398920279278110e-01,	1.7944599291406909e+00,	9.6268323434376746e-01],
    [1.8043324734066191e-01,	1.8609214079977536e+00,	9.6268323434376746e-01],
    [1.8687729188854268e-01,	1.9273828868548160e+00,	9.6268323434376746e-01],
    [1.9117332158712991e-01,	1.9716905394261914e+00,	9.6268323434376746e-01],
    [1.9332133643642346e-01,	1.9938443657118787e+00,	9.6268323434376746e-01],
    [3.1841463552811630e-02,	1.0000000000000000e+00,	9.8698252360829097e-01],
    [3.2549051631762999e-02,	1.0222222222222221e+00,	9.8698252360829097e-01],
    [3.3964227789665742e-02,	1.0666666666666669e+00,	9.8698252360829086e-01],
    [3.6086992026519847e-02,	1.1333333333333331e+00,	9.8698252360829120e-01],
    [3.8209756263373959e-02,	1.2000000000000000e+00,	9.8698252360829097e-01],
    [4.0332520500228057e-02,	1.2666666666666666e+00,	9.8698252360829120e-01],
    [4.2455284737082183e-02,	1.3333333333333337e+00,	9.8698252360829097e-01],
    [4.4578048973936281e-02,	1.4000000000000001e+00,	9.8698252360829097e-01],
    [4.6700813210790386e-02,	1.4666666666666668e+00,	9.8698252360829097e-01],
    [4.8823577447644505e-02,	1.5333333333333332e+00,	9.8698252360829097e-01],
    [5.0946341684498603e-02,	1.6000000000000001e+00,	9.8698252360829097e-01],
    [5.3069105921352715e-02,	1.6666666666666665e+00,	9.8698252360829097e-01],
    [5.5191870158206834e-02,	1.7333333333333334e+00,	9.8698252360829097e-01],
    [5.7314634395060932e-02,	1.8000000000000003e+00,	9.8698252360829097e-01],
    [5.9437398631915044e-02,	1.8666666666666669e+00,	9.8698252360829097e-01],
    [6.1560162868769135e-02,	1.9333333333333331e+00,	9.8698252360829097e-01],
    [6.2975339026671892e-02,	1.9777777777777779e+00,	9.8698252360829097e-01],
    [6.3682927105623260e-02,	2.0000000000000000e+00,	9.8698252360829097e-01],
    [0.0000000000000000e+00,	1.0000000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.0222222222222221e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.0666666666666669e+00,	9.9999999999999989e-01],
    [0.0000000000000000e+00,	1.1333333333333331e+00,	1.0000000000000002e+00],
    [0.0000000000000000e+00,	1.2000000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.2666666666666666e+00,	1.0000000000000002e+00],
    [0.0000000000000000e+00,	1.3333333333333335e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.4000000000000001e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.4666666666666668e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.5333333333333332e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.6000000000000001e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.6666666666666665e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.7333333333333334e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.8000000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.8666666666666667e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.9333333333333331e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.9777777777777779e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	2.0000000000000000e+00,	1.0000000000000000e+00]])

# 重複ありの総コントロールポイント数
allpointnumber_overlapping = 0
for i in range(patch_info.shape[0]):
    allpointnumber_overlapping += patch_info[i][0] * patch_info[i][1]

globalpoint = np.zeros((allpointnumber_overlapping))
globalpoint_x = np.zeros((allpointnumber_overlapping))
globalpoint_y = np.zeros((allpointnumber_overlapping))
globalpoint_w = np.zeros((allpointnumber_overlapping))
globalpoint_bool = np.zeros((allpointnumber_overlapping), dtype = bool)

localpoint = np.zeros((patch_info.shape[0], xi_max * eta_max))
localpoint_bool = np.zeros((patch_info.shape[0], xi_max * eta_max), dtype=bool)
for i in range(patch_info.shape[0]):
    localpoint_bool[i,:patch_info[i][0]*patch_info[i][1]] = True

xi_and_eta_max = xi_max
if xi_max < eta_max:
    xi_and_eta_max = eta_max
A = np.zeros((patch_info.shape[0], 2, 2, xi_and_eta_max))
A_bool = np.zeros((patch_info.shape[0], 2, 2, xi_and_eta_max), dtype=bool)

# connect patch
xi = 0
eta = 1
positive = 0
negative = 1

patch_number = 0
globalpoint, globalpoint_bool, globalpoint_x, globalpoint_y, globalpoint_w, localpoint, localpoint_bool, A, A_bool = \
    mif.connect_patch_arg_0boundary(patch_number, patch_info, patch, patch_bool, globalpoint, globalpoint_bool, globalpoint_x, globalpoint_y, globalpoint_w, localpoint, localpoint_bool, A, A_bool)

# 座標，パッチコネクティビティー，境界の辺をtxt出力
# [patch_number, xi_or_eta, 0_or_1(int)] (auto marge)
boundary_array_0 = np.array([[0, eta, 0],
                             [0, xi, 1]])

boundary_array_1 = np.array([[0,  xi, 1],
                             [0, eta, 1]])

boundary_number = 0
mif.write_date_header(filename)
mif.write_date_localpoint(filename, patch_info, localpoint, localpoint_bool)
mif.write_date_globalpoint(filename, globalpoint, globalpoint_bool, globalpoint_x, globalpoint_y, globalpoint_w)
boundary_number = mif.write_boundary(filename, A, A_bool, boundary_array_0, boundary_number)
boundary_number = mif.write_boundary(filename, A, A_bool, boundary_array_1, boundary_number)


# 描写
color = np.array(["r", "g", "b", "c", "m", "y", "k"])
fig = plt.figure()
ax1 = fig.add_subplot(1, 1, 1)

A = np.zeros((globalpoint[globalpoint_bool].shape[0],3))
for i in range(globalpoint[globalpoint_bool].shape[0]):
    A[i][0] = globalpoint[globalpoint_bool][i]
    A[i][1] = globalpoint_x[globalpoint_bool][i]
    A[i][2] = globalpoint_y[globalpoint_bool][i]
ax1.plot(A[:,1], A[:,2], c=color[0], marker="", linewidth=0.7)
for i in range(globalpoint[globalpoint_bool].shape[0]):
    ax1.text(A[i,1], A[i,2], str(int(A[i,0])), c=color[3], fontsize=6)


ax1.set_aspect('equal', adjustable='box')
ax1.set_axisbelow(True)
fig.set_figheight(9)
fig.set_figwidth(12)
ax1.grid()
ax1.set_xlim(-1, 3)
ax1.set_ylim(-1, 3)
plt.show()