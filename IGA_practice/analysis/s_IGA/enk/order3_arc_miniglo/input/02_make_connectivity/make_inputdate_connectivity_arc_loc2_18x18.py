import numpy as np
import matplotlib.pyplot as plt
import math
import make_inputdate_function as mif

# difine filename
filename = "connectivity_arc_loc2_18x18"

# patch info (ξ方向のコントロールポイント個数, η方向のコントロールポイント個数)
patch_info = np.array([18, 18])

# patch info 1行2列の時の例外処理
if np.array(patch_info.shape).shape[0] == 1:
    patch_info = np.array([[patch_info[0], patch_info[1]]])

xi_max = 0
eta_max = 0
for i in range(patch_info.shape[0]):
    if xi_max < patch_info[i][0]:
        xi_max = patch_info[i][0]
    if eta_max < patch_info[i][1]:
        eta_max = patch_info[i][1]

# パッチのコントロールポイント 座標，重み
patch = np.zeros((patch_info.shape[0], xi_max * eta_max, 3))
patch_bool = np.zeros((patch_info.shape[0], xi_max * eta_max, 3), dtype=bool)
for i in range(patch_info.shape[0]):
    patch_bool[i,:patch_info[i][0]*patch_info[i][1],:] = True

# 各パッチ入力
num = 0
patch[num,:patch_info[num][0]*patch_info[num][1],:] = np.array(
   [[1.0000000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.0312500000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.0937500000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.1562500000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.2187500000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.2812500000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.3437500000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.4062500000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.4687500000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.5312500000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.5937500000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.6562500000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.7187500000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.7812500000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.8437500000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.9062500000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.9687500000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [2.0000000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.0000000000000000e+00,	4.5018270457898503e-02,	9.8169417382415924e-01],
    [1.0312500000000002e+00,	4.6425091409707825e-02,	9.8169417382415924e-01],
    [1.0937500000000000e+00,	4.9238733313326496e-02,	9.8169417382415924e-01],
    [1.1562500000000000e+00,	5.2052375216945133e-02,	9.8169417382415924e-01],
    [1.2187500000000000e+00,	5.4866017120563798e-02,	9.8169417382415924e-01],
    [1.2812500000000000e+00,	5.7679659024182456e-02,	9.8169417382415924e-01],
    [1.3437500000000000e+00,	6.0493300927801100e-02,	9.8169417382415924e-01],
    [1.4062500000000000e+00,	6.3306942831419771e-02,	9.8169417382415924e-01],
    [1.4687500000000000e+00,	6.6120584735038429e-02,	9.8169417382415924e-01],
    [1.5312499999999998e+00,	6.8934226638657073e-02,	9.8169417382415924e-01],
    [1.5937499999999998e+00,	7.1747868542275731e-02,	9.8169417382415924e-01],
    [1.6562499999999998e+00,	7.4561510445894388e-02,	9.8169417382415924e-01],
    [1.7187500000000000e+00,	7.7375152349513046e-02,	9.8169417382415924e-01],
    [1.7812500000000000e+00,	8.0188794253131704e-02,	9.8169417382415924e-01],
    [1.8437500000000000e+00,	8.3002436156750362e-02,	9.8169417382415924e-01],
    [1.9062500000000000e+00,	8.5816078060368992e-02,	9.8169417382415924e-01],
    [1.9687500000000000e+00,	8.8629719963987677e-02,	9.8169417382415924e-01],
    [2.0000000000000000e+00,	9.0036540915797006e-02,	9.8169417382415924e-01],
    [9.9177336266928362e-01,	1.3620308027477940e-01,	9.4965897801643795e-01],
    [1.0227662802526987e+00,	1.4045942653336624e-01,	9.4965897801643795e-01],
    [1.0847521154195288e+00,	1.4897211905054000e-01,	9.4965897801643795e-01],
    [1.1467379505863591e+00,	1.5748481156771363e-01,	9.4965897801643795e-01],
    [1.2087237857531892e+00,	1.6599750408488742e-01,	9.4965897801643795e-01],
    [1.2707096209200197e+00,	1.7451019660206113e-01,	9.4965897801643795e-01],
    [1.3326954560868498e+00,	1.8302288911923478e-01,	9.4965897801643795e-01],
    [1.3946812912536801e+00,	1.9153558163640858e-01,	9.4965897801643795e-01],
    [1.4566671264205100e+00,	2.0004827415358226e-01,	9.4965897801643795e-01],
    [1.5186529615873405e+00,	2.0856096667075597e-01,	9.4965897801643795e-01],
    [1.5806387967541706e+00,	2.1707365918792965e-01,	9.4965897801643795e-01],
    [1.6426246319210012e+00,	2.2558635170510338e-01,	9.4965897801643795e-01],
    [1.7046104670878310e+00,	2.3409904422227709e-01,	9.4965897801643795e-01],
    [1.7665963022546614e+00,	2.4261173673945083e-01,	9.4965897801643795e-01],
    [1.8285821374214917e+00,	2.5112442925662454e-01,	9.4965897801643795e-01],
    [1.8905679725883218e+00,	2.5963712177379816e-01,	9.4965897801643795e-01],
    [1.9525538077551519e+00,	2.6814981429097190e-01,	9.4965897801643795e-01],
    [1.9835467253385672e+00,	2.7240616054955880e-01,	9.4965897801643795e-01],
    [9.7458523754916782e-01,	2.2908553899142386e-01,	9.2220023875267665e-01],
    [1.0050410262225795e+00,	2.3624446208490579e-01,	9.2220023875267665e-01],
    [1.0659526035694025e+00,	2.5056230827186987e-01,	9.2220023875267665e-01],
    [1.1268641809162252e+00,	2.6488015445883378e-01,	9.2220023875267665e-01],
    [1.1877757582630484e+00,	2.7919800064579792e-01,	9.2220023875267665e-01],
    [1.2486873356098716e+00,	2.9351584683276188e-01,	9.2220023875267665e-01],
    [1.3095989129566943e+00,	3.0783369301972585e-01,	9.2220023875267665e-01],
    [1.3705104903035175e+00,	3.2215153920668987e-01,	9.2220023875267665e-01],
    [1.4314220676503404e+00,	3.3646938539365379e-01,	9.2220023875267665e-01],
    [1.4923336449971631e+00,	3.5078723158061781e-01,	9.2220023875267665e-01],
    [1.5532452223439863e+00,	3.6510507776758172e-01,	9.2220023875267665e-01],
    [1.6141567996908095e+00,	3.7942292395454580e-01,	9.2220023875267665e-01],
    [1.6750683770376324e+00,	3.9374077014150971e-01,	9.2220023875267665e-01],
    [1.7359799543844554e+00,	4.0805861632847379e-01,	9.2220023875267665e-01],
    [1.7968915317312784e+00,	4.2237646251543781e-01,	9.2220023875267665e-01],
    [1.8578031090781013e+00,	4.3669430870240167e-01,	9.2220023875267665e-01],
    [1.9187146864249243e+00,	4.5101215488936575e-01,	9.2220023875267665e-01],
    [1.9491704750983356e+00,	4.5817107798284773e-01,	9.2220023875267665e-01],
    [9.4787716659547450e-01,	3.2240316574116806e-01,	8.9931795603287568e-01],
    [9.7749832805158310e-01,	3.3247826467057956e-01,	8.9931795603287568e-01],
    [1.0367406509638002e+00,	3.5262846252940266e-01,	8.9931795603287568e-01],
    [1.0959829738760174e+00,	3.7277866038822549e-01,	8.9931795603287568e-01],
    [1.1552252967882344e+00,	3.9292885824704865e-01,	8.9931795603287568e-01],
    [1.2144676197004518e+00,	4.1307905610587164e-01,	8.9931795603287568e-01],
    [1.2737099426126690e+00,	4.3322925396469464e-01,	8.9931795603287568e-01],
    [1.3329522655248860e+00,	4.5337945182351769e-01,	8.9931795603287568e-01],
    [1.3921945884371032e+00,	4.7352964968234057e-01,	8.9931795603287568e-01],
    [1.4514369113493204e+00,	4.9367984754116367e-01,	8.9931795603287568e-01],
    [1.5106792342615376e+00,	5.1383004539998656e-01,	8.9931795603287568e-01],
    [1.5699215571737546e+00,	5.3398024325880966e-01,	8.9931795603287568e-01],
    [1.6291638800859720e+00,	5.5413044111763265e-01,	8.9931795603287568e-01],
    [1.6884062029981892e+00,	5.7428063897645565e-01,	8.9931795603287568e-01],
    [1.7476485259104062e+00,	5.9443083683527864e-01,	8.9931795603287568e-01],
    [1.8068908488226234e+00,	6.1458103469410141e-01,	8.9931795603287568e-01],
    [1.8661331717348404e+00,	6.3473123255292474e-01,	8.9931795603287568e-01],
    [1.8957543331909490e+00,	6.4480633148233613e-01,	8.9931795603287568e-01],
    [9.1132358187545315e-01,	4.1473564037799082e-01,	8.8101212985703492e-01],
    [9.3980244380906097e-01,	4.2769612913980293e-01,	8.8101212985703492e-01],
    [9.9676016767627684e-01,	4.5361710666342753e-01,	8.8101212985703492e-01],
    [1.0537178915434926e+00,	4.7953808418705185e-01,	8.8101212985703492e-01],
    [1.1106756154107083e+00,	5.0545906171067634e-01,	8.8101212985703492e-01],
    [1.1676333392779243e+00,	5.3138003923430077e-01,	8.8101212985703492e-01],
    [1.2245910631451402e+00,	5.5730101675792509e-01,	8.8101212985703492e-01],
    [1.2815487870123561e+00,	5.8322199428154964e-01,	8.8101212985703492e-01],
    [1.3385065108795720e+00,	6.0914297180517407e-01,	8.8101212985703492e-01],
    [1.3954642347467878e+00,	6.3506394932879850e-01,	8.8101212985703492e-01],
    [1.4524219586140037e+00,	6.6098492685242283e-01,	8.8101212985703492e-01],
    [1.5093796824812193e+00,	6.8690590437604726e-01,	8.8101212985703492e-01],
    [1.5663374063484352e+00,	7.1282688189967169e-01,	8.8101212985703492e-01],
    [1.6232951302156513e+00,	7.3874785942329602e-01,	8.8101212985703492e-01],
    [1.6802528540828665e+00,	7.6466883694692056e-01,	8.8101212985703492e-01],
    [1.7372105779500824e+00,	7.9058981447054477e-01,	8.8101212985703492e-01],
    [1.7941683018172985e+00,	8.1651079199416943e-01,	8.8101212985703492e-01],
    [1.8226471637509063e+00,	8.2947128075598164e-01,	8.8101212985703492e-01],
    [8.6487970777883660e-01,	5.0455892852240114e-01,	8.6728276022515427e-01],
    [8.9190719864692536e-01,	5.2032639503872613e-01,	8.6728276022515427e-01],
    [9.4596218038310265e-01,	5.5186132807137633e-01,	8.6728276022515427e-01],
    [1.0000171621192799e+00,	5.8339626110402620e-01,	8.6728276022515427e-01],
    [1.0540721438554572e+00,	6.1493119413667630e-01,	8.6728276022515427e-01],
    [1.1081271255916345e+00,	6.4646612716932650e-01,	8.6728276022515427e-01],
    [1.1621821073278120e+00,	6.7800106020197659e-01,	8.6728276022515427e-01],
    [1.2162370890639893e+00,	7.0953599323462668e-01,	8.6728276022515427e-01],
    [1.2702920708001664e+00,	7.4107092626727666e-01,	8.6728276022515427e-01],
    [1.3243470525363437e+00,	7.7260585929992676e-01,	8.6728276022515427e-01],
    [1.3784020342725212e+00,	8.0414079233257674e-01,	8.6728276022515427e-01],
    [1.4324570160086982e+00,	8.3567572536522694e-01,	8.6728276022515427e-01],
    [1.4865119977448757e+00,	8.6721065839787692e-01,	8.6728276022515427e-01],
    [1.5405669794810530e+00,	8.9874559143052701e-01,	8.6728276022515427e-01],
    [1.5946219612172301e+00,	9.3028052446317711e-01,	8.6728276022515427e-01],
    [1.6486769429534074e+00,	9.6181545749582698e-01,	8.6728276022515427e-01],
    [1.7027319246895849e+00,	9.9335039052847740e-01,	8.6728276022515427e-01],
    [1.7297594155576732e+00,	1.0091178570448023e+00,	8.6728276022515427e-01],
    [8.0881389856404484e-01,	5.9031549692295304e-01,	8.5812984713723384e-01],
    [8.3408933289417131e-01,	6.0876285620179538e-01,	8.5812984713723384e-01],
    [8.8464020155442424e-01,	6.4565757475948016e-01,	8.5812984713723384e-01],
    [9.3519107021467685e-01,	6.8255229331716449e-01,	8.5812984713723384e-01],
    [9.8574193887492956e-01,	7.1944701187484916e-01,	8.5812984713723384e-01],
    [1.0362928075351827e+00,	7.5634173043253383e-01,	8.5812984713723384e-01],
    [1.0868436761954354e+00,	7.9323644899021817e-01,	8.5812984713723384e-01],
    [1.1373945448556881e+00,	8.3013116754790295e-01,	8.5812984713723384e-01],
    [1.1879454135159411e+00,	8.6702588610558740e-01,	8.5812984713723384e-01],
    [1.2384962821761936e+00,	9.0392060466327195e-01,	8.5812984713723384e-01],
    [1.2890471508364467e+00,	9.4081532322095651e-01,	8.5812984713723384e-01],
    [1.3395980194966992e+00,	9.7771004177864096e-01,	8.5812984713723384e-01],
    [1.3901488881569519e+00,	1.0146047603363257e+00,	8.5812984713723384e-01],
    [1.4406997568172051e+00,	1.0514994788940102e+00,	8.5812984713723384e-01],
    [1.4912506254774578e+00,	1.0883941974516949e+00,	8.5812984713723384e-01],
    [1.5418014941377103e+00,	1.1252889160093791e+00,	8.5812984713723384e-01],
    [1.5923523627979632e+00,	1.1621836345670640e+00,	8.5812984713723384e-01],
    [1.6176277971280897e+00,	1.1806309938459061e+00,	8.5812984713723384e-01],
    [7.4371843353822908e-01,	6.7049512883486595e-01,	8.5355339059327373e-01],
    [7.6695963458629868e-01,	6.9144810161095549e-01,	8.5355339059327373e-01],
    [8.1344203668243820e-01,	7.3335404716313479e-01,	8.5355339059327373e-01],
    [8.5992443877857738e-01,	7.7525999271531376e-01,	8.5355339059327373e-01],
    [9.0640684087471668e-01,	8.1716593826749295e-01,	8.5355339059327373e-01],
    [9.5288924297085620e-01,	8.5907188381967214e-01,	8.5355339059327373e-01],
    [9.9937164506699550e-01,	9.0097782937185122e-01,	8.5355339059327373e-01],
    [1.0458540471631348e+00,	9.4288377492403042e-01,	8.5355339059327373e-01],
    [1.0923364492592742e+00,	9.8478972047620950e-01,	8.5355339059327373e-01],
    [1.1388188513554132e+00,	1.0266956660283886e+00,	8.5355339059327373e-01],
    [1.1853012534515528e+00,	1.0686016115805677e+00,	8.5355339059327373e-01],
    [1.2317836555476920e+00,	1.1105075571327470e+00,	8.5355339059327373e-01],
    [1.2782660576438314e+00,	1.1524135026849260e+00,	8.5355339059327373e-01],
    [1.3247484597399708e+00,	1.1943194482371053e+00,	8.5355339059327373e-01],
    [1.3712308618361098e+00,	1.2362253937892842e+00,	8.5355339059327373e-01],
    [1.4177132639322492e+00,	1.2781313393414631e+00,	8.5355339059327373e-01],
    [1.4641956660283886e+00,	1.3200372848936426e+00,	8.5355339059327373e-01],
    [1.4874368670764582e+00,	1.3409902576697319e+00,	8.5355339059327373e-01],
    [6.7049512883486595e-01,	7.4371843353822908e-01,	8.5355339059327373e-01],
    [6.9144810161095549e-01,	7.6695963458629868e-01,	8.5355339059327373e-01],
    [7.3335404716313479e-01,	8.1344203668243820e-01,	8.5355339059327373e-01],
    [7.7525999271531376e-01,	8.5992443877857738e-01,	8.5355339059327373e-01],
    [8.1716593826749295e-01,	9.0640684087471668e-01,	8.5355339059327373e-01],
    [8.5907188381967214e-01,	9.5288924297085620e-01,	8.5355339059327373e-01],
    [9.0097782937185122e-01,	9.9937164506699550e-01,	8.5355339059327373e-01],
    [9.4288377492403042e-01,	1.0458540471631348e+00,	8.5355339059327373e-01],
    [9.8478972047620950e-01,	1.0923364492592742e+00,	8.5355339059327373e-01],
    [1.0266956660283886e+00,	1.1388188513554132e+00,	8.5355339059327373e-01],
    [1.0686016115805677e+00,	1.1853012534515528e+00,	8.5355339059327373e-01],
    [1.1105075571327470e+00,	1.2317836555476920e+00,	8.5355339059327373e-01],
    [1.1524135026849260e+00,	1.2782660576438314e+00,	8.5355339059327373e-01],
    [1.1943194482371053e+00,	1.3247484597399708e+00,	8.5355339059327373e-01],
    [1.2362253937892842e+00,	1.3712308618361098e+00,	8.5355339059327373e-01],
    [1.2781313393414631e+00,	1.4177132639322492e+00,	8.5355339059327373e-01],
    [1.3200372848936426e+00,	1.4641956660283886e+00,	8.5355339059327373e-01],
    [1.3409902576697319e+00,	1.4874368670764582e+00,	8.5355339059327373e-01],
    [5.9031549692295304e-01,	8.0881389856404484e-01,	8.5812984713723384e-01],
    [6.0876285620179538e-01,	8.3408933289417131e-01,	8.5812984713723384e-01],
    [6.4565757475948016e-01,	8.8464020155442424e-01,	8.5812984713723384e-01],
    [6.8255229331716449e-01,	9.3519107021467685e-01,	8.5812984713723384e-01],
    [7.1944701187484916e-01,	9.8574193887492956e-01,	8.5812984713723384e-01],
    [7.5634173043253383e-01,	1.0362928075351827e+00,	8.5812984713723384e-01],
    [7.9323644899021817e-01,	1.0868436761954354e+00,	8.5812984713723384e-01],
    [8.3013116754790295e-01,	1.1373945448556881e+00,	8.5812984713723384e-01],
    [8.6702588610558740e-01,	1.1879454135159411e+00,	8.5812984713723384e-01],
    [9.0392060466327195e-01,	1.2384962821761936e+00,	8.5812984713723384e-01],
    [9.4081532322095651e-01,	1.2890471508364467e+00,	8.5812984713723384e-01],
    [9.7771004177864096e-01,	1.3395980194966992e+00,	8.5812984713723384e-01],
    [1.0146047603363257e+00,	1.3901488881569519e+00,	8.5812984713723384e-01],
    [1.0514994788940102e+00,	1.4406997568172051e+00,	8.5812984713723384e-01],
    [1.0883941974516949e+00,	1.4912506254774578e+00,	8.5812984713723384e-01],
    [1.1252889160093791e+00,	1.5418014941377103e+00,	8.5812984713723384e-01],
    [1.1621836345670640e+00,	1.5923523627979632e+00,	8.5812984713723384e-01],
    [1.1806309938459061e+00,	1.6176277971280897e+00,	8.5812984713723384e-01],
    [5.0455892852240114e-01,	8.6487970777883660e-01,	8.6728276022515427e-01],
    [5.2032639503872613e-01,	8.9190719864692536e-01,	8.6728276022515427e-01],
    [5.5186132807137633e-01,	9.4596218038310265e-01,	8.6728276022515427e-01],
    [5.8339626110402620e-01,	1.0000171621192799e+00,	8.6728276022515427e-01],
    [6.1493119413667630e-01,	1.0540721438554572e+00,	8.6728276022515427e-01],
    [6.4646612716932650e-01,	1.1081271255916345e+00,	8.6728276022515427e-01],
    [6.7800106020197659e-01,	1.1621821073278120e+00,	8.6728276022515427e-01],
    [7.0953599323462668e-01,	1.2162370890639893e+00,	8.6728276022515427e-01],
    [7.4107092626727666e-01,	1.2702920708001664e+00,	8.6728276022515427e-01],
    [7.7260585929992676e-01,	1.3243470525363437e+00,	8.6728276022515427e-01],
    [8.0414079233257674e-01,	1.3784020342725212e+00,	8.6728276022515427e-01],
    [8.3567572536522694e-01,	1.4324570160086982e+00,	8.6728276022515427e-01],
    [8.6721065839787692e-01,	1.4865119977448757e+00,	8.6728276022515427e-01],
    [8.9874559143052701e-01,	1.5405669794810530e+00,	8.6728276022515427e-01],
    [9.3028052446317711e-01,	1.5946219612172301e+00,	8.6728276022515427e-01],
    [9.6181545749582698e-01,	1.6486769429534074e+00,	8.6728276022515427e-01],
    [9.9335039052847740e-01,	1.7027319246895849e+00,	8.6728276022515427e-01],
    [1.0091178570448023e+00,	1.7297594155576732e+00,	8.6728276022515427e-01],
    [4.1473564037799082e-01,	9.1132358187545315e-01,	8.8101212985703492e-01],
    [4.2769612913980293e-01,	9.3980244380906097e-01,	8.8101212985703492e-01],
    [4.5361710666342753e-01,	9.9676016767627684e-01,	8.8101212985703492e-01],
    [4.7953808418705185e-01,	1.0537178915434926e+00,	8.8101212985703492e-01],
    [5.0545906171067634e-01,	1.1106756154107083e+00,	8.8101212985703492e-01],
    [5.3138003923430077e-01,	1.1676333392779243e+00,	8.8101212985703492e-01],
    [5.5730101675792509e-01,	1.2245910631451402e+00,	8.8101212985703492e-01],
    [5.8322199428154964e-01,	1.2815487870123561e+00,	8.8101212985703492e-01],
    [6.0914297180517407e-01,	1.3385065108795720e+00,	8.8101212985703492e-01],
    [6.3506394932879850e-01,	1.3954642347467878e+00,	8.8101212985703492e-01],
    [6.6098492685242283e-01,	1.4524219586140037e+00,	8.8101212985703492e-01],
    [6.8690590437604726e-01,	1.5093796824812193e+00,	8.8101212985703492e-01],
    [7.1282688189967169e-01,	1.5663374063484352e+00,	8.8101212985703492e-01],
    [7.3874785942329602e-01,	1.6232951302156513e+00,	8.8101212985703492e-01],
    [7.6466883694692056e-01,	1.6802528540828665e+00,	8.8101212985703492e-01],
    [7.9058981447054477e-01,	1.7372105779500824e+00,	8.8101212985703492e-01],
    [8.1651079199416943e-01,	1.7941683018172985e+00,	8.8101212985703492e-01],
    [8.2947128075598164e-01,	1.8226471637509063e+00,	8.8101212985703492e-01],
    [3.2240316574116806e-01,	9.4787716659547450e-01,	8.9931795603287568e-01],
    [3.3247826467057956e-01,	9.7749832805158310e-01,	8.9931795603287568e-01],
    [3.5262846252940266e-01,	1.0367406509638002e+00,	8.9931795603287568e-01],
    [3.7277866038822549e-01,	1.0959829738760174e+00,	8.9931795603287568e-01],
    [3.9292885824704865e-01,	1.1552252967882344e+00,	8.9931795603287568e-01],
    [4.1307905610587164e-01,	1.2144676197004518e+00,	8.9931795603287568e-01],
    [4.3322925396469464e-01,	1.2737099426126690e+00,	8.9931795603287568e-01],
    [4.5337945182351769e-01,	1.3329522655248860e+00,	8.9931795603287568e-01],
    [4.7352964968234057e-01,	1.3921945884371032e+00,	8.9931795603287568e-01],
    [4.9367984754116367e-01,	1.4514369113493204e+00,	8.9931795603287568e-01],
    [5.1383004539998656e-01,	1.5106792342615376e+00,	8.9931795603287568e-01],
    [5.3398024325880966e-01,	1.5699215571737546e+00,	8.9931795603287568e-01],
    [5.5413044111763265e-01,	1.6291638800859720e+00,	8.9931795603287568e-01],
    [5.7428063897645565e-01,	1.6884062029981892e+00,	8.9931795603287568e-01],
    [5.9443083683527864e-01,	1.7476485259104062e+00,	8.9931795603287568e-01],
    [6.1458103469410141e-01,	1.8068908488226234e+00,	8.9931795603287568e-01],
    [6.3473123255292474e-01,	1.8661331717348404e+00,	8.9931795603287568e-01],
    [6.4480633148233613e-01,	1.8957543331909490e+00,	8.9931795603287568e-01],
    [2.2908553899142386e-01,	9.7458523754916782e-01,	9.2220023875267665e-01],
    [2.3624446208490579e-01,	1.0050410262225795e+00,	9.2220023875267665e-01],
    [2.5056230827186987e-01,	1.0659526035694025e+00,	9.2220023875267665e-01],
    [2.6488015445883378e-01,	1.1268641809162252e+00,	9.2220023875267665e-01],
    [2.7919800064579792e-01,	1.1877757582630484e+00,	9.2220023875267665e-01],
    [2.9351584683276188e-01,	1.2486873356098716e+00,	9.2220023875267665e-01],
    [3.0783369301972585e-01,	1.3095989129566943e+00,	9.2220023875267665e-01],
    [3.2215153920668987e-01,	1.3705104903035175e+00,	9.2220023875267665e-01],
    [3.3646938539365379e-01,	1.4314220676503404e+00,	9.2220023875267665e-01],
    [3.5078723158061781e-01,	1.4923336449971631e+00,	9.2220023875267665e-01],
    [3.6510507776758172e-01,	1.5532452223439863e+00,	9.2220023875267665e-01],
    [3.7942292395454580e-01,	1.6141567996908095e+00,	9.2220023875267665e-01],
    [3.9374077014150971e-01,	1.6750683770376324e+00,	9.2220023875267665e-01],
    [4.0805861632847379e-01,	1.7359799543844554e+00,	9.2220023875267665e-01],
    [4.2237646251543781e-01,	1.7968915317312784e+00,	9.2220023875267665e-01],
    [4.3669430870240167e-01,	1.8578031090781013e+00,	9.2220023875267665e-01],
    [4.5101215488936575e-01,	1.9187146864249243e+00,	9.2220023875267665e-01],
    [4.5817107798284773e-01,	1.9491704750983356e+00,	9.2220023875267665e-01],
    [1.3620308027477940e-01,	9.9177336266928362e-01,	9.4965897801643795e-01],
    [1.4045942653336624e-01,	1.0227662802526987e+00,	9.4965897801643795e-01],
    [1.4897211905054000e-01,	1.0847521154195288e+00,	9.4965897801643795e-01],
    [1.5748481156771363e-01,	1.1467379505863591e+00,	9.4965897801643795e-01],
    [1.6599750408488742e-01,	1.2087237857531892e+00,	9.4965897801643795e-01],
    [1.7451019660206113e-01,	1.2707096209200197e+00,	9.4965897801643795e-01],
    [1.8302288911923478e-01,	1.3326954560868498e+00,	9.4965897801643795e-01],
    [1.9153558163640858e-01,	1.3946812912536801e+00,	9.4965897801643795e-01],
    [2.0004827415358226e-01,	1.4566671264205100e+00,	9.4965897801643795e-01],
    [2.0856096667075597e-01,	1.5186529615873405e+00,	9.4965897801643795e-01],
    [2.1707365918792965e-01,	1.5806387967541706e+00,	9.4965897801643795e-01],
    [2.2558635170510338e-01,	1.6426246319210012e+00,	9.4965897801643795e-01],
    [2.3409904422227709e-01,	1.7046104670878310e+00,	9.4965897801643795e-01],
    [2.4261173673945083e-01,	1.7665963022546614e+00,	9.4965897801643795e-01],
    [2.5112442925662454e-01,	1.8285821374214917e+00,	9.4965897801643795e-01],
    [2.5963712177379816e-01,	1.8905679725883218e+00,	9.4965897801643795e-01],
    [2.6814981429097190e-01,	1.9525538077551519e+00,	9.4965897801643795e-01],
    [2.7240616054955880e-01,	1.9835467253385672e+00,	9.4965897801643795e-01],
    [4.5018270457898503e-02,	1.0000000000000000e+00,	9.8169417382415924e-01],
    [4.6425091409707825e-02,	1.0312500000000002e+00,	9.8169417382415924e-01],
    [4.9238733313326496e-02,	1.0937500000000000e+00,	9.8169417382415924e-01],
    [5.2052375216945133e-02,	1.1562500000000000e+00,	9.8169417382415924e-01],
    [5.4866017120563798e-02,	1.2187500000000000e+00,	9.8169417382415924e-01],
    [5.7679659024182456e-02,	1.2812500000000000e+00,	9.8169417382415924e-01],
    [6.0493300927801100e-02,	1.3437500000000000e+00,	9.8169417382415924e-01],
    [6.3306942831419771e-02,	1.4062500000000000e+00,	9.8169417382415924e-01],
    [6.6120584735038429e-02,	1.4687500000000000e+00,	9.8169417382415924e-01],
    [6.8934226638657073e-02,	1.5312499999999998e+00,	9.8169417382415924e-01],
    [7.1747868542275731e-02,	1.5937499999999998e+00,	9.8169417382415924e-01],
    [7.4561510445894388e-02,	1.6562499999999998e+00,	9.8169417382415924e-01],
    [7.7375152349513046e-02,	1.7187500000000000e+00,	9.8169417382415924e-01],
    [8.0188794253131704e-02,	1.7812500000000000e+00,	9.8169417382415924e-01],
    [8.3002436156750362e-02,	1.8437500000000000e+00,	9.8169417382415924e-01],
    [8.5816078060368992e-02,	1.9062500000000000e+00,	9.8169417382415924e-01],
    [8.8629719963987677e-02,	1.9687500000000000e+00,	9.8169417382415924e-01],
    [9.0036540915797006e-02,	2.0000000000000000e+00,	9.8169417382415924e-01],
    [0.0000000000000000e+00,	1.0000000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.0312500000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.0937500000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.1562500000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.2187500000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.2812500000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.3437500000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.4062500000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.4687500000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.5312500000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.5937500000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.6562500000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.7187500000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.7812500000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.8437500000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.9062500000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.9687500000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	2.0000000000000000e+00,	1.0000000000000000e+00]])

# 重複ありの総コントロールポイント数
allpointnumber_overlapping = 0
for i in range(patch_info.shape[0]):
    allpointnumber_overlapping += patch_info[i][0] * patch_info[i][1]

globalpoint = np.zeros((allpointnumber_overlapping))
globalpoint_x = np.zeros((allpointnumber_overlapping))
globalpoint_y = np.zeros((allpointnumber_overlapping))
globalpoint_w = np.zeros((allpointnumber_overlapping))
globalpoint_bool = np.zeros((allpointnumber_overlapping), dtype = bool)

localpoint = np.zeros((patch_info.shape[0], xi_max * eta_max))
localpoint_bool = np.zeros((patch_info.shape[0], xi_max * eta_max), dtype=bool)
for i in range(patch_info.shape[0]):
    localpoint_bool[i,:patch_info[i][0]*patch_info[i][1]] = True

xi_and_eta_max = xi_max
if xi_max < eta_max:
    xi_and_eta_max = eta_max
A = np.zeros((patch_info.shape[0], 2, 2, xi_and_eta_max))
A_bool = np.zeros((patch_info.shape[0], 2, 2, xi_and_eta_max), dtype=bool)

# connect patch
xi = 0
eta = 1
positive = 0
negative = 1

patch_number = 0
globalpoint, globalpoint_bool, globalpoint_x, globalpoint_y, globalpoint_w, localpoint, localpoint_bool, A, A_bool = \
    mif.connect_patch_arg_0boundary(patch_number, patch_info, patch, patch_bool, globalpoint, globalpoint_bool, globalpoint_x, globalpoint_y, globalpoint_w, localpoint, localpoint_bool, A, A_bool)

# 座標，パッチコネクティビティー，境界の辺をtxt出力
# [patch_number, xi_or_eta, 0_or_1(int)] (auto marge)
boundary_array_0 = np.array([[0, eta, 0],
                             [0, xi, 1]])

boundary_array_1 = np.array([[0,  xi, 1],
                             [0, eta, 1]])

boundary_number = 0
mif.write_date_header(filename)
mif.write_date_localpoint(filename, patch_info, localpoint, localpoint_bool)
mif.write_date_globalpoint(filename, globalpoint, globalpoint_bool, globalpoint_x, globalpoint_y, globalpoint_w)
boundary_number = mif.write_boundary(filename, A, A_bool, boundary_array_0, boundary_number)
boundary_number = mif.write_boundary(filename, A, A_bool, boundary_array_1, boundary_number)


# 描写
color = np.array(["r", "g", "b", "c", "m", "y", "k"])
fig = plt.figure()
ax1 = fig.add_subplot(1, 1, 1)

A = np.zeros((globalpoint[globalpoint_bool].shape[0],3))
for i in range(globalpoint[globalpoint_bool].shape[0]):
    A[i][0] = globalpoint[globalpoint_bool][i]
    A[i][1] = globalpoint_x[globalpoint_bool][i]
    A[i][2] = globalpoint_y[globalpoint_bool][i]
ax1.plot(A[:,1], A[:,2], c=color[0], marker="", linewidth=0.7)
for i in range(globalpoint[globalpoint_bool].shape[0]):
    ax1.text(A[i,1], A[i,2], str(int(A[i,0])), c=color[3], fontsize=6)


ax1.set_aspect('equal', adjustable='box')
ax1.set_axisbelow(True)
fig.set_figheight(9)
fig.set_figwidth(12)
ax1.grid()
ax1.set_xlim(-1, 3)
ax1.set_ylim(-1, 3)
plt.show()