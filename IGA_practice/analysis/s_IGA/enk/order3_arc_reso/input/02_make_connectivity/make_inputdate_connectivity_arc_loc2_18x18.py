import numpy as np
import matplotlib.pyplot as plt
import math
import make_inputdate_function as mif

# difine filename
filename = "connectivity_arc_loc2_18x18"

# patch info (ξ方向のコントロールポイント個数, η方向のコントロールポイント個数)
patch_info = np.array([18, 18])

# patch info 1行2列の時の例外処理
if np.array(patch_info.shape).shape[0] == 1:
    patch_info = np.array([[patch_info[0], patch_info[1]]])

xi_max = 0
eta_max = 0
for i in range(patch_info.shape[0]):
    if xi_max < patch_info[i][0]:
        xi_max = patch_info[i][0]
    if eta_max < patch_info[i][1]:
        eta_max = patch_info[i][1]

# パッチのコントロールポイント 座標，重み
patch = np.zeros((patch_info.shape[0], xi_max * eta_max, 3))
patch_bool = np.zeros((patch_info.shape[0], xi_max * eta_max, 3), dtype=bool)
for i in range(patch_info.shape[0]):
    patch_bool[i,:patch_info[i][0]*patch_info[i][1],:] = True

# 各パッチ入力
num = 0
patch[num,:patch_info[num][0]*patch_info[num][1],:] = np.array(
   [[1.0000000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.1250000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.3750000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.6250000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.8750000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [2.1250000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [2.3750000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [2.6250000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [2.8750000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [3.1250000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [3.3750000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [3.6250000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [3.8750000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [4.1250000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [4.3750000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [4.6250000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [4.8750000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [5.0000000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.0000000000000000e+00,	4.5018270457898503e-02,	9.8169417382415924e-01],
    [1.1250000000000000e+00,	5.0645554265135818e-02,	9.8169417382415924e-01],
    [1.3750000000000000e+00,	6.1900121879610422e-02,	9.8169417382415924e-01],
    [1.6250000000000000e+00,	7.3154689494085073e-02,	9.8169417382415924e-01],
    [1.8750000000000000e+00,	8.4409257108559704e-02,	9.8169417382415924e-01],
    [2.1250000000000000e+00,	9.5663824723034321e-02,	9.8169417382415924e-01],
    [2.3750000000000000e+00,	1.0691839233750894e-01,	9.8169417382415924e-01],
    [2.6250000000000000e+00,	1.1817295995198356e-01,	9.8169417382415924e-01],
    [2.8750000000000000e+00,	1.2942752756645820e-01,	9.8169417382415924e-01],
    [3.1250000000000000e+00,	1.4068209518093280e-01,	9.8169417382415924e-01],
    [3.3750000000000000e+00,	1.5193666279540743e-01,	9.8169417382415924e-01],
    [3.6250000000000000e+00,	1.6319123040988209e-01,	9.8169417382415924e-01],
    [3.8750000000000000e+00,	1.7444579802435672e-01,	9.8169417382415924e-01],
    [4.1250000000000009e+00,	1.8570036563883130e-01,	9.8169417382415924e-01],
    [4.3750000000000000e+00,	1.9695493325330599e-01,	9.8169417382415924e-01],
    [4.6250000000000000e+00,	2.0820950086778053e-01,	9.8169417382415924e-01],
    [4.8750000000000000e+00,	2.1946406848225519e-01,	9.8169417382415924e-01],
    [5.0000000000000000e+00,	2.2509135228949251e-01,	9.8169417382415924e-01],
    [9.9177336266928362e-01,	1.3620308027477940e-01,	9.4965897801643795e-01],
    [1.1157450330029439e+00,	1.5322846530912682e-01,	9.4965897801643795e-01],
    [1.3636883736702647e+00,	1.8727923537782165e-01,	9.4965897801643795e-01],
    [1.6116317143375858e+00,	2.2133000544651651e-01,	9.4965897801643795e-01],
    [1.8595750550049066e+00,	2.5538077551521143e-01,	9.4965897801643795e-01],
    [2.1075183956722272e+00,	2.8943154558390621e-01,	9.4965897801643795e-01],
    [2.3554617363395480e+00,	3.2348231565260105e-01,	9.4965897801643795e-01],
    [2.6034050770068693e+00,	3.5753308572129594e-01,	9.4965897801643795e-01],
    [2.8513484176741906e+00,	3.9158385578999078e-01,	9.4965897801643795e-01],
    [3.0992917583415105e+00,	4.2563462585868561e-01,	9.4965897801643795e-01],
    [3.3472350990088313e+00,	4.5968539592738050e-01,	9.4965897801643795e-01],
    [3.5951784396761526e+00,	4.9373616599607539e-01,	9.4965897801643795e-01],
    [3.8431217803434738e+00,	5.2778693606477034e-01,	9.4965897801643795e-01],
    [4.0910651210107947e+00,	5.6183770613346495e-01,	9.4965897801643795e-01],
    [4.3390084616781150e+00,	5.9588847620216001e-01,	9.4965897801643795e-01],
    [4.5869518023454363e+00,	6.2993924627085451e-01,	9.4965897801643795e-01],
    [4.8348951430127567e+00,	6.6399001633954968e-01,	9.4965897801643795e-01],
    [4.9588668133464173e+00,	6.8101540137389693e-01,	9.4965897801643795e-01],
    [9.7458523754916782e-01,	2.2908553899142386e-01,	9.2220023875267665e-01],
    [1.0964083922428141e+00,	2.5772123136535185e-01,	9.2220023875267665e-01],
    [1.3400547016301056e+00,	3.1499261611320778e-01,	9.2220023875267665e-01],
    [1.5837010110173977e+00,	3.7226400086106376e-01,	9.2220023875267665e-01],
    [1.8273473204046897e+00,	4.2953538560891980e-01,	9.2220023875267665e-01],
    [2.0709936297919818e+00,	4.8680677035677566e-01,	9.2220023875267665e-01],
    [2.3146399391792736e+00,	5.4407815510463164e-01,	9.2220023875267665e-01],
    [2.5582862485665658e+00,	6.0134953985248762e-01,	9.2220023875267665e-01],
    [2.8019325579538572e+00,	6.5862092460034372e-01,	9.2220023875267665e-01],
    [3.0455788673411495e+00,	7.1589230934819947e-01,	9.2220023875267665e-01],
    [3.2892251767284422e+00,	7.7316369409605556e-01,	9.2220023875267665e-01],
    [3.5328714861157340e+00,	8.3043507884391166e-01,	9.2220023875267665e-01],
    [3.7765177955030258e+00,	8.8770646359176764e-01,	9.2220023875267665e-01],
    [4.0201641048903181e+00,	9.4497784833962317e-01,	9.2220023875267665e-01],
    [4.2638104142776099e+00,	1.0022492330874795e+00,	9.2220023875267665e-01],
    [4.5074567236649008e+00,	1.0595206178353351e+00,	9.2220023875267665e-01],
    [4.7511030330521935e+00,	1.1167920025831917e+00,	9.2220023875267665e-01],
    [4.8729261877458399e+00,	1.1454276949571192e+00,	9.2220023875267665e-01],
    [9.4787716659547450e-01,	3.2240316574116806e-01,	8.9931795603287568e-01],
    [1.0663618124199090e+00,	3.6270356145881411e-01,	8.9931795603287568e-01],
    [1.3033311040687772e+00,	4.4330435289410614e-01,	8.9931795603287568e-01],
    [1.5403003957176462e+00,	5.2390514432939816e-01,	8.9931795603287568e-01],
    [1.7772696873665148e+00,	6.0450593576469025e-01,	8.9931795603287568e-01],
    [2.0142389790153832e+00,	6.8510672719998222e-01,	8.9931795603287568e-01],
    [2.2512082706642516e+00,	7.6570751863527420e-01,	8.9931795603287568e-01],
    [2.4881775623131208e+00,	8.4630831007056617e-01,	8.9931795603287568e-01],
    [2.7251468539619892e+00,	9.2690910150585826e-01,	8.9931795603287568e-01],
    [2.9621161456108576e+00,	1.0075098929411501e+00,	8.9931795603287568e-01],
    [3.1990854372597268e+00,	1.0881106843764423e+00,	8.9931795603287568e-01],
    [3.4360547289085956e+00,	1.1687114758117345e+00,	8.9931795603287568e-01],
    [3.6730240205574636e+00,	1.2493122672470265e+00,	8.9931795603287568e-01],
    [3.9099933122063324e+00,	1.3299130586823182e+00,	8.9931795603287568e-01],
    [4.1469626038552008e+00,	1.4105138501176107e+00,	8.9931795603287568e-01],
    [4.3839318955040696e+00,	1.4911146415529020e+00,	8.9931795603287568e-01],
    [4.6209011871529375e+00,	1.5717154329881946e+00,	8.9931795603287568e-01],
    [4.7393858329773728e+00,	1.6120158287058404e+00,	8.9931795603287568e-01],
    [9.1132358187545315e-01,	4.1473564037799082e-01,	8.8101212985703492e-01],
    [1.0252390296098850e+00,	4.6657759542523969e-01,	8.8101212985703492e-01],
    [1.2530699250787480e+00,	5.7026150551973742e-01,	8.8101212985703492e-01],
    [1.4809008205476113e+00,	6.7394541561423493e-01,	8.8101212985703492e-01],
    [1.7087317160164746e+00,	7.7762932570873300e-01,	8.8101212985703492e-01],
    [1.9365626114853380e+00,	8.8131323580323040e-01,	8.8101212985703492e-01],
    [2.1643935069542013e+00,	9.8499714589772802e-01,	8.8101212985703492e-01],
    [2.3922244024230648e+00,	1.0886810559922258e+00,	8.8101212985703492e-01],
    [2.6200552978919278e+00,	1.1923649660867235e+00,	8.8101212985703492e-01],
    [2.8478861933607909e+00,	1.2960488761812212e+00,	8.8101212985703492e-01],
    [3.0757170888296543e+00,	1.3997327862757190e+00,	8.8101212985703492e-01],
    [3.3035479842985183e+00,	1.5034166963702167e+00,	8.8101212985703492e-01],
    [3.5313788797673817e+00,	1.6071006064647149e+00,	8.8101212985703492e-01],
    [3.7592097752362439e+00,	1.7107845165592117e+00,	8.8101212985703492e-01],
    [3.9870406707051074e+00,	1.8144684266537101e+00,	8.8101212985703492e-01],
    [4.2148715661739704e+00,	1.9181523367482074e+00,	8.8101212985703492e-01],
    [4.4427024616428330e+00,	2.0218362468427054e+00,	8.8101212985703492e-01],
    [4.5566179093772670e+00,	2.0736782018899538e+00,	8.8101212985703492e-01],
    [8.6487970777883660e-01,	5.0455892852240114e-01,	8.6728276022515427e-01],
    [9.7298967125119151e-01,	5.6762879458770132e-01,	8.6728276022515427e-01],
    [1.1892095981959003e+00,	6.9376852671830169e-01,	8.6728276022515427e-01],
    [1.4054295251406097e+00,	8.1990825884890173e-01,	8.6728276022515427e-01],
    [1.6216494520853189e+00,	9.4604799097950232e-01,	8.6728276022515427e-01],
    [1.8378693790300280e+00,	1.0721877231101025e+00,	8.6728276022515427e-01],
    [2.0540893059747374e+00,	1.1983274552407028e+00,	8.6728276022515427e-01],
    [2.2703092329194470e+00,	1.3244671873713030e+00,	8.6728276022515427e-01],
    [2.4865291598641557e+00,	1.4506069195019033e+00,	8.6728276022515427e-01],
    [2.7027490868088648e+00,	1.5767466516325035e+00,	8.6728276022515427e-01],
    [2.9189690137535740e+00,	1.7028863837631039e+00,	8.6728276022515427e-01],
    [3.1351889406982840e+00,	1.8290261158937042e+00,	8.6728276022515427e-01],
    [3.3514088676429927e+00,	1.9551658480243048e+00,	8.6728276022515427e-01],
    [3.5676287945877014e+00,	2.0813055801549045e+00,	8.6728276022515427e-01],
    [3.7838487215324106e+00,	2.2074453122855053e+00,	8.6728276022515427e-01],
    [4.0000686484771197e+00,	2.3335850444161048e+00,	8.6728276022515427e-01],
    [4.2162885754218289e+00,	2.4597247765467052e+00,	8.6728276022515427e-01],
    [4.3243985388941839e+00,	2.5227946426120056e+00,	8.6728276022515427e-01],
    [8.0881389856404484e-01,	5.9031549692295304e-01,	8.5812984713723384e-01],
    [9.0991563588455060e-01,	6.6410493403832238e-01,	8.5812984713723384e-01],
    [1.1121191105255617e+00,	8.1168380826906050e-01,	8.5812984713723384e-01],
    [1.3143225851665732e+00,	9.5926268249979874e-01,	8.5812984713723384e-01],
    [1.5165260598075843e+00,	1.1068415567305374e+00,	8.5812984713723384e-01],
    [1.7187295344485951e+00,	1.2544204309612754e+00,	8.5812984713723384e-01],
    [1.9209330090896066e+00,	1.4019993051920137e+00,	8.5812984713723384e-01],
    [2.1231364837306175e+00,	1.5495781794227521e+00,	8.5812984713723384e-01],
    [2.3253399583716292e+00,	1.6971570536534903e+00,	8.5812984713723384e-01],
    [2.5275434330126401e+00,	1.8447359278842284e+00,	8.5812984713723384e-01],
    [2.7297469076536518e+00,	1.9923148021149668e+00,	8.5812984713723384e-01],
    [2.9319503822946631e+00,	2.1398936763457050e+00,	8.5812984713723384e-01],
    [3.1341538569356739e+00,	2.2874725505764437e+00,	8.5812984713723384e-01],
    [3.3363573315766852e+00,	2.4350514248071815e+00,	8.5812984713723384e-01],
    [3.5385608062176970e+00,	2.5826302990379206e+00,	8.5812984713723384e-01],
    [3.7407642808587074e+00,	2.7302091732686580e+00,	8.5812984713723384e-01],
    [3.9429677554997182e+00,	2.8777880474993967e+00,	8.5812984713723384e-01],
    [4.0440694928202241e+00,	2.9515774846147655e+00,	8.5812984713723384e-01],
    [7.4371843353822908e-01,	6.7049512883486595e-01,	8.5355339059327373e-01],
    [8.3668323773050790e-01,	7.5430701993922433e-01,	8.5355339059327373e-01],
    [1.0226128461150650e+00,	9.2193080214794076e-01,	8.5355339059327373e-01],
    [1.2085424544996226e+00,	1.0895545843566572e+00,	8.5355339059327373e-01],
    [1.3944720628841796e+00,	1.2571783665653740e+00,	8.5355339059327373e-01],
    [1.5804016712687368e+00,	1.4248021487740903e+00,	8.5355339059327373e-01],
    [1.7663312796532942e+00,	1.5924259309828068e+00,	8.5355339059327373e-01],
    [1.9522608880378514e+00,	1.7600497131915231e+00,	8.5355339059327373e-01],
    [2.1381904964224088e+00,	1.9276734954002399e+00,	8.5355339059327373e-01],
    [2.3241201048069660e+00,	2.0952972776089562e+00,	8.5355339059327373e-01],
    [2.5100497131915236e+00,	2.2629210598176730e+00,	8.5355339059327373e-01],
    [2.6959793215760812e+00,	2.4305448420263898e+00,	8.5355339059327373e-01],
    [2.8819089299606384e+00,	2.5981686242351061e+00,	8.5355339059327373e-01],
    [3.0678385383451947e+00,	2.7657924064438220e+00,	8.5355339059327373e-01],
    [3.2537681467297528e+00,	2.9334161886525392e+00,	8.5355339059327373e-01],
    [3.4396977551143095e+00,	3.1010399708612550e+00,	8.5355339059327373e-01],
    [3.6256273634988667e+00,	3.2686637530699718e+00,	8.5355339059327373e-01],
    [3.7185921676911455e+00,	3.3524756441743300e+00,	8.5355339059327373e-01],
    [6.7049512883486595e-01,	7.4371843353822908e-01,	8.5355339059327373e-01],
    [7.5430701993922433e-01,	8.3668323773050790e-01,	8.5355339059327373e-01],
    [9.2193080214794076e-01,	1.0226128461150650e+00,	8.5355339059327373e-01],
    [1.0895545843566572e+00,	1.2085424544996226e+00,	8.5355339059327373e-01],
    [1.2571783665653740e+00,	1.3944720628841796e+00,	8.5355339059327373e-01],
    [1.4248021487740903e+00,	1.5804016712687368e+00,	8.5355339059327373e-01],
    [1.5924259309828068e+00,	1.7663312796532942e+00,	8.5355339059327373e-01],
    [1.7600497131915231e+00,	1.9522608880378514e+00,	8.5355339059327373e-01],
    [1.9276734954002399e+00,	2.1381904964224088e+00,	8.5355339059327373e-01],
    [2.0952972776089562e+00,	2.3241201048069660e+00,	8.5355339059327373e-01],
    [2.2629210598176730e+00,	2.5100497131915236e+00,	8.5355339059327373e-01],
    [2.4305448420263898e+00,	2.6959793215760812e+00,	8.5355339059327373e-01],
    [2.5981686242351061e+00,	2.8819089299606384e+00,	8.5355339059327373e-01],
    [2.7657924064438220e+00,	3.0678385383451947e+00,	8.5355339059327373e-01],
    [2.9334161886525392e+00,	3.2537681467297528e+00,	8.5355339059327373e-01],
    [3.1010399708612550e+00,	3.4396977551143095e+00,	8.5355339059327373e-01],
    [3.2686637530699718e+00,	3.6256273634988667e+00,	8.5355339059327373e-01],
    [3.3524756441743300e+00,	3.7185921676911455e+00,	8.5355339059327373e-01],
    [5.9031549692295304e-01,	8.0881389856404484e-01,	8.5812984713723384e-01],
    [6.6410493403832238e-01,	9.0991563588455060e-01,	8.5812984713723384e-01],
    [8.1168380826906050e-01,	1.1121191105255617e+00,	8.5812984713723384e-01],
    [9.5926268249979874e-01,	1.3143225851665732e+00,	8.5812984713723384e-01],
    [1.1068415567305374e+00,	1.5165260598075843e+00,	8.5812984713723384e-01],
    [1.2544204309612754e+00,	1.7187295344485951e+00,	8.5812984713723384e-01],
    [1.4019993051920137e+00,	1.9209330090896066e+00,	8.5812984713723384e-01],
    [1.5495781794227521e+00,	2.1231364837306175e+00,	8.5812984713723384e-01],
    [1.6971570536534903e+00,	2.3253399583716292e+00,	8.5812984713723384e-01],
    [1.8447359278842284e+00,	2.5275434330126401e+00,	8.5812984713723384e-01],
    [1.9923148021149668e+00,	2.7297469076536518e+00,	8.5812984713723384e-01],
    [2.1398936763457050e+00,	2.9319503822946631e+00,	8.5812984713723384e-01],
    [2.2874725505764437e+00,	3.1341538569356739e+00,	8.5812984713723384e-01],
    [2.4350514248071815e+00,	3.3363573315766852e+00,	8.5812984713723384e-01],
    [2.5826302990379206e+00,	3.5385608062176970e+00,	8.5812984713723384e-01],
    [2.7302091732686580e+00,	3.7407642808587074e+00,	8.5812984713723384e-01],
    [2.8777880474993967e+00,	3.9429677554997182e+00,	8.5812984713723384e-01],
    [2.9515774846147655e+00,	4.0440694928202241e+00,	8.5812984713723384e-01],
    [5.0455892852240114e-01,	8.6487970777883660e-01,	8.6728276022515427e-01],
    [5.6762879458770132e-01,	9.7298967125119151e-01,	8.6728276022515427e-01],
    [6.9376852671830169e-01,	1.1892095981959003e+00,	8.6728276022515427e-01],
    [8.1990825884890173e-01,	1.4054295251406097e+00,	8.6728276022515427e-01],
    [9.4604799097950232e-01,	1.6216494520853189e+00,	8.6728276022515427e-01],
    [1.0721877231101025e+00,	1.8378693790300280e+00,	8.6728276022515427e-01],
    [1.1983274552407028e+00,	2.0540893059747374e+00,	8.6728276022515427e-01],
    [1.3244671873713030e+00,	2.2703092329194470e+00,	8.6728276022515427e-01],
    [1.4506069195019033e+00,	2.4865291598641557e+00,	8.6728276022515427e-01],
    [1.5767466516325035e+00,	2.7027490868088648e+00,	8.6728276022515427e-01],
    [1.7028863837631039e+00,	2.9189690137535740e+00,	8.6728276022515427e-01],
    [1.8290261158937042e+00,	3.1351889406982840e+00,	8.6728276022515427e-01],
    [1.9551658480243048e+00,	3.3514088676429927e+00,	8.6728276022515427e-01],
    [2.0813055801549045e+00,	3.5676287945877014e+00,	8.6728276022515427e-01],
    [2.2074453122855053e+00,	3.7838487215324106e+00,	8.6728276022515427e-01],
    [2.3335850444161048e+00,	4.0000686484771197e+00,	8.6728276022515427e-01],
    [2.4597247765467052e+00,	4.2162885754218289e+00,	8.6728276022515427e-01],
    [2.5227946426120056e+00,	4.3243985388941839e+00,	8.6728276022515427e-01],
    [4.1473564037799082e-01,	9.1132358187545315e-01,	8.8101212985703492e-01],
    [4.6657759542523969e-01,	1.0252390296098850e+00,	8.8101212985703492e-01],
    [5.7026150551973742e-01,	1.2530699250787480e+00,	8.8101212985703492e-01],
    [6.7394541561423493e-01,	1.4809008205476113e+00,	8.8101212985703492e-01],
    [7.7762932570873300e-01,	1.7087317160164746e+00,	8.8101212985703492e-01],
    [8.8131323580323040e-01,	1.9365626114853380e+00,	8.8101212985703492e-01],
    [9.8499714589772802e-01,	2.1643935069542013e+00,	8.8101212985703492e-01],
    [1.0886810559922258e+00,	2.3922244024230648e+00,	8.8101212985703492e-01],
    [1.1923649660867235e+00,	2.6200552978919278e+00,	8.8101212985703492e-01],
    [1.2960488761812212e+00,	2.8478861933607909e+00,	8.8101212985703492e-01],
    [1.3997327862757190e+00,	3.0757170888296543e+00,	8.8101212985703492e-01],
    [1.5034166963702167e+00,	3.3035479842985183e+00,	8.8101212985703492e-01],
    [1.6071006064647149e+00,	3.5313788797673817e+00,	8.8101212985703492e-01],
    [1.7107845165592117e+00,	3.7592097752362439e+00,	8.8101212985703492e-01],
    [1.8144684266537101e+00,	3.9870406707051074e+00,	8.8101212985703492e-01],
    [1.9181523367482074e+00,	4.2148715661739704e+00,	8.8101212985703492e-01],
    [2.0218362468427054e+00,	4.4427024616428330e+00,	8.8101212985703492e-01],
    [2.0736782018899538e+00,	4.5566179093772670e+00,	8.8101212985703492e-01],
    [3.2240316574116806e-01,	9.4787716659547450e-01,	8.9931795603287568e-01],
    [3.6270356145881411e-01,	1.0663618124199090e+00,	8.9931795603287568e-01],
    [4.4330435289410614e-01,	1.3033311040687772e+00,	8.9931795603287568e-01],
    [5.2390514432939816e-01,	1.5403003957176462e+00,	8.9931795603287568e-01],
    [6.0450593576469025e-01,	1.7772696873665148e+00,	8.9931795603287568e-01],
    [6.8510672719998222e-01,	2.0142389790153832e+00,	8.9931795603287568e-01],
    [7.6570751863527420e-01,	2.2512082706642516e+00,	8.9931795603287568e-01],
    [8.4630831007056617e-01,	2.4881775623131208e+00,	8.9931795603287568e-01],
    [9.2690910150585826e-01,	2.7251468539619892e+00,	8.9931795603287568e-01],
    [1.0075098929411501e+00,	2.9621161456108576e+00,	8.9931795603287568e-01],
    [1.0881106843764423e+00,	3.1990854372597268e+00,	8.9931795603287568e-01],
    [1.1687114758117345e+00,	3.4360547289085956e+00,	8.9931795603287568e-01],
    [1.2493122672470265e+00,	3.6730240205574636e+00,	8.9931795603287568e-01],
    [1.3299130586823182e+00,	3.9099933122063324e+00,	8.9931795603287568e-01],
    [1.4105138501176107e+00,	4.1469626038552008e+00,	8.9931795603287568e-01],
    [1.4911146415529020e+00,	4.3839318955040696e+00,	8.9931795603287568e-01],
    [1.5717154329881946e+00,	4.6209011871529375e+00,	8.9931795603287568e-01],
    [1.6120158287058404e+00,	4.7393858329773728e+00,	8.9931795603287568e-01],
    [2.2908553899142386e-01,	9.7458523754916782e-01,	9.2220023875267665e-01],
    [2.5772123136535185e-01,	1.0964083922428141e+00,	9.2220023875267665e-01],
    [3.1499261611320778e-01,	1.3400547016301056e+00,	9.2220023875267665e-01],
    [3.7226400086106376e-01,	1.5837010110173977e+00,	9.2220023875267665e-01],
    [4.2953538560891980e-01,	1.8273473204046897e+00,	9.2220023875267665e-01],
    [4.8680677035677566e-01,	2.0709936297919818e+00,	9.2220023875267665e-01],
    [5.4407815510463164e-01,	2.3146399391792736e+00,	9.2220023875267665e-01],
    [6.0134953985248762e-01,	2.5582862485665658e+00,	9.2220023875267665e-01],
    [6.5862092460034372e-01,	2.8019325579538572e+00,	9.2220023875267665e-01],
    [7.1589230934819947e-01,	3.0455788673411495e+00,	9.2220023875267665e-01],
    [7.7316369409605556e-01,	3.2892251767284422e+00,	9.2220023875267665e-01],
    [8.3043507884391166e-01,	3.5328714861157340e+00,	9.2220023875267665e-01],
    [8.8770646359176764e-01,	3.7765177955030258e+00,	9.2220023875267665e-01],
    [9.4497784833962317e-01,	4.0201641048903181e+00,	9.2220023875267665e-01],
    [1.0022492330874795e+00,	4.2638104142776099e+00,	9.2220023875267665e-01],
    [1.0595206178353351e+00,	4.5074567236649008e+00,	9.2220023875267665e-01],
    [1.1167920025831917e+00,	4.7511030330521935e+00,	9.2220023875267665e-01],
    [1.1454276949571192e+00,	4.8729261877458399e+00,	9.2220023875267665e-01],
    [1.3620308027477940e-01,	9.9177336266928362e-01,	9.4965897801643795e-01],
    [1.5322846530912682e-01,	1.1157450330029439e+00,	9.4965897801643795e-01],
    [1.8727923537782165e-01,	1.3636883736702647e+00,	9.4965897801643795e-01],
    [2.2133000544651651e-01,	1.6116317143375858e+00,	9.4965897801643795e-01],
    [2.5538077551521143e-01,	1.8595750550049066e+00,	9.4965897801643795e-01],
    [2.8943154558390621e-01,	2.1075183956722272e+00,	9.4965897801643795e-01],
    [3.2348231565260105e-01,	2.3554617363395480e+00,	9.4965897801643795e-01],
    [3.5753308572129594e-01,	2.6034050770068693e+00,	9.4965897801643795e-01],
    [3.9158385578999078e-01,	2.8513484176741906e+00,	9.4965897801643795e-01],
    [4.2563462585868561e-01,	3.0992917583415105e+00,	9.4965897801643795e-01],
    [4.5968539592738050e-01,	3.3472350990088313e+00,	9.4965897801643795e-01],
    [4.9373616599607539e-01,	3.5951784396761526e+00,	9.4965897801643795e-01],
    [5.2778693606477034e-01,	3.8431217803434738e+00,	9.4965897801643795e-01],
    [5.6183770613346495e-01,	4.0910651210107947e+00,	9.4965897801643795e-01],
    [5.9588847620216001e-01,	4.3390084616781150e+00,	9.4965897801643795e-01],
    [6.2993924627085451e-01,	4.5869518023454363e+00,	9.4965897801643795e-01],
    [6.6399001633954968e-01,	4.8348951430127567e+00,	9.4965897801643795e-01],
    [6.8101540137389693e-01,	4.9588668133464173e+00,	9.4965897801643795e-01],
    [4.5018270457898503e-02,	1.0000000000000000e+00,	9.8169417382415924e-01],
    [5.0645554265135818e-02,	1.1250000000000000e+00,	9.8169417382415924e-01],
    [6.1900121879610422e-02,	1.3750000000000000e+00,	9.8169417382415924e-01],
    [7.3154689494085073e-02,	1.6250000000000000e+00,	9.8169417382415924e-01],
    [8.4409257108559704e-02,	1.8750000000000000e+00,	9.8169417382415924e-01],
    [9.5663824723034321e-02,	2.1250000000000000e+00,	9.8169417382415924e-01],
    [1.0691839233750894e-01,	2.3750000000000000e+00,	9.8169417382415924e-01],
    [1.1817295995198356e-01,	2.6250000000000000e+00,	9.8169417382415924e-01],
    [1.2942752756645820e-01,	2.8750000000000000e+00,	9.8169417382415924e-01],
    [1.4068209518093280e-01,	3.1250000000000000e+00,	9.8169417382415924e-01],
    [1.5193666279540743e-01,	3.3750000000000000e+00,	9.8169417382415924e-01],
    [1.6319123040988209e-01,	3.6250000000000000e+00,	9.8169417382415924e-01],
    [1.7444579802435672e-01,	3.8750000000000000e+00,	9.8169417382415924e-01],
    [1.8570036563883130e-01,	4.1250000000000009e+00,	9.8169417382415924e-01],
    [1.9695493325330599e-01,	4.3750000000000000e+00,	9.8169417382415924e-01],
    [2.0820950086778053e-01,	4.6250000000000000e+00,	9.8169417382415924e-01],
    [2.1946406848225519e-01,	4.8750000000000000e+00,	9.8169417382415924e-01],
    [2.2509135228949251e-01,	5.0000000000000000e+00,	9.8169417382415924e-01],
    [0.0000000000000000e+00,	1.0000000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.1250000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.3750000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.6250000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.8750000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	2.1250000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	2.3750000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	2.6250000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	2.8750000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	3.1250000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	3.3750000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	3.6250000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	3.8750000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	4.1250000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	4.3750000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	4.6250000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	4.8750000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	5.0000000000000000e+00,	1.0000000000000000e+00]])

# 重複ありの総コントロールポイント数
allpointnumber_overlapping = 0
for i in range(patch_info.shape[0]):
    allpointnumber_overlapping += patch_info[i][0] * patch_info[i][1]

globalpoint = np.zeros((allpointnumber_overlapping))
globalpoint_x = np.zeros((allpointnumber_overlapping))
globalpoint_y = np.zeros((allpointnumber_overlapping))
globalpoint_w = np.zeros((allpointnumber_overlapping))
globalpoint_bool = np.zeros((allpointnumber_overlapping), dtype = bool)

localpoint = np.zeros((patch_info.shape[0], xi_max * eta_max))
localpoint_bool = np.zeros((patch_info.shape[0], xi_max * eta_max), dtype=bool)
for i in range(patch_info.shape[0]):
    localpoint_bool[i,:patch_info[i][0]*patch_info[i][1]] = True

xi_and_eta_max = xi_max
if xi_max < eta_max:
    xi_and_eta_max = eta_max
A = np.zeros((patch_info.shape[0], 2, 2, xi_and_eta_max))
A_bool = np.zeros((patch_info.shape[0], 2, 2, xi_and_eta_max), dtype=bool)

# connect patch
xi = 0
eta = 1
positive = 0
negative = 1

patch_number = 0
globalpoint, globalpoint_bool, globalpoint_x, globalpoint_y, globalpoint_w, localpoint, localpoint_bool, A, A_bool = \
    mif.connect_patch_arg_0boundary(patch_number, patch_info, patch, patch_bool, globalpoint, globalpoint_bool, globalpoint_x, globalpoint_y, globalpoint_w, localpoint, localpoint_bool, A, A_bool)

# 座標，パッチコネクティビティー，境界の辺をtxt出力
# [patch_number, xi_or_eta, 0_or_1(int)] (auto marge)
boundary_array_0 = np.array([[0, eta, 0],
                             [0, xi, 1]])

boundary_array_1 = np.array([[0,  xi, 1],
                             [0, eta, 1]])

boundary_number = 0
mif.write_date_header(filename)
mif.write_date_localpoint(filename, patch_info, localpoint, localpoint_bool)
mif.write_date_globalpoint(filename, globalpoint, globalpoint_bool, globalpoint_x, globalpoint_y, globalpoint_w)
boundary_number = mif.write_boundary(filename, A, A_bool, boundary_array_0, boundary_number)
boundary_number = mif.write_boundary(filename, A, A_bool, boundary_array_1, boundary_number)


# 描写
color = np.array(["r", "g", "b", "c", "m", "y", "k"])
fig = plt.figure()
ax1 = fig.add_subplot(1, 1, 1)

A = np.zeros((globalpoint[globalpoint_bool].shape[0],3))
for i in range(globalpoint[globalpoint_bool].shape[0]):
    A[i][0] = globalpoint[globalpoint_bool][i]
    A[i][1] = globalpoint_x[globalpoint_bool][i]
    A[i][2] = globalpoint_y[globalpoint_bool][i]
ax1.plot(A[:,1], A[:,2], c=color[0], marker="", linewidth=0.7)
for i in range(globalpoint[globalpoint_bool].shape[0]):
    ax1.text(A[i,1], A[i,2], str(int(A[i,0])), c=color[3], fontsize=6)


ax1.set_aspect('equal', adjustable='box')
ax1.set_axisbelow(True)
fig.set_figheight(9)
fig.set_figwidth(12)
ax1.grid()
ax1.set_xlim(-1, 3)
ax1.set_ylim(-1, 3)
plt.show()