import numpy as np
import matplotlib.pyplot as plt
import math
import make_inputdate_function as mif

# difine filename
filename = "connectivity_arc_loc3_19x19"

# patch info (ξ方向のコントロールポイント個数, η方向のコントロールポイント個数)
patch_info = np.array([19, 19])

# patch info 1行2列の時の例外処理
if np.array(patch_info.shape).shape[0] == 1:
    patch_info = np.array([[patch_info[0], patch_info[1]]])

xi_max = 0
eta_max = 0
for i in range(patch_info.shape[0]):
    if xi_max < patch_info[i][0]:
        xi_max = patch_info[i][0]
    if eta_max < patch_info[i][1]:
        eta_max = patch_info[i][1]

# パッチのコントロールポイント 座標，重み
patch = np.zeros((patch_info.shape[0], xi_max * eta_max, 3))
patch_bool = np.zeros((patch_info.shape[0], xi_max * eta_max, 3), dtype=bool)
for i in range(patch_info.shape[0]):
    patch_bool[i,:patch_info[i][0]*patch_info[i][1],:] = True

# 各パッチ入力
num = 0
patch[num,:patch_info[num][0]*patch_info[num][1],:] = np.array(
   [[1.0000000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.0208333333333333e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.0625000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.1249999999999998e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.1874999999999998e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.2500000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.3125000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.3750000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.4375000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.5000000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.5625000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.6250000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.6875000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.7500000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.8125000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.8750000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.9375000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.9791666666666667e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [2.0000000000000000e+00,	0.0000000000000000e+00,	1.0000000000000000e+00],
    [1.0000000000000000e+00,	3.3945004827117410e-02,	9.8779611588277283e-01],
    [1.0208333333333333e+00,	3.4652192427682353e-02,	9.8779611588277283e-01],
    [1.0625000000000000e+00,	3.6066567628812246e-02,	9.8779611588277283e-01],
    [1.1249999999999998e+00,	3.8188130430507082e-02,	9.8779611588277283e-01],
    [1.1874999999999998e+00,	4.0309693232201918e-02,	9.8779611588277283e-01],
    [1.2500000000000000e+00,	4.2431256033896761e-02,	9.8779611588277283e-01],
    [1.3125000000000000e+00,	4.4552818835591597e-02,	9.8779611588277283e-01],
    [1.3750000000000000e+00,	4.6674381637286433e-02,	9.8779611588277283e-01],
    [1.4374999999999998e+00,	4.8795944438981262e-02,	9.8779611588277283e-01],
    [1.4999999999999998e+00,	5.0917507240676119e-02,	9.8779611588277283e-01],
    [1.5625000000000000e+00,	5.3039070042370941e-02,	9.8779611588277283e-01],
    [1.6250000000000000e+00,	5.5160632844065798e-02,	9.8779611588277283e-01],
    [1.6875000000000000e+00,	5.7282195645760620e-02,	9.8779611588277283e-01],
    [1.7500000000000000e+00,	5.9403758447455463e-02,	9.8779611588277283e-01],
    [1.8125000000000000e+00,	6.1525321249150298e-02,	9.8779611588277283e-01],
    [1.8750000000000000e+00,	6.3646884050845148e-02,	9.8779611588277283e-01],
    [1.9375000000000000e+00,	6.5768446852539977e-02,	9.8779611588277283e-01],
    [1.9791666666666665e+00,	6.7182822053669863e-02,	9.8779611588277283e-01],
    [2.0000000000000000e+00,	6.7890009654234820e-02,	9.8779611588277283e-01],
    [9.9782812576305802e-01,	1.0207808913627033e-01,	9.6491383316297186e-01],
    [1.0186162117164550e+00,	1.0420471599327596e-01,	9.6491383316297186e-01],
    [1.0601923836232492e+00,	1.0845796970728722e-01,	9.6491383316297186e-01],
    [1.1225566414834403e+00,	1.1483785027830412e-01,	9.6491383316297186e-01],
    [1.1849208993436315e+00,	1.2121773084932098e-01,	9.6491383316297186e-01],
    [1.2472851572038224e+00,	1.2759761142033790e-01,	9.6491383316297186e-01],
    [1.3096494150640137e+00,	1.3397749199135481e-01,	9.6491383316297186e-01],
    [1.3720136729242050e+00,	1.4035737256237166e-01,	9.6491383316297186e-01],
    [1.4343779307843960e+00,	1.4673725313338853e-01,	9.6491383316297186e-01],
    [1.4967421886445873e+00,	1.5311713370440549e-01,	9.6491383316297186e-01],
    [1.5591064465047781e+00,	1.5949701427542234e-01,	9.6491383316297186e-01],
    [1.6214707043649692e+00,	1.6587689484643928e-01,	9.6491383316297186e-01],
    [1.6838349622251605e+00,	1.7225677541745615e-01,	9.6491383316297186e-01],
    [1.7461992200853518e+00,	1.7863665598847306e-01,	9.6491383316297186e-01],
    [1.8085634779455428e+00,	1.8501653655948994e-01,	9.6491383316297186e-01],
    [1.8709277358057337e+00,	1.9139641713050687e-01,	9.6491383316297186e-01],
    [1.9332919936659247e+00,	1.9777629770152375e-01,	9.6491383316297186e-01],
    [1.9748681655727192e+00,	2.0202955141553500e-01,	9.6491383316297186e-01],
    [1.9956562515261160e+00,	2.0415617827254065e-01,	9.6491383316297186e-01],
    [9.8736886197394258e-01,	2.0311273401945742e-01,	9.3516686562723061e-01],
    [1.0079390465983999e+00,	2.0734424931152945e-01,	9.3516686562723061e-01],
    [1.0490794158473140e+00,	2.1580727989567350e-01,	9.3516686562723061e-01],
    [1.1107899697206853e+00,	2.2850182577188960e-01,	9.3516686562723061e-01],
    [1.1725005235940569e+00,	2.4119637164810567e-01,	9.3516686562723061e-01],
    [1.2342110774674284e+00,	2.5389091752432180e-01,	9.3516686562723061e-01],
    [1.2959216313407997e+00,	2.6658546340053785e-01,	9.3516686562723061e-01],
    [1.3576321852141711e+00,	2.7928000927675395e-01,	9.3516686562723061e-01],
    [1.4193427390875424e+00,	2.9197455515296999e-01,	9.3516686562723061e-01],
    [1.4810532929609139e+00,	3.0466910102918615e-01,	9.3516686562723061e-01],
    [1.5427638468342855e+00,	3.1736364690540220e-01,	9.3516686562723061e-01],
    [1.6044744007076566e+00,	3.3005819278161835e-01,	9.3516686562723061e-01],
    [1.6661849545810281e+00,	3.4275273865783434e-01,	9.3516686562723061e-01],
    [1.7278955084543997e+00,	3.5544728453405044e-01,	9.3516686562723061e-01],
    [1.7896060623277710e+00,	3.6814183041026649e-01,	9.3516686562723061e-01],
    [1.8513166162011425e+00,	3.8083637628648265e-01,	9.3516686562723061e-01],
    [1.9130271700745141e+00,	3.9353092216269875e-01,	9.3516686562723061e-01],
    [1.9541675393234283e+00,	4.0199395274684280e-01,	9.3516686562723061e-01],
    [1.9747377239478852e+00,	4.0622546803891485e-01,	9.3516686562723061e-01],
    [9.6880444253662490e-01,	3.0294305970770963e-01,	9.0999635463544948e-01],
    [9.8898786842280473e-01,	3.0925437345162027e-01,	9.0999635463544948e-01],
    [1.0293547201951641e+00,	3.2187700093944144e-01,	9.0999635463544948e-01],
    [1.0899049978537030e+00,	3.4081094217117330e-01,	9.0999635463544948e-01],
    [1.1504552755122419e+00,	3.5974488340290506e-01,	9.0999635463544959e-01],
    [1.2110055531707813e+00,	3.7867882463463698e-01,	9.0999635463544948e-01],
    [1.2715558308293204e+00,	3.9761276586636879e-01,	9.0999635463544948e-01],
    [1.3321061084878594e+00,	4.1654670709810065e-01,	9.0999635463544948e-01],
    [1.3926563861463985e+00,	4.3548064832983241e-01,	9.0999635463544948e-01],
    [1.4532066638049377e+00,	4.5441458956156439e-01,	9.0999635463544948e-01],
    [1.5137569414634764e+00,	4.7334853079329614e-01,	9.0999635463544959e-01],
    [1.5743072191220153e+00,	4.9228247202502801e-01,	9.0999635463544959e-01],
    [1.6348574967805547e+00,	5.1121641325675982e-01,	9.0999635463544948e-01],
    [1.6954077744390936e+00,	5.3015035448849179e-01,	9.0999635463544948e-01],
    [1.7559580520976330e+00,	5.4908429572022355e-01,	9.0999635463544948e-01],
    [1.8165083297561717e+00,	5.6801823695195552e-01,	9.0999635463544948e-01],
    [1.8770586074147111e+00,	5.8695217818368739e-01,	9.0999635463544948e-01],
    [1.9174254591870701e+00,	5.9957480567150867e-01,	9.0999635463544948e-01],
    [1.9376088850732498e+00,	6.0588611941541926e-01,	9.0999635463544948e-01],
    [9.4141170372035543e-01,	4.0024737083752171e-01,	8.8940230018762867e-01],
    [9.6102444754786276e-01,	4.0858585772997008e-01,	8.8940230018762867e-01],
    [1.0002499352028777e+00,	4.2526283151486688e-01,	8.8940230018762867e-01],
    [1.0590881666853997e+00,	4.5027829219221194e-01,	8.8940230018762867e-01],
    [1.1179263981679219e+00,	4.7529375286955700e-01,	8.8940230018762867e-01],
    [1.1767646296504446e+00,	5.0030921354690217e-01,	8.8940230018762867e-01],
    [1.2356028611329666e+00,	5.2532467422424722e-01,	8.8940230018762867e-01],
    [1.2944410926154886e+00,	5.5034013490159228e-01,	8.8940230018762867e-01],
    [1.3532793240980108e+00,	5.7535559557893734e-01,	8.8940230018762867e-01],
    [1.4121175555805332e+00,	6.0037105625628262e-01,	8.8940230018762867e-01],
    [1.4709557870630552e+00,	6.2538651693362768e-01,	8.8940230018762867e-01],
    [1.5297940185455774e+00,	6.5040197761097296e-01,	8.8940230018762867e-01],
    [1.5886322500280998e+00,	6.7541743828831780e-01,	8.8940230018762867e-01],
    [1.6474704815106218e+00,	7.0043289896566296e-01,	8.8940230018762867e-01],
    [1.7063087129931442e+00,	7.2544835964300802e-01,	8.8940230018762867e-01],
    [1.7651469444756664e+00,	7.5046382032035330e-01,	8.8940230018762867e-01],
    [1.8239851759581887e+00,	7.7547928099769836e-01,	8.8940230018762867e-01],
    [1.8632106636132033e+00,	7.9215625478259510e-01,	8.8940230018762867e-01],
    [1.8828234074407109e+00,	8.0049474167504342e-01,	8.8940230018762867e-01],
    [9.0466925310059632e-01,	4.9364487729294243e-01,	8.7338470228376797e-01],
    [9.2351652920685867e-01,	5.0392914556987878e-01,	8.7338470228376797e-01],
    [9.6121108141938338e-01,	5.2449768212375125e-01,	8.7338470228376797e-01],
    [1.0177529097381708e+00,	5.5535048695456024e-01,	8.7338470228376797e-01],
    [1.0742947380569581e+00,	5.8620329178536912e-01,	8.7338470228376797e-01],
    [1.1308365663757454e+00,	6.1705609661617800e-01,	8.7338470228376797e-01],
    [1.1873783946945327e+00,	6.4790890144698698e-01,	8.7338470228376797e-01],
    [1.2439202230133199e+00,	6.7876170627779564e-01,	8.7338470228376797e-01],
    [1.3004620513321068e+00,	7.0961451110860463e-01,	8.7338470228376797e-01],
    [1.3570038796508945e+00,	7.4046731593941362e-01,	8.7338470228376797e-01],
    [1.4135457079696814e+00,	7.7132012077022249e-01,	8.7338470228376797e-01],
    [1.4700875362884687e+00,	8.0217292560103137e-01,	8.7338470228376797e-01],
    [1.5266293646072562e+00,	8.3302573043184025e-01,	8.7338470228376797e-01],
    [1.5831711929260435e+00,	8.6387853526264924e-01,	8.7338470228376797e-01],
    [1.6397130212448305e+00,	8.9473134009345812e-01,	8.7338470228376797e-01],
    [1.6962548495636181e+00,	9.2558414492426699e-01,	8.7338470228376797e-01],
    [1.7527966778824051e+00,	9.5643694975507598e-01,	8.7338470228376797e-01],
    [1.7904912300949301e+00,	9.7700548630894868e-01,	8.7338470228376797e-01],
    [1.8093385062011926e+00,	9.8728975458588486e-01,	8.7338470228376797e-01],
    [8.5830925687560033e-01,	5.8176194710130991e-01,	8.6194356092386748e-01],
    [8.7619069972717545e-01,	5.9388198766592060e-01,	8.6194356092386748e-01],
    [9.1195358543032534e-01,	6.1812206879514175e-01,	8.6194356092386748e-01],
    [9.6559791398505035e-01,	6.5448219048897360e-01,	8.6194356092386748e-01],
    [1.0192422425397756e+00,	6.9084231218280545e-01,	8.6194356092386748e-01],
    [1.0728865710945006e+00,	7.2720243387663741e-01,	8.6194356092386748e-01],
    [1.1265308996492254e+00,	7.6356255557046926e-01,	8.6194356092386748e-01],
    [1.1801752282039508e+00,	7.9992267726430100e-01,	8.6194356092386748e-01],
    [1.2338195567586754e+00,	8.3628279895813273e-01,	8.6194356092386748e-01],
    [1.2874638853134006e+00,	8.7264292065196492e-01,	8.6194356092386748e-01],
    [1.3411082138681258e+00,	9.0900304234579654e-01,	8.6194356092386748e-01],
    [1.3947525424228506e+00,	9.4536316403962861e-01,	8.6194356092386748e-01],
    [1.4483968709775756e+00,	9.8172328573346035e-01,	8.6194356092386748e-01],
    [1.5020411995323009e+00,	1.0180834074272924e+00,	8.6194356092386748e-01],
    [1.5556855280870256e+00,	1.0544435291211240e+00,	8.6194356092386748e-01],
    [1.6093298566417509e+00,	1.0908036508149561e+00,	8.6194356092386748e-01],
    [1.6629741851964754e+00,	1.1271637725087880e+00,	8.6194356092386748e-01],
    [1.6987370708996259e+00,	1.1514038536380091e+00,	8.6194356092386748e-01],
    [1.7166185137512007e+00,	1.1635238942026198e+00,	8.6194356092386748e-01],
    [8.0235552325121007e-01,	6.6330629485420400e-01,	8.5507887610792721e-01],
    [8.1907126331894364e-01,	6.7712517599699984e-01,	8.5507887610792721e-01],
    [8.5250274345441057e-01,	7.0476293828259184e-01,	8.5507887610792721e-01],
    [9.0264996365761130e-01,	7.4621958171097946e-01,	8.5507887610792721e-01],
    [9.5279718386081191e-01,	7.8767622513936708e-01,	8.5507887610792732e-01],
    [1.0029444040640128e+00,	8.2913286856775514e-01,	8.5507887610792721e-01],
    [1.0530916242672130e+00,	8.7058951199614276e-01,	8.5507887610792721e-01],
    [1.1032388444704140e+00,	9.1204615542453049e-01,	8.5507887610792721e-01],
    [1.1533860646736145e+00,	9.5350279885291811e-01,	8.5507887610792721e-01],
    [1.2035332848768150e+00,	9.9495944228130606e-01,	8.5507887610792721e-01],
    [1.2536805050800155e+00,	1.0364160857096936e+00,	8.5507887610792732e-01],
    [1.3038277252832160e+00,	1.0778727291380816e+00,	8.5507887610792732e-01],
    [1.3539749454864169e+00,	1.1193293725664690e+00,	8.5507887610792721e-01],
    [1.4041221656896172e+00,	1.1607860159948571e+00,	8.5507887610792721e-01],
    [1.4542693858928182e+00,	1.2022426594232447e+00,	8.5507887610792721e-01],
    [1.5044166060960187e+00,	1.2436993028516325e+00,	8.5507887610792721e-01],
    [1.5545638262992196e+00,	1.2851559462800204e+00,	8.5507887610792721e-01],
    [1.5879953064346866e+00,	1.3127937085656121e+00,	8.5507887610792721e-01],
    [1.6047110465024201e+00,	1.3266125897084080e+00,	8.5507887610792721e-01],
    [7.3714178830623489e-01,	7.3714178830623489e-01,	8.5279064783594705e-01],
    [7.5249890889594817e-01,	7.5249890889594817e-01,	8.5279064783594705e-01],
    [7.8321315007537462e-01,	7.8321315007537462e-01,	8.5279064783594705e-01],
    [8.2928451184451435e-01,	8.2928451184451435e-01,	8.5279064783594705e-01],
    [8.7535587361365386e-01,	8.7535587361365375e-01,	8.5279064783594716e-01],
    [9.2142723538279370e-01,	9.2142723538279370e-01,	8.5279064783594705e-01],
    [9.6749859715193331e-01,	9.6749859715193331e-01,	8.5279064783594705e-01],
    [1.0135699589210729e+00,	1.0135699589210729e+00,	8.5279064783594705e-01],
    [1.0596413206902124e+00,	1.0596413206902124e+00,	8.5279064783594705e-01],
    [1.1057126824593524e+00,	1.1057126824593524e+00,	8.5279064783594705e-01],
    [1.1517840442284919e+00,	1.1517840442284917e+00,	8.5279064783594716e-01],
    [1.1978554059976316e+00,	1.1978554059976316e+00,	8.5279064783594716e-01],
    [1.2439267677667714e+00,	1.2439267677667714e+00,	8.5279064783594705e-01],
    [1.2899981295359109e+00,	1.2899981295359109e+00,	8.5279064783594705e-01],
    [1.3360694913050508e+00,	1.3360694913050508e+00,	8.5279064783594705e-01],
    [1.3821408530741903e+00,	1.3821408530741905e+00,	8.5279064783594705e-01],
    [1.4282122148433303e+00,	1.4282122148433303e+00,	8.5279064783594705e-01],
    [1.4589264560227564e+00,	1.4589264560227568e+00,	8.5279064783594705e-01],
    [1.4742835766124698e+00,	1.4742835766124698e+00,	8.5279064783594705e-01],
    [6.6330629485420400e-01,	8.0235552325121007e-01,	8.5507887610792721e-01],
    [6.7712517599700006e-01,	8.1907126331894364e-01,	8.5507887610792721e-01],
    [7.0476293828259184e-01,	8.5250274345441057e-01,	8.5507887610792721e-01],
    [7.4621958171097946e-01,	9.0264996365761130e-01,	8.5507887610792721e-01],
    [7.8767622513936719e-01,	9.5279718386081169e-01,	8.5507887610792732e-01],
    [8.2913286856775514e-01,	1.0029444040640125e+00,	8.5507887610792721e-01],
    [8.7058951199614276e-01,	1.0530916242672130e+00,	8.5507887610792721e-01],
    [9.1204615542453049e-01,	1.1032388444704138e+00,	8.5507887610792721e-01],
    [9.5350279885291811e-01,	1.1533860646736143e+00,	8.5507887610792721e-01],
    [9.9495944228130606e-01,	1.2035332848768150e+00,	8.5507887610792721e-01],
    [1.0364160857096936e+00,	1.2536805050800155e+00,	8.5507887610792732e-01],
    [1.0778727291380812e+00,	1.3038277252832162e+00,	8.5507887610792732e-01],
    [1.1193293725664692e+00,	1.3539749454864167e+00,	8.5507887610792721e-01],
    [1.1607860159948569e+00,	1.4041221656896177e+00,	8.5507887610792721e-01],
    [1.2022426594232447e+00,	1.4542693858928182e+00,	8.5507887610792721e-01],
    [1.2436993028516323e+00,	1.5044166060960189e+00,	8.5507887610792721e-01],
    [1.2851559462800204e+00,	1.5545638262992196e+00,	8.5507887610792721e-01],
    [1.3127937085656121e+00,	1.5879953064346866e+00,	8.5507887610792721e-01],
    [1.3266125897084080e+00,	1.6047110465024201e+00,	8.5507887610792721e-01],
    [5.8176194710130980e-01,	8.5830925687560045e-01,	8.6194356092386748e-01],
    [5.9388198766592060e-01,	8.7619069972717545e-01,	8.6194356092386748e-01],
    [6.1812206879514175e-01,	9.1195358543032534e-01,	8.6194356092386748e-01],
    [6.5448219048897360e-01,	9.6559791398505035e-01,	8.6194356092386748e-01],
    [6.9084231218280545e-01,	1.0192422425397756e+00,	8.6194356092386748e-01],
    [7.2720243387663741e-01,	1.0728865710945006e+00,	8.6194356092386748e-01],
    [7.6356255557046926e-01,	1.1265308996492256e+00,	8.6194356092386748e-01],
    [7.9992267726430100e-01,	1.1801752282039506e+00,	8.6194356092386748e-01],
    [8.3628279895813273e-01,	1.2338195567586754e+00,	8.6194356092386748e-01],
    [8.7264292065196480e-01,	1.2874638853134006e+00,	8.6194356092386748e-01],
    [9.0900304234579665e-01,	1.3411082138681254e+00,	8.6194356092386748e-01],
    [9.4536316403962839e-01,	1.3947525424228506e+00,	8.6194356092386748e-01],
    [9.8172328573346046e-01,	1.4483968709775756e+00,	8.6194356092386748e-01],
    [1.0180834074272922e+00,	1.5020411995323009e+00,	8.6194356092386748e-01],
    [1.0544435291211240e+00,	1.5556855280870256e+00,	8.6194356092386748e-01],
    [1.0908036508149559e+00,	1.6093298566417509e+00,	8.6194356092386748e-01],
    [1.1271637725087880e+00,	1.6629741851964759e+00,	8.6194356092386748e-01],
    [1.1514038536380091e+00,	1.6987370708996259e+00,	8.6194356092386748e-01],
    [1.1635238942026196e+00,	1.7166185137512009e+00,	8.6194356092386748e-01],
    [4.9364487729294237e-01,	9.0466925310059632e-01,	8.7338470228376797e-01],
    [5.0392914556987878e-01,	9.2351652920685867e-01,	8.7338470228376797e-01],
    [5.2449768212375125e-01,	9.6121108141938338e-01,	8.7338470228376797e-01],
    [5.5535048695456024e-01,	1.0177529097381708e+00,	8.7338470228376797e-01],
    [5.8620329178536912e-01,	1.0742947380569581e+00,	8.7338470228376797e-01],
    [6.1705609661617800e-01,	1.1308365663757454e+00,	8.7338470228376797e-01],
    [6.4790890144698698e-01,	1.1873783946945327e+00,	8.7338470228376797e-01],
    [6.7876170627779586e-01,	1.2439202230133197e+00,	8.7338470228376797e-01],
    [7.0961451110860463e-01,	1.3004620513321068e+00,	8.7338470228376797e-01],
    [7.4046731593941362e-01,	1.3570038796508943e+00,	8.7338470228376797e-01],
    [7.7132012077022261e-01,	1.4135457079696816e+00,	8.7338470228376797e-01],
    [8.0217292560103115e-01,	1.4700875362884689e+00,	8.7338470228376797e-01],
    [8.3302573043184025e-01,	1.5266293646072560e+00,	8.7338470228376797e-01],
    [8.6387853526264902e-01,	1.5831711929260435e+00,	8.7338470228376797e-01],
    [8.9473134009345801e-01,	1.6397130212448308e+00,	8.7338470228376797e-01],
    [9.2558414492426699e-01,	1.6962548495636181e+00,	8.7338470228376797e-01],
    [9.5643694975507598e-01,	1.7527966778824051e+00,	8.7338470228376797e-01],
    [9.7700548630894835e-01,	1.7904912300949301e+00,	8.7338470228376797e-01],
    [9.8728975458588475e-01,	1.8093385062011926e+00,	8.7338470228376797e-01],
    [4.0024737083752171e-01,	9.4141170372035543e-01,	8.8940230018762867e-01],
    [4.0858585772997003e-01,	9.6102444754786276e-01,	8.8940230018762867e-01],
    [4.2526283151486688e-01,	1.0002499352028777e+00,	8.8940230018762867e-01],
    [4.5027829219221194e-01,	1.0590881666853997e+00,	8.8940230018762867e-01],
    [4.7529375286955700e-01,	1.1179263981679219e+00,	8.8940230018762878e-01],
    [5.0030921354690217e-01,	1.1767646296504441e+00,	8.8940230018762867e-01],
    [5.2532467422424722e-01,	1.2356028611329666e+00,	8.8940230018762867e-01],
    [5.5034013490159228e-01,	1.2944410926154888e+00,	8.8940230018762867e-01],
    [5.7535559557893734e-01,	1.3532793240980108e+00,	8.8940230018762867e-01],
    [6.0037105625628262e-01,	1.4121175555805330e+00,	8.8940230018762867e-01],
    [6.2538651693362757e-01,	1.4709557870630552e+00,	8.8940230018762878e-01],
    [6.5040197761097263e-01,	1.5297940185455772e+00,	8.8940230018762878e-01],
    [6.7541743828831780e-01,	1.5886322500280998e+00,	8.8940230018762867e-01],
    [7.0043289896566285e-01,	1.6474704815106218e+00,	8.8940230018762867e-01],
    [7.2544835964300802e-01,	1.7063087129931440e+00,	8.8940230018762867e-01],
    [7.5046382032035319e-01,	1.7651469444756664e+00,	8.8940230018762867e-01],
    [7.7547928099769836e-01,	1.8239851759581887e+00,	8.8940230018762867e-01],
    [7.9215625478259510e-01,	1.8632106636132035e+00,	8.8940230018762867e-01],
    [8.0049474167504342e-01,	1.8828234074407109e+00,	8.8940230018762867e-01],
    [3.0294305970770957e-01,	9.6880444253662490e-01,	9.0999635463544948e-01],
    [3.0925437345162021e-01,	9.8898786842280462e-01,	9.0999635463544948e-01],
    [3.2187700093944144e-01,	1.0293547201951641e+00,	9.0999635463544948e-01],
    [3.4081094217117330e-01,	1.0899049978537030e+00,	9.0999635463544948e-01],
    [3.5974488340290511e-01,	1.1504552755122419e+00,	9.0999635463544959e-01],
    [3.7867882463463692e-01,	1.2110055531707813e+00,	9.0999635463544948e-01],
    [3.9761276586636879e-01,	1.2715558308293204e+00,	9.0999635463544948e-01],
    [4.1654670709810065e-01,	1.3321061084878594e+00,	9.0999635463544948e-01],
    [4.3548064832983241e-01,	1.3926563861463985e+00,	9.0999635463544948e-01],
    [4.5441458956156433e-01,	1.4532066638049375e+00,	9.0999635463544948e-01],
    [4.7334853079329614e-01,	1.5137569414634764e+00,	9.0999635463544959e-01],
    [4.9228247202502790e-01,	1.5743072191220153e+00,	9.0999635463544959e-01],
    [5.1121641325675982e-01,	1.6348574967805547e+00,	9.0999635463544948e-01],
    [5.3015035448849168e-01,	1.6954077744390936e+00,	9.0999635463544948e-01],
    [5.4908429572022355e-01,	1.7559580520976328e+00,	9.0999635463544948e-01],
    [5.6801823695195541e-01,	1.8165083297561717e+00,	9.0999635463544948e-01],
    [5.8695217818368739e-01,	1.8770586074147109e+00,	9.0999635463544948e-01],
    [5.9957480567150845e-01,	1.9174254591870701e+00,	9.0999635463544948e-01],
    [6.0588611941541914e-01,	1.9376088850732498e+00,	9.0999635463544948e-01],
    [2.0311273401945742e-01,	9.8736886197394280e-01,	9.3516686562723050e-01],
    [2.0734424931152945e-01,	1.0079390465983999e+00,	9.3516686562723050e-01],
    [2.1580727989567353e-01,	1.0490794158473142e+00,	9.3516686562723050e-01],
    [2.2850182577188963e-01,	1.1107899697206856e+00,	9.3516686562723050e-01],
    [2.4119637164810567e-01,	1.1725005235940569e+00,	9.3516686562723061e-01],
    [2.5389091752432175e-01,	1.2342110774674284e+00,	9.3516686562723050e-01],
    [2.6658546340053785e-01,	1.2959216313408000e+00,	9.3516686562723050e-01],
    [2.7928000927675395e-01,	1.3576321852141715e+00,	9.3516686562723050e-01],
    [2.9197455515296999e-01,	1.4193427390875426e+00,	9.3516686562723050e-01],
    [3.0466910102918610e-01,	1.4810532929609141e+00,	9.3516686562723050e-01],
    [3.1736364690540220e-01,	1.5427638468342855e+00,	9.3516686562723061e-01],
    [3.3005819278161813e-01,	1.6044744007076566e+00,	9.3516686562723061e-01],
    [3.4275273865783440e-01,	1.6661849545810283e+00,	9.3516686562723050e-01],
    [3.5544728453405044e-01,	1.7278955084543997e+00,	9.3516686562723050e-01],
    [3.6814183041026655e-01,	1.7896060623277712e+00,	9.3516686562723050e-01],
    [3.8083637628648265e-01,	1.8513166162011427e+00,	9.3516686562723050e-01],
    [3.9353092216269880e-01,	1.9130271700745143e+00,	9.3516686562723050e-01],
    [4.0199395274684280e-01,	1.9541675393234286e+00,	9.3516686562723050e-01],
    [4.0622546803891485e-01,	1.9747377239478856e+00,	9.3516686562723050e-01],
    [1.0207808913627031e-01,	9.9782812576305813e-01,	9.6491383316297186e-01],
    [1.0420471599327595e-01,	1.0186162117164550e+00,	9.6491383316297186e-01],
    [1.0845796970728722e-01,	1.0601923836232492e+00,	9.6491383316297186e-01],
    [1.1483785027830412e-01,	1.1225566414834403e+00,	9.6491383316297186e-01],
    [1.2121773084932100e-01,	1.1849208993436311e+00,	9.6491383316297186e-01],
    [1.2759761142033788e-01,	1.2472851572038226e+00,	9.6491383316297186e-01],
    [1.3397749199135481e-01,	1.3096494150640137e+00,	9.6491383316297186e-01],
    [1.4035737256237169e-01,	1.3720136729242047e+00,	9.6491383316297186e-01],
    [1.4673725313338853e-01,	1.4343779307843960e+00,	9.6491383316297186e-01],
    [1.5311713370440547e-01,	1.4967421886445871e+00,	9.6491383316297186e-01],
    [1.5949701427542234e-01,	1.5591064465047781e+00,	9.6491383316297186e-01],
    [1.6587689484643919e-01,	1.6214707043649692e+00,	9.6491383316297186e-01],
    [1.7225677541745615e-01,	1.6838349622251605e+00,	9.6491383316297186e-01],
    [1.7863665598847300e-01,	1.7461992200853516e+00,	9.6491383316297186e-01],
    [1.8501653655948991e-01,	1.8085634779455428e+00,	9.6491383316297186e-01],
    [1.9139641713050684e-01,	1.8709277358057337e+00,	9.6491383316297186e-01],
    [1.9777629770152375e-01,	1.9332919936659250e+00,	9.6491383316297186e-01],
    [2.0202955141553497e-01,	1.9748681655727189e+00,	9.6491383316297186e-01],
    [2.0415617827254062e-01,	1.9956562515261163e+00,	9.6491383316297186e-01],
    [3.3945004827117403e-02,	1.0000000000000000e+00,	9.8779611588277283e-01],
    [3.4652192427682346e-02,	1.0208333333333333e+00,	9.8779611588277283e-01],
    [3.6066567628812246e-02,	1.0625000000000000e+00,	9.8779611588277283e-01],
    [3.8188130430507082e-02,	1.1249999999999998e+00,	9.8779611588277283e-01],
    [4.0309693232201918e-02,	1.1874999999999998e+00,	9.8779611588277283e-01],
    [4.2431256033896754e-02,	1.2500000000000000e+00,	9.8779611588277283e-01],
    [4.4552818835591597e-02,	1.3125000000000000e+00,	9.8779611588277283e-01],
    [4.6674381637286433e-02,	1.3749999999999998e+00,	9.8779611588277283e-01],
    [4.8795944438981262e-02,	1.4374999999999998e+00,	9.8779611588277283e-01],
    [5.0917507240676105e-02,	1.4999999999999998e+00,	9.8779611588277283e-01],
    [5.3039070042370941e-02,	1.5625000000000000e+00,	9.8779611588277283e-01],
    [5.5160632844065770e-02,	1.6250000000000000e+00,	9.8779611588277283e-01],
    [5.7282195645760620e-02,	1.6875000000000000e+00,	9.8779611588277283e-01],
    [5.9403758447455449e-02,	1.7500000000000000e+00,	9.8779611588277283e-01],
    [6.1525321249150292e-02,	1.8125000000000000e+00,	9.8779611588277283e-01],
    [6.3646884050845134e-02,	1.8750000000000000e+00,	9.8779611588277283e-01],
    [6.5768446852539977e-02,	1.9375000000000000e+00,	9.8779611588277283e-01],
    [6.7182822053669849e-02,	1.9791666666666665e+00,	9.8779611588277283e-01],
    [6.7890009654234806e-02,	2.0000000000000000e+00,	9.8779611588277283e-01],
    [0.0000000000000000e+00,	1.0000000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.0208333333333333e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.0625000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.1249999999999998e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.1874999999999998e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.2500000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.3125000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.3750000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.4375000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.5000000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.5625000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.6250000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.6875000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.7500000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.8125000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.8750000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.9375000000000000e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	1.9791666666666667e+00,	1.0000000000000000e+00],
    [0.0000000000000000e+00,	2.0000000000000000e+00,	1.0000000000000000e+00]])

# 重複ありの総コントロールポイント数
allpointnumber_overlapping = 0
for i in range(patch_info.shape[0]):
    allpointnumber_overlapping += patch_info[i][0] * patch_info[i][1]

globalpoint = np.zeros((allpointnumber_overlapping))
globalpoint_x = np.zeros((allpointnumber_overlapping))
globalpoint_y = np.zeros((allpointnumber_overlapping))
globalpoint_w = np.zeros((allpointnumber_overlapping))
globalpoint_bool = np.zeros((allpointnumber_overlapping), dtype = bool)

localpoint = np.zeros((patch_info.shape[0], xi_max * eta_max))
localpoint_bool = np.zeros((patch_info.shape[0], xi_max * eta_max), dtype=bool)
for i in range(patch_info.shape[0]):
    localpoint_bool[i,:patch_info[i][0]*patch_info[i][1]] = True

xi_and_eta_max = xi_max
if xi_max < eta_max:
    xi_and_eta_max = eta_max
A = np.zeros((patch_info.shape[0], 2, 2, xi_and_eta_max))
A_bool = np.zeros((patch_info.shape[0], 2, 2, xi_and_eta_max), dtype=bool)

# connect patch
xi = 0
eta = 1
positive = 0
negative = 1

patch_number = 0
globalpoint, globalpoint_bool, globalpoint_x, globalpoint_y, globalpoint_w, localpoint, localpoint_bool, A, A_bool = \
    mif.connect_patch_arg_0boundary(patch_number, patch_info, patch, patch_bool, globalpoint, globalpoint_bool, globalpoint_x, globalpoint_y, globalpoint_w, localpoint, localpoint_bool, A, A_bool)

# 座標，パッチコネクティビティー，境界の辺をtxt出力
# [patch_number, xi_or_eta, 0_or_1(int)] (auto marge)
boundary_array_0 = np.array([[0, eta, 0],
                             [0, xi, 1]])

boundary_array_1 = np.array([[0,  xi, 1],
                             [0, eta, 1]])

boundary_number = 0
mif.write_date_header(filename)
mif.write_date_localpoint(filename, patch_info, localpoint, localpoint_bool)
mif.write_date_globalpoint(filename, globalpoint, globalpoint_bool, globalpoint_x, globalpoint_y, globalpoint_w)
boundary_number = mif.write_boundary(filename, A, A_bool, boundary_array_0, boundary_number)
boundary_number = mif.write_boundary(filename, A, A_bool, boundary_array_1, boundary_number)


# 描写
color = np.array(["r", "g", "b", "c", "m", "y", "k"])
fig = plt.figure()
ax1 = fig.add_subplot(1, 1, 1)

A = np.zeros((globalpoint[globalpoint_bool].shape[0],3))
for i in range(globalpoint[globalpoint_bool].shape[0]):
    A[i][0] = globalpoint[globalpoint_bool][i]
    A[i][1] = globalpoint_x[globalpoint_bool][i]
    A[i][2] = globalpoint_y[globalpoint_bool][i]
ax1.plot(A[:,1], A[:,2], c=color[0], marker="", linewidth=0.7)
for i in range(globalpoint[globalpoint_bool].shape[0]):
    ax1.text(A[i,1], A[i,2], str(int(A[i,0])), c=color[3], fontsize=6)


ax1.set_aspect('equal', adjustable='box')
ax1.set_axisbelow(True)
fig.set_figheight(9)
fig.set_figwidth(12)
ax1.grid()
ax1.set_xlim(-1, 3)
ax1.set_ylim(-1, 3)
plt.show()